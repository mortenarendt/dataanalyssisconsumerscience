
# Introduction to linear and mixed models 

## What is a linear model? 

Linear models are on of the most used statistical methods. It consists of a wide range of models including regression, multiple-regression, ANalysis Of Variance (ANOVA) type models etc. The definition is that the response is linear in the parameters. If $y$ is the response, and $x$ is the predictor, then both of the models below is linear models

$$y = a + b\cdot x + e$$

$$y = a + b\cdot x + c\cdot x^2 + e$$
Here you see that the response is linear in the parameters $a,b,c$. I.e. it has nothing to do with being linear in the predictor. 


## Normal and Mixed models

### Normal model

In a _normal_ linear model such as: 

$$y = a + b\cdot x + e$$

The assumption is that the uncertainty is captured by one entry, namely the residuals ($e$). 
For instance, the relation between _Hunger_ and the intake  _AdLibg_ of dishes with Capsaicin can be visualized and modelled by: 

```{r}
library(data4consumerscience)
data(chili)
x <- chili %>% 
  # only include a single treatment
  filter(Treatment=='Capsaicin') %>% 
  # only include the first trial for each judge
  filter(!duplicated(Judge)) 

ggplot(data = x, aes(Hunger,AdLibg)) + 
  geom_point() + 
  stat_smooth(method = lm, se = F)
```

Naturally, the more hungry, the higher the intake. 

A model describing this relation: 

```{r}
mdl <- lm(data = x, AdLibg~Hunger)
summary(mdl)
```

Here we see that consumption increases by $3.45g$ per increase in $1$ hunger scale, and that this slope has a standard error of $1.08g$. Further, at Hunger=0 the intake is $379.8g$. Furhter, we see that this relation is significant $p = 0.0036$. 

More details on the use of linear models in R and how-to can be viewed in these videos: 

```{r}
vembedr::embed_youtube("https://youtu.be/66z_MRwtFJM")
```

```{r}
vembedr::embed_youtube("https://youtu.be/2mAqgL0Xc-s")
```



### Mixed model

A _mixed_ model refers to the situation, where more than one part of the model is handling the uncertainty. 
For instance, in the chili data set there are two instances for each judge, and hence the uncertainty can be split into _between_ judges and _within_ judged. 


[ALT MANGLER - forslag er at lave et kortere afsnit her som en pendant til PCA. HÃ¥ber I synes det er en god ide?]


### ANOVA



#### Tukey's Honest Significant Difference (HSD)






