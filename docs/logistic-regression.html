<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Logistic Regression | Data Analysis in R for Sensory and Consumer Science</title>
  <meta name="description" content="Chapter 12 Logistic Regression | Data Analysis in R for Sensory and Consumer Science" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Logistic Regression | Data Analysis in R for Sensory and Consumer Science" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Logistic Regression | Data Analysis in R for Sensory and Consumer Science" />
  
  
  

<meta name="author" content="Morten Arendt Rasmussen, Julius Jessen Terp, Mads RÃ¸nnow Staffe, Helene C. Reinbach, Qian Janice Wang and Bodil H. Allesen-Holm" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="profiling-segments.html"/>
<link rel="next" href="cata-data-check-all-that-apply.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.33/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Analysis in R for Consumer Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction to the book</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>1</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#how-to-get-started---understanding-r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> How to get started - understanding R (and RStudio)</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#organise-and-save-scripts"><i class="fa fa-check"></i><b>1.1.1</b> Organise and save scripts</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#how-to-import-data"><i class="fa fa-check"></i><b>1.2</b> How to import data</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#import-data-from-r-package"><i class="fa fa-check"></i><b>1.2.1</b> Import data from R-package</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#importing-a-csv-file"><i class="fa fa-check"></i><b>1.2.2</b> Importing a csv file</a></li>
<li class="chapter" data-level="1.2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#importing-an-excel-filesheet"><i class="fa fa-check"></i><b>1.2.3</b> Importing an Excel file/sheet</a></li>
<li class="chapter" data-level="1.2.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#clipboard-import"><i class="fa fa-check"></i><b>1.2.4</b> Clipboard import</a></li>
<li class="chapter" data-level="1.2.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#looking-at-the-imported-elements"><i class="fa fa-check"></i><b>1.2.5</b> Looking at the imported elements</a></li>
<li class="chapter" data-level="1.2.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#numbers-and-factors---changing-categorisation"><i class="fa fa-check"></i><b>1.2.6</b> Numbers and factors - changing categorisation</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#how-to-edit-and-merge-datasets"><i class="fa fa-check"></i><b>1.3</b> How to edit and merge datasets</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#edit-using-tidyverse"><i class="fa fa-check"></i><b>1.3.1</b> Edit using Tidyverse</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#how-to-save-the-data"><i class="fa fa-check"></i><b>1.4</b> How to save the data</a></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#how-to-export-data-results-to-excel-and-the-like"><i class="fa fa-check"></i><b>1.5</b> How to export data / results to Excel and the like</a></li>
<li class="chapter" data-level="1.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#how-to-load-your-rdata"><i class="fa fa-check"></i><b>1.6</b> How to load your RData</a></li>
<li class="chapter" data-level="1.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#how-to-clear-your-environment"><i class="fa fa-check"></i><b>1.7</b> How to clear your environment</a></li>
<li class="chapter" data-level="1.8" data-path="introduction-to-r.html"><a href="introduction-to-r.html#how-to-r-project"><i class="fa fa-check"></i><b>1.8</b> How to R project</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#how-to-create-an-r-project"><i class="fa fa-check"></i><b>1.8.1</b> How to Create an R Project</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="libraries.html"><a href="libraries.html"><i class="fa fa-check"></i><b>2</b> Libraries</a></li>
<li class="chapter" data-level="3" data-path="plotting-data.html"><a href="plotting-data.html"><i class="fa fa-check"></i><b>3</b> Plotting data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="plotting-data.html"><a href="plotting-data.html#histograms-and-boxplots"><i class="fa fa-check"></i><b>3.1</b> Histograms and boxplots</a></li>
<li class="chapter" data-level="3.2" data-path="plotting-data.html"><a href="plotting-data.html#scatter-plots"><i class="fa fa-check"></i><b>3.2</b> Scatter plots</a></li>
<li class="chapter" data-level="3.3" data-path="plotting-data.html"><a href="plotting-data.html#how-to-export-plots"><i class="fa fa-check"></i><b>3.3</b> How to export plots</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html"><i class="fa fa-check"></i><b>4</b> Descriptive statistics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#descriptives-for-a-continuous-variable"><i class="fa fa-check"></i><b>4.1</b> Descriptives for a continuous variable</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#mean-median"><i class="fa fa-check"></i><b>4.1.1</b> Mean / median</a></li>
<li class="chapter" data-level="4.1.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#variance"><i class="fa fa-check"></i><b>4.1.2</b> Variance</a></li>
<li class="chapter" data-level="4.1.3" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#standard-deviation"><i class="fa fa-check"></i><b>4.1.3</b> Standard deviation</a></li>
<li class="chapter" data-level="4.1.4" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#calculations"><i class="fa fa-check"></i><b>4.1.4</b> Calculations</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#distributions-of-count-data"><i class="fa fa-check"></i><b>4.2</b> Distributions of count data</a></li>
<li class="chapter" data-level="4.3" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#aggregate"><i class="fa fa-check"></i><b>4.3</b> Aggregate</a></li>
<li class="chapter" data-level="4.4" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#tidyverse"><i class="fa fa-check"></i><b>4.4</b> Tidyverse</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="inferential-statistics.html"><a href="inferential-statistics.html"><i class="fa fa-check"></i><b>5</b> Inferential statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="inferential-statistics.html"><a href="inferential-statistics.html#intro"><i class="fa fa-check"></i><b>5.1</b> Intro</a></li>
<li class="chapter" data-level="5.2" data-path="inferential-statistics.html"><a href="inferential-statistics.html#hypothesis-testing"><i class="fa fa-check"></i><b>5.2</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="inferential-statistics.html"><a href="inferential-statistics.html#power"><i class="fa fa-check"></i><b>5.2.1</b> Power</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="inferential-statistics.html"><a href="inferential-statistics.html#confidence-intervals"><i class="fa fa-check"></i><b>5.3</b> Confidence intervals</a></li>
<li class="chapter" data-level="5.4" data-path="inferential-statistics.html"><a href="inferential-statistics.html#t-test"><i class="fa fa-check"></i><b>5.4</b> T-test</a></li>
<li class="chapter" data-level="5.5" data-path="inferential-statistics.html"><a href="inferential-statistics.html#f-test"><i class="fa fa-check"></i><b>5.5</b> F-test</a></li>
<li class="chapter" data-level="5.6" data-path="inferential-statistics.html"><a href="inferential-statistics.html#analysis-of-variance-anova"><i class="fa fa-check"></i><b>5.6</b> Analysis of Variance (ANOVA)</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="inferential-statistics.html"><a href="inferential-statistics.html#one-way-anova"><i class="fa fa-check"></i><b>5.6.1</b> One-way ANOVA</a></li>
<li class="chapter" data-level="5.6.2" data-path="inferential-statistics.html"><a href="inferential-statistics.html#two-way-anova"><i class="fa fa-check"></i><b>5.6.2</b> Two-way ANOVA</a></li>
<li class="chapter" data-level="5.6.3" data-path="inferential-statistics.html"><a href="inferential-statistics.html#post-hoc-test---tukeys-honest-significant-difference"><i class="fa fa-check"></i><b>5.6.3</b> Post hoc test - Tukeyâs Honest Significant Difference</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="inferential-statistics.html"><a href="inferential-statistics.html#introduction-to-linear-and-mixed-models"><i class="fa fa-check"></i><b>5.7</b> Introduction to linear and mixed models</a></li>
<li class="chapter" data-level="5.8" data-path="inferential-statistics.html"><a href="inferential-statistics.html#normal-and-mixed-models"><i class="fa fa-check"></i><b>5.8</b> Normal and Mixed models</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="inferential-statistics.html"><a href="inferential-statistics.html#normal-model"><i class="fa fa-check"></i><b>5.8.1</b> Normal model</a></li>
<li class="chapter" data-level="5.8.2" data-path="inferential-statistics.html"><a href="inferential-statistics.html#mixed-model"><i class="fa fa-check"></i><b>5.8.2</b> Mixed model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introduction-to-pca-and-multivariate-data.html"><a href="introduction-to-pca-and-multivariate-data.html"><i class="fa fa-check"></i><b>6</b> Introduction to PCA and multivariate data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="introduction-to-pca-and-multivariate-data.html"><a href="introduction-to-pca-and-multivariate-data.html#a-bit-of-math"><i class="fa fa-check"></i><b>6.1</b> A bit of math</a></li>
<li class="chapter" data-level="6.2" data-path="introduction-to-pca-and-multivariate-data.html"><a href="introduction-to-pca-and-multivariate-data.html#interpreting-model-output"><i class="fa fa-check"></i><b>6.2</b> Interpreting model output</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="introduction-to-pca-and-multivariate-data.html"><a href="introduction-to-pca-and-multivariate-data.html#biplot"><i class="fa fa-check"></i><b>6.2.1</b> Biplot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html"><i class="fa fa-check"></i><b>7</b> Buffet and survey data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html#buffet-data"><i class="fa fa-check"></i><b>7.1</b> Buffet data</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html#introduction-to-buffet-data"><i class="fa fa-check"></i><b>7.1.1</b> Introduction to buffet data</a></li>
<li class="chapter" data-level="7.1.2" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html#plotting-buffet-data"><i class="fa fa-check"></i><b>7.1.2</b> Plotting buffet data</a></li>
<li class="chapter" data-level="7.1.3" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html#mixed-model-for-buffet-data"><i class="fa fa-check"></i><b>7.1.3</b> Mixed model for buffet data</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html#survey-data"><i class="fa fa-check"></i><b>7.2</b> Survey data</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html#plotting-survey-data"><i class="fa fa-check"></i><b>7.2.1</b> Plotting survey data</a></li>
<li class="chapter" data-level="7.2.2" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html#linear-model-for-buffet-data"><i class="fa fa-check"></i><b>7.2.2</b> Linear model for buffet data</a></li>
<li class="chapter" data-level="7.2.3" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html#post-hoc-test-for-survey-data"><i class="fa fa-check"></i><b>7.2.3</b> Post-hoc test for survey data</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html#combining-consumption-and-survey-data"><i class="fa fa-check"></i><b>7.3</b> Combining consumption and survey data</a></li>
<li class="chapter" data-level="7.4" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html#pca-on-survey-answers"><i class="fa fa-check"></i><b>7.4</b> PCA on survey answers</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html#wrangle-data"><i class="fa fa-check"></i><b>7.4.1</b> Wrangle data</a></li>
<li class="chapter" data-level="7.4.2" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html#build-the-model"><i class="fa fa-check"></i><b>7.4.2</b> Build the model</a></li>
<li class="chapter" data-level="7.4.3" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html#bi-plot"><i class="fa fa-check"></i><b>7.4.3</b> Bi-plot</a></li>
<li class="chapter" data-level="7.4.4" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html#extract-the-components-and-run-all-associations."><i class="fa fa-check"></i><b>7.4.4</b> Extract the components and run all associations.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mst-exercises.html"><a href="mst-exercises.html"><i class="fa fa-check"></i><b>8</b> MST exercises</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mst-exercises.html"><a href="mst-exercises.html#exercise-1---cleaning-compusense-data-with-r"><i class="fa fa-check"></i><b>8.1</b> Exercise 1 - cleaning Compusense data with R</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="mst-exercises.html"><a href="mst-exercises.html#exercise-1---solution"><i class="fa fa-check"></i><b>8.1.1</b> Exercise 1 - Solution</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="mst-exercises.html"><a href="mst-exercises.html#exercise-2---creating-a-tableone-and-visualization"><i class="fa fa-check"></i><b>8.2</b> Exercise 2 - creating a tableone and visualization</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="mst-exercises.html"><a href="mst-exercises.html#exercise-2---solution"><i class="fa fa-check"></i><b>8.2.1</b> Exercise 2 - solution</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="mst-exercises.html"><a href="mst-exercises.html#exercise-3---creating-an-outcome-table"><i class="fa fa-check"></i><b>8.3</b> Exercise 3 - Creating an outcome table</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="mst-exercises.html"><a href="mst-exercises.html#exercise-3---solution"><i class="fa fa-check"></i><b>8.3.1</b> Exercise 3 - Solution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="intro-to-large-survey-data.html"><a href="intro-to-large-survey-data.html"><i class="fa fa-check"></i><b>9</b> Intro to large survey data</a>
<ul>
<li class="chapter" data-level="9.0.1" data-path="intro-to-large-survey-data.html"><a href="intro-to-large-survey-data.html#looking-at-the-data-and-checking-formating"><i class="fa fa-check"></i><b>9.0.1</b> Looking at the data and checking formating</a></li>
<li class="chapter" data-level="9.1" data-path="intro-to-large-survey-data.html"><a href="intro-to-large-survey-data.html#descriptive-statistics-1"><i class="fa fa-check"></i><b>9.1</b> Descriptive statistics</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="intro-to-large-survey-data.html"><a href="intro-to-large-survey-data.html#numeric-values"><i class="fa fa-check"></i><b>9.1.1</b> Numeric values</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="intro-to-large-survey-data.html"><a href="intro-to-large-survey-data.html#plots"><i class="fa fa-check"></i><b>9.2</b> Plots</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="intro-to-large-survey-data.html"><a href="intro-to-large-survey-data.html#within-groups-of-data"><i class="fa fa-check"></i><b>9.2.1</b> Within groups of data</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="intro-to-large-survey-data.html"><a href="intro-to-large-survey-data.html#categorical-ordinal-variables"><i class="fa fa-check"></i><b>9.3</b> Categorical / Ordinal variables</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="intro-to-large-survey-data.html"><a href="intro-to-large-survey-data.html#tables"><i class="fa fa-check"></i><b>9.3.1</b> Tables</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="intro-to-large-survey-data.html"><a href="intro-to-large-survey-data.html#table-1"><i class="fa fa-check"></i><b>9.4</b> Table 1</a></li>
<li class="chapter" data-level="9.5" data-path="intro-to-large-survey-data.html"><a href="intro-to-large-survey-data.html#the-tidyverse-way"><i class="fa fa-check"></i><b>9.5</b> The tidyverse way</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="consumer-segmentation.html"><a href="consumer-segmentation.html"><i class="fa fa-check"></i><b>10</b> Consumer segmentation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="consumer-segmentation.html"><a href="consumer-segmentation.html#segmentation"><i class="fa fa-check"></i><b>10.1</b> Segmentation</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="consumer-segmentation.html"><a href="consumer-segmentation.html#using-k-means-for-clustering"><i class="fa fa-check"></i><b>10.1.1</b> Using K-means for clustering</a></li>
<li class="chapter" data-level="10.1.2" data-path="consumer-segmentation.html"><a href="consumer-segmentation.html#initial-characterization-of-clusters"><i class="fa fa-check"></i><b>10.1.2</b> Initial characterization of clusters</a></li>
<li class="chapter" data-level="10.1.3" data-path="consumer-segmentation.html"><a href="consumer-segmentation.html#vizualization-of-the-clusters"><i class="fa fa-check"></i><b>10.1.3</b> Vizualization of the clusters</a></li>
<li class="chapter" data-level="10.1.4" data-path="consumer-segmentation.html"><a href="consumer-segmentation.html#sums-of-squares-from-the-clustering"><i class="fa fa-check"></i><b>10.1.4</b> Sums of Squares from the clustering</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="consumer-segmentation.html"><a href="consumer-segmentation.html#selecting-the-number-of-clusters---a-data-driven-approach"><i class="fa fa-check"></i><b>10.2</b> Selecting the number of clusters - a data-driven approach</a></li>
<li class="chapter" data-level="10.3" data-path="consumer-segmentation.html"><a href="consumer-segmentation.html#segmentation---another-example"><i class="fa fa-check"></i><b>10.3</b> Segmentation - another example</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="consumer-segmentation.html"><a href="consumer-segmentation.html#cluster-analysis"><i class="fa fa-check"></i><b>10.3.1</b> Cluster analysis</a></li>
<li class="chapter" data-level="10.3.2" data-path="consumer-segmentation.html"><a href="consumer-segmentation.html#plot-the-model-using-pca"><i class="fa fa-check"></i><b>10.3.2</b> Plot the model using PCA</a></li>
<li class="chapter" data-level="10.3.3" data-path="consumer-segmentation.html"><a href="consumer-segmentation.html#add-to-dataset"><i class="fa fa-check"></i><b>10.3.3</b> Add to dataset</a></li>
<li class="chapter" data-level="10.3.4" data-path="consumer-segmentation.html"><a href="consumer-segmentation.html#comments"><i class="fa fa-check"></i><b>10.3.4</b> Comments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="profiling-segments.html"><a href="profiling-segments.html"><i class="fa fa-check"></i><b>11</b> Profiling segments</a>
<ul>
<li class="chapter" data-level="11.1" data-path="profiling-segments.html"><a href="profiling-segments.html#table-1-as-a-profiling-tool"><i class="fa fa-check"></i><b>11.1</b> Table 1 as a profiling tool</a></li>
<li class="chapter" data-level="11.2" data-path="profiling-segments.html"><a href="profiling-segments.html#visualization-of-consumer-segments"><i class="fa fa-check"></i><b>11.2</b> Visualization of Consumer Segments</a></li>
<li class="chapter" data-level="11.3" data-path="profiling-segments.html"><a href="profiling-segments.html#creating-the-contingency-table"><i class="fa fa-check"></i><b>11.3</b> Creating the contingency table</a></li>
<li class="chapter" data-level="11.4" data-path="profiling-segments.html"><a href="profiling-segments.html#plot-the-numbers"><i class="fa fa-check"></i><b>11.4</b> Plot the numbers</a></li>
<li class="chapter" data-level="11.5" data-path="profiling-segments.html"><a href="profiling-segments.html#contingency-table"><i class="fa fa-check"></i><b>11.5</b> Contingency table</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="profiling-segments.html"><a href="profiling-segments.html#pearson-chi-square-test"><i class="fa fa-check"></i><b>11.5.1</b> Pearson Chi-square test</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="profiling-segments.html"><a href="profiling-segments.html#correspondence-analysis"><i class="fa fa-check"></i><b>11.6</b> Correspondence Analysis</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>12</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="12.1" data-path="logistic-regression.html"><a href="logistic-regression.html#segmentationclustering"><i class="fa fa-check"></i><b>12.1</b> Segmentation/Clustering</a></li>
<li class="chapter" data-level="12.2" data-path="logistic-regression.html"><a href="logistic-regression.html#fitting-the-logistic-regression-model"><i class="fa fa-check"></i><b>12.2</b> Fitting the logistic regression-model</a></li>
<li class="chapter" data-level="12.3" data-path="logistic-regression.html"><a href="logistic-regression.html#probabilities-of-segment-membership"><i class="fa fa-check"></i><b>12.3</b> Probabilities of segment membership:</a></li>
<li class="chapter" data-level="12.4" data-path="logistic-regression.html"><a href="logistic-regression.html#odds-ratios"><i class="fa fa-check"></i><b>12.4</b> Odds ratios</a></li>
<li class="chapter" data-level="12.5" data-path="logistic-regression.html"><a href="logistic-regression.html#ors-and-probs"><i class="fa fa-check"></i><b>12.5</b> ORs and Probs</a></li>
<li class="chapter" data-level="12.6" data-path="logistic-regression.html"><a href="logistic-regression.html#effect-of-age"><i class="fa fa-check"></i><b>12.6</b> Effect of Age</a></li>
<li class="chapter" data-level="12.7" data-path="logistic-regression.html"><a href="logistic-regression.html#multivariate-analysis"><i class="fa fa-check"></i><b>12.7</b> Multivariate analysis</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="logistic-regression.html"><a href="logistic-regression.html#descriptives"><i class="fa fa-check"></i><b>12.7.1</b> Descriptives</a></li>
<li class="chapter" data-level="12.7.2" data-path="logistic-regression.html"><a href="logistic-regression.html#two-nested-models"><i class="fa fa-check"></i><b>12.7.2</b> Two nested models</a></li>
<li class="chapter" data-level="12.7.3" data-path="logistic-regression.html"><a href="logistic-regression.html#coefficients"><i class="fa fa-check"></i><b>12.7.3</b> Coefficients</a></li>
<li class="chapter" data-level="12.7.4" data-path="logistic-regression.html"><a href="logistic-regression.html#re-level"><i class="fa fa-check"></i><b>12.7.4</b> Re-level</a></li>
<li class="chapter" data-level="12.7.5" data-path="logistic-regression.html"><a href="logistic-regression.html#all-pairwise-comparisons"><i class="fa fa-check"></i><b>12.7.5</b> All pairwise comparisons</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="logistic-regression.html"><a href="logistic-regression.html#segment-2-and-3"><i class="fa fa-check"></i><b>12.8</b> Segment 2 and 3</a></li>
<li class="chapter" data-level="12.9" data-path="logistic-regression.html"><a href="logistic-regression.html#a-new-set-of-data"><i class="fa fa-check"></i><b>12.9</b> A new set of data</a></li>
<li class="chapter" data-level="12.10" data-path="logistic-regression.html"><a href="logistic-regression.html#logistic-regression-for-demographic-characterization"><i class="fa fa-check"></i><b>12.10</b> Logistic regression for demographic characterization</a>
<ul>
<li class="chapter" data-level="12.10.1" data-path="logistic-regression.html"><a href="logistic-regression.html#age"><i class="fa fa-check"></i><b>12.10.1</b> Age</a></li>
<li class="chapter" data-level="12.10.2" data-path="logistic-regression.html"><a href="logistic-regression.html#gender"><i class="fa fa-check"></i><b>12.10.2</b> Gender</a></li>
</ul></li>
<li class="chapter" data-level="12.11" data-path="logistic-regression.html"><a href="logistic-regression.html#task"><i class="fa fa-check"></i><b>12.11</b> TASK</a></li>
<li class="chapter" data-level="12.12" data-path="logistic-regression.html"><a href="logistic-regression.html#the-tidyverse-way-1"><i class="fa fa-check"></i><b>12.12</b> The tidyverse way</a></li>
<li class="chapter" data-level="12.13" data-path="logistic-regression.html"><a href="logistic-regression.html#comment"><i class="fa fa-check"></i><b>12.13</b> Comment</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="cata-data-check-all-that-apply.html"><a href="cata-data-check-all-that-apply.html"><i class="fa fa-check"></i><b>13</b> CATA data (Check-All-That-Apply)</a>
<ul>
<li class="chapter" data-level="13.1" data-path="cata-data-check-all-that-apply.html"><a href="cata-data-check-all-that-apply.html#importing-and-looking-at-the-beer-data"><i class="fa fa-check"></i><b>13.1</b> Importing and looking at the beer data</a></li>
<li class="chapter" data-level="13.2" data-path="cata-data-check-all-that-apply.html"><a href="cata-data-check-all-that-apply.html#two-versions-of-the-data"><i class="fa fa-check"></i><b>13.2</b> Two versions of the data</a></li>
<li class="chapter" data-level="13.3" data-path="cata-data-check-all-that-apply.html"><a href="cata-data-check-all-that-apply.html#cochrans-q-test"><i class="fa fa-check"></i><b>13.3</b> Cochranâs Q test</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="cata-data-check-all-that-apply.html"><a href="cata-data-check-all-that-apply.html#post-hoc-test"><i class="fa fa-check"></i><b>13.3.1</b> Post hoc test</a></li>
<li class="chapter" data-level="13.3.2" data-path="cata-data-check-all-that-apply.html"><a href="cata-data-check-all-that-apply.html#for-all-attributes-in-one-run-nice-to-know"><i class="fa fa-check"></i><b>13.3.2</b> For all attributes in one run (nice to know)</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="cata-data-check-all-that-apply.html"><a href="cata-data-check-all-that-apply.html#pca-on-cata-data"><i class="fa fa-check"></i><b>13.4</b> PCA on CATA data</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="hedonic-rating-e.g.-liking-scores.html"><a href="hedonic-rating-e.g.-liking-scores.html"><i class="fa fa-check"></i><b>14</b> Hedonic rating (e.g.Â liking scores)</a>
<ul>
<li class="chapter" data-level="14.1" data-path="hedonic-rating-e.g.-liking-scores.html"><a href="hedonic-rating-e.g.-liking-scores.html#plotting-liking-scores"><i class="fa fa-check"></i><b>14.1</b> Plotting liking scores</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="hedonic-rating-e.g.-liking-scores.html"><a href="hedonic-rating-e.g.-liking-scores.html#pca-of-hedonic-ratings"><i class="fa fa-check"></i><b>14.1.1</b> PCA of hedonic ratings</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="hedonic-rating-e.g.-liking-scores.html"><a href="hedonic-rating-e.g.-liking-scores.html#simple-mixed-models"><i class="fa fa-check"></i><b>14.2</b> Simple mixed models</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="hedonic-rating-e.g.-liking-scores.html"><a href="hedonic-rating-e.g.-liking-scores.html#post-hoc-test-1"><i class="fa fa-check"></i><b>14.2.1</b> Post hoc test</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="hedonic-rating-e.g.-liking-scores.html"><a href="hedonic-rating-e.g.-liking-scores.html#multivariable-models"><i class="fa fa-check"></i><b>14.3</b> Multivariable models</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="hedonic-rating-e.g.-liking-scores.html"><a href="hedonic-rating-e.g.-liking-scores.html#additive-models"><i class="fa fa-check"></i><b>14.3.1</b> Additive models</a></li>
<li class="chapter" data-level="14.3.2" data-path="hedonic-rating-e.g.-liking-scores.html"><a href="hedonic-rating-e.g.-liking-scores.html#effect-modification-and-interactions"><i class="fa fa-check"></i><b>14.3.2</b> Effect modification and Interactions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="cata-and-hedonics.html"><a href="cata-and-hedonics.html"><i class="fa fa-check"></i><b>15</b> CATA and Hedonics</a>
<ul>
<li class="chapter" data-level="15.1" data-path="cata-and-hedonics.html"><a href="cata-and-hedonics.html#individual-attributes-and-liking"><i class="fa fa-check"></i><b>15.1</b> Individual attributes and liking</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="cata-and-hedonics.html"><a href="cata-and-hedonics.html#an-example-with-refreshing"><i class="fa fa-check"></i><b>15.1.1</b> An example with Refreshing</a></li>
<li class="chapter" data-level="15.1.2" data-path="cata-and-hedonics.html"><a href="cata-and-hedonics.html#all-attributes"><i class="fa fa-check"></i><b>15.1.2</b> All attributes</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="cata-and-hedonics.html"><a href="cata-and-hedonics.html#pca-on-cata-and-liking"><i class="fa fa-check"></i><b>15.2</b> PCA on CATA and Liking</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="cata-and-hedonics.html"><a href="cata-and-hedonics.html#a-beer-centric-model"><i class="fa fa-check"></i><b>15.2.1</b> A beer centric model</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="cata-and-hedonics.html"><a href="cata-and-hedonics.html#analysis-by-pls"><i class="fa fa-check"></i><b>15.3</b> Analysis by PLS</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="cata-and-hedonics.html"><a href="cata-and-hedonics.html#pls-basics"><i class="fa fa-check"></i><b>15.3.1</b> PLS basics</a></li>
<li class="chapter" data-level="15.3.2" data-path="cata-and-hedonics.html"><a href="cata-and-hedonics.html#pls-to-predict-liking-based-on-cata-data"><i class="fa fa-check"></i><b>15.3.2</b> PLS to predict liking based on CATA data</a></li>
<li class="chapter" data-level="15.3.3" data-path="cata-and-hedonics.html"><a href="cata-and-hedonics.html#regression-coefficients"><i class="fa fa-check"></i><b>15.3.3</b> Regression coefficients</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="cata-and-hedonics.html"><a href="cata-and-hedonics.html#l-pls"><i class="fa fa-check"></i><b>15.4</b> L-PLS</a></li>
<li class="chapter" data-level="15.5" data-path="cata-and-hedonics.html"><a href="cata-and-hedonics.html#creating-x1-x2-x3."><i class="fa fa-check"></i><b>15.5</b> Creating X1, X2, X3.</a></li>
<li class="chapter" data-level="15.6" data-path="cata-and-hedonics.html"><a href="cata-and-hedonics.html#building-the-model-the-l-pls-model-can-be-built-using-the-lpls"><i class="fa fa-check"></i><b>15.6</b> Building the model: The L-PLS model can be built, using the <em>lpls</em></a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="cata-and-hedonics.html"><a href="cata-and-hedonics.html#finding-the-explained-variance-for-exo-l-pls"><i class="fa fa-check"></i><b>15.6.1</b> Finding the explained variance for exo L-PLS</a></li>
<li class="chapter" data-level="15.6.2" data-path="cata-and-hedonics.html"><a href="cata-and-hedonics.html#cross-validation-next-let-us-have-a-look-how-many-components-we"><i class="fa fa-check"></i><b>15.6.2</b> Cross-validation Next let us have a look how many components we</a></li>
<li class="chapter" data-level="15.6.3" data-path="cata-and-hedonics.html"><a href="cata-and-hedonics.html#vizulization-now-we-would-like-to-visuzlalize-our-l-pls-model.-when"><i class="fa fa-check"></i><b>15.6.3</b> Vizulization Now we would like to visuzlalize our L-PLS model. When</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="projective-mapping.html"><a href="projective-mapping.html"><i class="fa fa-check"></i><b>16</b> Projective mapping</a>
<ul>
<li class="chapter" data-level="16.1" data-path="projective-mapping.html"><a href="projective-mapping.html#example-from-mapping-of-xx"><i class="fa fa-check"></i><b>16.1</b> Example from mapping of XX</a></li>
<li class="chapter" data-level="16.2" data-path="projective-mapping.html"><a href="projective-mapping.html#a-collated-version-of-the-data"><i class="fa fa-check"></i><b>16.2</b> A Collated version of the data</a></li>
<li class="chapter" data-level="16.3" data-path="projective-mapping.html"><a href="projective-mapping.html#pca-on-collated-data"><i class="fa fa-check"></i><b>16.3</b> PCA on Collated data</a></li>
<li class="chapter" data-level="16.4" data-path="projective-mapping.html"><a href="projective-mapping.html#section"><i class="fa fa-check"></i><b>16.4</b> </a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="tfih-exercises.html"><a href="tfih-exercises.html"><i class="fa fa-check"></i><b>17</b> TFIH Exercises</a>
<ul>
<li class="chapter" data-level="17.1" data-path="tfih-exercises.html"><a href="tfih-exercises.html#exercise-1-descriptive-statistics-and-plots"><i class="fa fa-check"></i><b>17.1</b> Exercise 1: Descriptive statistics and plots</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="tfih-exercises.html"><a href="tfih-exercises.html#cata-counts"><i class="fa fa-check"></i><b>17.1.1</b> CATA counts</a></li>
<li class="chapter" data-level="17.1.2" data-path="tfih-exercises.html"><a href="tfih-exercises.html#hedonics"><i class="fa fa-check"></i><b>17.1.2</b> Hedonics</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="tfih-exercises.html"><a href="tfih-exercises.html#exercise-2-consumer-background-and-pca"><i class="fa fa-check"></i><b>17.2</b> Exercise 2: Consumer background and PCA</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="tfih-exercises.html"><a href="tfih-exercises.html#demographics"><i class="fa fa-check"></i><b>17.2.1</b> Demographics</a></li>
<li class="chapter" data-level="17.2.2" data-path="tfih-exercises.html"><a href="tfih-exercises.html#pca-on-interests"><i class="fa fa-check"></i><b>17.2.2</b> PCA on <em>Interests</em></a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="tfih-exercises.html"><a href="tfih-exercises.html#exercise-3-pca-on-cata-counts"><i class="fa fa-check"></i><b>17.3</b> Exercise 3: PCA on CATA counts</a></li>
<li class="chapter" data-level="17.4" data-path="tfih-exercises.html"><a href="tfih-exercises.html#exercise-4-cochrans-q-test-on-cata-binary-data"><i class="fa fa-check"></i><b>17.4</b> Exercise 4: Cochranâs Q test on CATA binary data</a></li>
<li class="chapter" data-level="17.5" data-path="tfih-exercises.html"><a href="tfih-exercises.html#exercise-5-hedonic-ratings-and-consumer-characteristics"><i class="fa fa-check"></i><b>17.5</b> Exercise 5: Hedonic ratings and consumer characteristics</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="tfih-exercises.html"><a href="tfih-exercises.html#pca-on-joint-data"><i class="fa fa-check"></i><b>17.5.1</b> PCA on joint data</a></li>
<li class="chapter" data-level="17.5.2" data-path="tfih-exercises.html"><a href="tfih-exercises.html#all-demographics"><i class="fa fa-check"></i><b>17.5.2</b> All demographics</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="tfih-exercises.html"><a href="tfih-exercises.html#exercise-6-pca-on-cata-counts-and-hedonic-ratings"><i class="fa fa-check"></i><b>17.6</b> Exercise 6: PCA on CATA counts and hedonic ratings</a></li>
<li class="chapter" data-level="17.7" data-path="tfih-exercises.html"><a href="tfih-exercises.html#exercise-7-mixed-modelling-on-hedonic-ratings"><i class="fa fa-check"></i><b>17.7</b> Exercise 7: Mixed modelling on hedonic ratings</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="chapters-to-appear.html"><a href="chapters-to-appear.html"><i class="fa fa-check"></i><b>18</b> CHAPTERS to APPEAR</a></li>
<li class="chapter" data-level="19" data-path="latent-factor-models.html"><a href="latent-factor-models.html"><i class="fa fa-check"></i><b>19</b> Latent Factor Models</a></li>
<li class="chapter" data-level="20" data-path="lpls.html"><a href="lpls.html"><i class="fa fa-check"></i><b>20</b> LPLS</a></li>
<li class="chapter" data-level="21" data-path="confirmatory-factor-analysis-using-lavaan.html"><a href="confirmatory-factor-analysis-using-lavaan.html"><i class="fa fa-check"></i><b>21</b> Confirmatory Factor Analysis using lavaan</a>
<ul>
<li class="chapter" data-level="21.1" data-path="confirmatory-factor-analysis-using-lavaan.html"><a href="confirmatory-factor-analysis-using-lavaan.html#example---food-neophobia"><i class="fa fa-check"></i><b>21.1</b> Example - Food Neophobia</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="structured-equation-modelling.html"><a href="structured-equation-modelling.html"><i class="fa fa-check"></i><b>22</b> Structured Equation Modelling</a>
<ul>
<li class="chapter" data-level="22.1" data-path="structured-equation-modelling.html"><a href="structured-equation-modelling.html#example---theory-of-planned-behaviour"><i class="fa fa-check"></i><b>22.1</b> Example - Theory of Planned Behaviour</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="plsda-on-cata-and-liking.html"><a href="plsda-on-cata-and-liking.html"><i class="fa fa-check"></i><b>23</b> PLSDA on CATA and liking</a></li>
<li class="chapter" data-level="24" data-path="text-mining-of-comsumer-reviews.html"><a href="text-mining-of-comsumer-reviews.html"><i class="fa fa-check"></i><b>24</b> Text mining of comsumer reviews</a></li>
<li class="chapter" data-level="25" data-path="text-mining-of-open-ended-survey-responses.html"><a href="text-mining-of-open-ended-survey-responses.html"><i class="fa fa-check"></i><b>25</b> Text mining of open-ended survey responses</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis in R for Sensory and Consumer Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="logistic-regression" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">Chapter 12</span> Logistic Regression<a href="logistic-regression.html#logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Logistic regression is regression towards a binary response.
In short regression were developed towards continuous responses, and is what is supported in R using the <em>lm()</em> function. However, there exits other type of responses, including binary, counts, etc. where the aim of the statistical analysis is still to use a regression type of model. This has given rise to the use of generalized linear models, where several response types can be analysis in a regression framework. In R this is done using the <em>glm()</em> function, extended with a specification of the response type using the <em>family</em> argument.</p>
<p>Logistic regression aims to model the probability of observing case (versus control) given the input. The outputs from such a model is odds ratios.</p>
<p>This video takes you through some basics. If you want to dive directly at logistic regression, then dive in from <em>6.53</em>.</p>
<div class="vembedr">
<div>
<iframe src="https://www.youtube.com/embed/https://www.youtube.com/watch?v=C4N3_XJJ-jU" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<p>In this chapter, we are going to use logistic regression for characterizing clusters. This is simply done by constructing binary classes based on the clusters as <strong>belong to cluster k</strong> versus <strong>not belong to cluster k</strong>. Even with more than two clusters binary endpoints can be constructed in this way. Alternatively, if there is one of the clusters which naturally is a reference cluster, then comparing the individual clusters to this one is also a way forward.</p>
<p>The data used in this chapter is from the paper: <em>Verbeke, Wim, Federico JA PÃ©rez-Cueto, and Klaus G. Grunert. âTo eat or not to eat pork, how frequently and how varied? Insights from the quantitative Q-PorkChains consumer survey in four European countries.â Meat science 88.4 (2011): 619-626.</em> and can be found in the <em>data4consumerscience</em>-package as <em>pork</em>.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="logistic-regression.html#cb229-1" tabindex="-1"></a><span class="fu">library</span>(data4consumerscience)</span>
<span id="cb229-2"><a href="logistic-regression.html#cb229-2" tabindex="-1"></a><span class="fu">data</span>(pork)</span></code></pre></div>
<div id="segmentationclustering" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> Segmentation/Clustering<a href="logistic-regression.html#segmentationclustering" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the dataset there are three clusters encoded as binary membership variables: cluster1, cluster2 and cluster3. They are mutually exclusive.</p>
<p>These clusters are based on another clustering procedure than k-means, but in principle any clustering can be used to generate clustersâ¦ as long as they are meaningful.</p>
<p>Here we just plot them to see how they appear on the two variables used for their construction.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="logistic-regression.html#cb230-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb230-2"><a href="logistic-regression.html#cb230-2" tabindex="-1"></a><span class="fu">library</span>(tableone)</span>
<span id="cb230-3"><a href="logistic-regression.html#cb230-3" tabindex="-1"></a></span>
<span id="cb230-4"><a href="logistic-regression.html#cb230-4" tabindex="-1"></a>pork<span class="sc">$</span>clusters <span class="ot">&lt;-</span> pork<span class="sc">$</span>cluster1<span class="sc">*</span><span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb230-5"><a href="logistic-regression.html#cb230-5" tabindex="-1"></a>  pork<span class="sc">$</span>cluster2<span class="sc">*</span><span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb230-6"><a href="logistic-regression.html#cb230-6" tabindex="-1"></a>  pork<span class="sc">$</span>cluster3<span class="sc">*</span><span class="dv">3</span>  </span>
<span id="cb230-7"><a href="logistic-regression.html#cb230-7" tabindex="-1"></a>  </span>
<span id="cb230-8"><a href="logistic-regression.html#cb230-8" tabindex="-1"></a><span class="fu">plot</span>(TotalPorkWeek <span class="sc">~</span> VarietyTotal, <span class="at">data =</span> pork, </span>
<span id="cb230-9"><a href="logistic-regression.html#cb230-9" tabindex="-1"></a>     <span class="at">col =</span> pork[[<span class="st">&quot;clusters&quot;</span>]] <span class="sc">+</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-135-1.png" width="432" /></p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="logistic-regression.html#cb231-1" tabindex="-1"></a><span class="co">#Or using ggplot2:</span></span>
<span id="cb231-2"><a href="logistic-regression.html#cb231-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> pork, <span class="fu">aes</span>(<span class="at">x =</span> VarietyTotal, <span class="at">y =</span> TotalPorkWeek,<span class="at">color =</span> <span class="fu">factor</span>(clusters))) <span class="sc">+</span> </span>
<span id="cb231-3"><a href="logistic-regression.html#cb231-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb231-4"><a href="logistic-regression.html#cb231-4" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="st">&#39;Cluster&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb231-5"><a href="logistic-regression.html#cb231-5" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-135-2.png" width="432" /></p>
</div>
<div id="fitting-the-logistic-regression-model" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> Fitting the logistic regression-model<a href="logistic-regression.html#fitting-the-logistic-regression-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The question we are going to adress here is <em>is gender related to the being in cluster 1?</em>. Other tools for this is covered in <a href="profiling-segments.html#profiling-segments">Profiling segments</a>, but here we will see how logistic regression can be used for this.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="logistic-regression.html#cb232-1" tabindex="-1"></a>pork[[<span class="st">&quot;Gender&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(pork[[<span class="st">&quot;Gender&quot;</span>]])</span>
<span id="cb232-2"><a href="logistic-regression.html#cb232-2" tabindex="-1"></a><span class="co"># 1: Male, 2: Female</span></span>
<span id="cb232-3"><a href="logistic-regression.html#cb232-3" tabindex="-1"></a></span>
<span id="cb232-4"><a href="logistic-regression.html#cb232-4" tabindex="-1"></a><span class="do">## Fitting logistic model</span></span>
<span id="cb232-5"><a href="logistic-regression.html#cb232-5" tabindex="-1"></a>logreg.<span class="fl">1.</span>gender <span class="ot">&lt;-</span> <span class="fu">glm</span>(cluster1 <span class="sc">~</span> <span class="fu">factor</span>(Gender), <span class="at">data =</span> pork, <span class="at">family =</span> binomial)</span>
<span id="cb232-6"><a href="logistic-regression.html#cb232-6" tabindex="-1"></a><span class="fu">summary</span>(logreg.<span class="fl">1.</span>gender)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = cluster1 ~ factor(Gender), family = binomial, data = pork)
## 
## Coefficients:
##                 Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)      -0.7419     0.0537 -13.815  &lt; 2e-16 ***
## factor(Gender)1   0.2521     0.0537   4.695 2.67e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2060.3  on 1627  degrees of freedom
## Residual deviance: 2037.9  on 1626  degrees of freedom
##   (5 observations deleted due to missingness)
## AIC: 2041.9
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>This model indicates Gender is related to cluster1 as the p-value is highly significant.</p>
</div>
<div id="probabilities-of-segment-membership" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> Probabilities of segment membership:<a href="logistic-regression.html#probabilities-of-segment-membership" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One way to get the direction is to interpret the coefficients from the summary() output, but alternatively, simply using the model to predict membership probabilities will give similar insight.</p>
<p>Here the probability of beloging to cluster 1 is predicted for the situation where Gender is <span class="math inline">\(1\)</span> as well as <span class="math inline">\(2\)</span>. Be aware that such predictions should match with the data source used for building the model. Here that means, that if Gender is encoded with numbers (1 or 2), then the predictions are likewise done usign those. If the Gender is encoded with <em>male</em> and <em>female</em>, then that it the inputs when doing predictions.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="logistic-regression.html#cb234-1" tabindex="-1"></a><span class="fu">predict</span>(logreg.<span class="fl">1.</span>gender, <span class="fu">data.frame</span>(<span class="at">Gender =</span> <span class="st">&quot;1&quot;</span>), </span>
<span id="cb234-2"><a href="logistic-regression.html#cb234-2" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>##         1 
## 0.3799534</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="logistic-regression.html#cb236-1" tabindex="-1"></a><span class="fu">predict</span>(logreg.<span class="fl">1.</span>gender, <span class="fu">data.frame</span>(<span class="at">Gender =</span> <span class="st">&quot;2&quot;</span>), </span>
<span id="cb236-2"><a href="logistic-regression.html#cb236-2" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<pre><code>##         1 
## 0.2701299</code></pre>
<p>What we see it that the probablity of belonging to cluster1 is higher if the Gender is <span class="math inline">\(1\)</span> (in reference to <span class="math inline">\(2\)</span>). This is obviously in line with the results in <a href="profiling-segments.html#contingency-table">Contingency table</a> and <a href="profiling-segments.html#pearson-chi-square-test">Pearson Chi-square test</a> in the former chapter.</p>
</div>
<div id="odds-ratios" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> Odds ratios<a href="logistic-regression.html#odds-ratios" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Odds ratio is the terminology used for interpreting coefficients from a logistic regression model.
In the direct read out of coefficients from summary() returns the natural logarithm of the oddsratio, and hence to get odds ratios the exponential function is used.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="logistic-regression.html#cb238-1" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(logreg.<span class="fl">1.</span>gender))[<span class="dv">2</span>, <span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1.286736</code></pre>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="logistic-regression.html#cb240-1" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">confint</span>(logreg.<span class="fl">1.</span>gender)[<span class="dv">2</span>, ])</span></code></pre></div>
<pre><code>##    2.5 %   97.5 % 
## 1.158605 1.430157</code></pre>
<p>Here is it seen that odds of belonging to cluster1 is in favor of gender <span class="math inline">\(1\)</span> as both the estimate and its confidence bounds are above 1.</p>
</div>
<div id="ors-and-probs" class="section level2 hasAnchor" number="12.5">
<h2><span class="header-section-number">12.5</span> ORs and Probs<a href="logistic-regression.html#ors-and-probs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The odds ratio for a binary predictor is given by:</p>
<p><span class="math display">\[ OR = \frac{p_1(1-p_2)}{(1-p_1)p2}\]</span></p>
<p>where <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span> are probabilities of females and males respectively.</p>
<p>Here we use the observed probability predictions for females and males (see <em>Probabilities of segment membership</em> above) to calculate the OR given the formula:</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="logistic-regression.html#cb242-1" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.27</span></span>
<span id="cb242-2"><a href="logistic-regression.html#cb242-2" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fl">0.38</span></span>
<span id="cb242-3"><a href="logistic-regression.html#cb242-3" tabindex="-1"></a>OR <span class="ot">&lt;-</span>(p1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p2))<span class="sc">/</span>((<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">*</span>p2) <span class="co"># put in the ratio-calculation here</span></span>
<span id="cb242-4"><a href="logistic-regression.html#cb242-4" tabindex="-1"></a>OR</span></code></pre></div>
<p>Which is exactly the same as the output from the exponential of the coefficient in the model.</p>
</div>
<div id="effect-of-age" class="section level2 hasAnchor" number="12.6">
<h2><span class="header-section-number">12.6</span> Effect of Age<a href="logistic-regression.html#effect-of-age" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Logistic regression can, as normal regression, also be used with continous predictors, such as Age.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="logistic-regression.html#cb243-1" tabindex="-1"></a><span class="fu">head</span>(pork[, <span class="fu">c</span>(<span class="st">&quot;Age&quot;</span>, <span class="st">&quot;cluster1&quot;</span>)])</span></code></pre></div>
<pre><code>##   Age cluster1
## 1  56        0
## 2  28        0
## 3  63        0
## 4  52        1
## 5  64        1
## 6  53        0</code></pre>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="logistic-regression.html#cb245-1" tabindex="-1"></a>logreg.<span class="fl">1.</span>age <span class="ot">&lt;-</span> <span class="fu">glm</span>(cluster1 <span class="sc">~</span> Age, <span class="at">data =</span> pork, <span class="at">family =</span> binomial)</span>
<span id="cb245-2"><a href="logistic-regression.html#cb245-2" tabindex="-1"></a></span>
<span id="cb245-3"><a href="logistic-regression.html#cb245-3" tabindex="-1"></a><span class="co"># as log(OR)</span></span>
<span id="cb245-4"><a href="logistic-regression.html#cb245-4" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(logreg.<span class="fl">1.</span>age))</span></code></pre></div>
<pre><code>##                 Estimate  Std. Error    z value     Pr(&gt;|z|)
## (Intercept) -0.843015043 0.191718815 -4.3971430 1.096851e-05
## Age          0.002828027 0.004135367  0.6838636 4.940613e-01</code></pre>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="logistic-regression.html#cb247-1" tabindex="-1"></a><span class="co"># and as OR (only for the Age)</span></span>
<span id="cb247-2"><a href="logistic-regression.html#cb247-2" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(logreg.<span class="fl">1.</span>age))[<span class="dv">2</span>,<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 1.002832</code></pre>
<p>The coefficient indicates a very weak tendency towards, that cluster1 has older individuals (the estimate is positive), but the inference for this results is very non-significant.</p>
</div>
<div id="multivariate-analysis" class="section level2 hasAnchor" number="12.7">
<h2><span class="header-section-number">12.7</span> Multivariate analysis<a href="logistic-regression.html#multivariate-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Evaluating the effect of country while adjusting for age and gender.</p>
<div id="descriptives" class="section level3 hasAnchor" number="12.7.1">
<h3><span class="header-section-number">12.7.1</span> Descriptives<a href="logistic-regression.html#descriptives" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First we look at the crude percentages of cluster1 membership for the different countries.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="logistic-regression.html#cb249-1" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">table</span>(pork<span class="sc">$</span>COUNTRY, pork<span class="sc">$</span>cluster1)</span>
<span id="cb249-2"><a href="logistic-regression.html#cb249-2" tabindex="-1"></a><span class="fu">prop.table</span>(tb,<span class="dv">1</span>)</span></code></pre></div>
<pre><code>##    
##             0         1
##   1 0.7820823 0.2179177
##   3 0.7222222 0.2777778
##   4 0.5289673 0.4710327
##   6 0.6485149 0.3514851</code></pre>
<p>It seems as if especially country <span class="math inline">\(4\)</span> is higher in cluster 1 compared to the other.</p>
</div>
<div id="two-nested-models" class="section level3 hasAnchor" number="12.7.2">
<h3><span class="header-section-number">12.7.2</span> Two nested models<a href="logistic-regression.html#two-nested-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In order to investigate the effect of country, we make a model <strong>with country</strong>, and a model <strong>without country</strong> (But appart from that similar!). Then we compare the drop in ability to fit data using anova. This indicates whether country were an important factor.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="logistic-regression.html#cb251-1" tabindex="-1"></a>pork[[<span class="st">&quot;COUNTRY&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(pork[[<span class="st">&quot;COUNTRY&quot;</span>]])</span>
<span id="cb251-2"><a href="logistic-regression.html#cb251-2" tabindex="-1"></a></span>
<span id="cb251-3"><a href="logistic-regression.html#cb251-3" tabindex="-1"></a><span class="co"># Model with country</span></span>
<span id="cb251-4"><a href="logistic-regression.html#cb251-4" tabindex="-1"></a>logreg.<span class="fl">1.</span>cntr_1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(cluster1 <span class="sc">~</span>  COUNTRY <span class="sc">+</span> Age <span class="sc">+</span> Gender, </span>
<span id="cb251-5"><a href="logistic-regression.html#cb251-5" tabindex="-1"></a>                <span class="at">data =</span> pork, <span class="at">family =</span> binomial)</span>
<span id="cb251-6"><a href="logistic-regression.html#cb251-6" tabindex="-1"></a><span class="co"># Model without country</span></span>
<span id="cb251-7"><a href="logistic-regression.html#cb251-7" tabindex="-1"></a>logreg.<span class="fl">1.</span>cntr_0 <span class="ot">&lt;-</span> <span class="fu">glm</span>(cluster1 <span class="sc">~</span> Age <span class="sc">+</span> Gender, </span>
<span id="cb251-8"><a href="logistic-regression.html#cb251-8" tabindex="-1"></a>                <span class="at">data =</span> pork, <span class="at">family =</span> binomial)</span>
<span id="cb251-9"><a href="logistic-regression.html#cb251-9" tabindex="-1"></a></span>
<span id="cb251-10"><a href="logistic-regression.html#cb251-10" tabindex="-1"></a><span class="co"># Comparison</span></span>
<span id="cb251-11"><a href="logistic-regression.html#cb251-11" tabindex="-1"></a><span class="fu">anova</span>(logreg.<span class="fl">1.</span>cntr_1,logreg.<span class="fl">1.</span>cntr_0, <span class="at">test =</span> <span class="st">&#39;Chisq&#39;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: cluster1 ~ COUNTRY + Age + Gender
## Model 2: cluster1 ~ Age + Gender
##   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
## 1      1622     1970.0                          
## 2      1625     2037.6 -3  -67.577 1.409e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="logistic-regression.html#cb253-1" tabindex="-1"></a><span class="co">#Or in one line of code, after defining the model WITH country:</span></span>
<span id="cb253-2"><a href="logistic-regression.html#cb253-2" tabindex="-1"></a><span class="fu">drop1</span>(logreg.<span class="fl">1.</span>cntr_1, <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Single term deletions
## 
## Model:
## cluster1 ~ COUNTRY + Age + Gender
##         Df Deviance    AIC    LRT  Pr(&gt;Chi)    
## &lt;none&gt;       1970.0 1982.0                     
## COUNTRY  3   2037.6 2043.6 67.577 1.409e-14 ***
## Age      1   1970.1 1980.1  0.089    0.7657    
## Gender   1   1992.7 2002.7 22.660 1.934e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>So the effect of country is strongly significant.</p>
</div>
<div id="coefficients" class="section level3 hasAnchor" number="12.7.3">
<h3><span class="header-section-number">12.7.3</span> Coefficients<a href="logistic-regression.html#coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lets look at how similar/different the levels of education is.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="logistic-regression.html#cb255-1" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(logreg.<span class="fl">1.</span>cntr_1))</span></code></pre></div>
<pre><code>##                 Estimate  Std. Error    z value     Pr(&gt;|z|)
## (Intercept) -0.826120904 0.203377024 -4.0620169 4.865056e-05
## COUNTRY1    -0.573279550 0.101338371 -5.6570827 1.539675e-08
## COUNTRY2    -0.202964661 0.095555639 -2.1240469 3.366622e-02
## COUNTRY3     0.635372034 0.090915771  6.9885789 2.776846e-12
## Age          0.001316609 0.004418472  0.2979782 7.657198e-01
## Gender1      0.268673119 0.056871908  4.7241798 2.310460e-06</code></pre>
<p>The estimates for <em>first level</em> of country (1) is within <em>(Intercept)</em>.
The estimates for the remaining three levels are all <strong>IN CONTRAST</strong> to the intercept, and hence country 1.</p>
<p>So it seems as if country 3,4 and 6 are different from country 1, but we have no idea on whether say country 3 is different from country 6 and so forth.</p>
</div>
<div id="re-level" class="section level3 hasAnchor" number="12.7.4">
<h3><span class="header-section-number">12.7.4</span> Re-level<a href="logistic-regression.html#re-level" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In order to get other pairs of contrast we can re-level the factor country, and repeat the model</p>
<p>Here we re-level to the third level of country which is country==4.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="logistic-regression.html#cb257-1" tabindex="-1"></a>pork[[<span class="st">&#39;COUNTRY&#39;</span>]] <span class="ot">&lt;-</span> <span class="fu">relevel</span>(pork[[<span class="st">&#39;COUNTRY&#39;</span>]],<span class="dv">3</span>)</span>
<span id="cb257-2"><a href="logistic-regression.html#cb257-2" tabindex="-1"></a>logreg.<span class="fl">1.</span>cntr_1a <span class="ot">&lt;-</span> <span class="fu">glm</span>(cluster1 <span class="sc">~</span>  COUNTRY <span class="sc">+</span> Age <span class="sc">+</span> Gender, </span>
<span id="cb257-3"><a href="logistic-regression.html#cb257-3" tabindex="-1"></a>                <span class="at">data =</span> pork, <span class="at">family =</span> binomial)</span>
<span id="cb257-4"><a href="logistic-regression.html#cb257-4" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(logreg.<span class="fl">1.</span>cntr_1a))</span></code></pre></div>
<pre><code>##                 Estimate  Std. Error    z value     Pr(&gt;|z|)
## (Intercept) -0.826120904 0.203377024 -4.0620169 4.865056e-05
## COUNTRY1     0.635372034 0.090915771  6.9885789 2.776846e-12
## COUNTRY2    -0.573279550 0.101338371 -5.6570827 1.539675e-08
## COUNTRY3    -0.202964661 0.095555639 -2.1240469 3.366622e-02
## Age          0.001316609 0.004418472  0.2979782 7.657198e-01
## Gender1      0.268673119 0.056871908  4.7241798 2.310460e-06</code></pre>
<p>This can be repeated setting all levels as reference. But there is a more fair and easy solution.</p>
</div>
<div id="all-pairwise-comparisons" class="section level3 hasAnchor" number="12.7.5">
<h3><span class="header-section-number">12.7.5</span> All pairwise comparisons<a href="logistic-regression.html#all-pairwise-comparisons" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We want to compare all pairs of the <span class="math inline">\(4\)</span> country levels. This is a multiple comparison task, and can be undertaken by the <strong>glht()</strong> function from the <strong>multcomp</strong> package.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="logistic-regression.html#cb259-1" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb259-2"><a href="logistic-regression.html#cb259-2" tabindex="-1"></a></span>
<span id="cb259-3"><a href="logistic-regression.html#cb259-3" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(logreg.<span class="fl">1.</span>cntr_1, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">COUNTRY =</span> <span class="st">&quot;Tukey&quot;</span>)))</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: glm(formula = cluster1 ~ COUNTRY + Age + Gender, family = binomial, 
##     data = pork)
## 
## Linear Hypotheses:
##            Estimate Std. Error z value Pr(&gt;|z|)    
## 3 - 1 == 0   0.3703     0.1634   2.266  0.10584    
## 4 - 1 == 0   1.2087     0.1582   7.641  &lt; 0.001 ***
## 6 - 1 == 0   0.7142     0.1599   4.467  &lt; 0.001 ***
## 4 - 3 == 0   0.8383     0.1508   5.559  &lt; 0.001 ***
## 6 - 3 == 0   0.3438     0.1526   2.254  0.10885    
## 6 - 4 == 0  -0.4945     0.1466  -3.372  0.00396 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="logistic-regression.html#cb261-1" tabindex="-1"></a><span class="fu">cld</span>(<span class="fu">glht</span>(logreg.<span class="fl">1.</span>cntr_1, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">COUNTRY =</span> <span class="st">&quot;Tukey&quot;</span>)))</span></code></pre></div>
<pre><code>##    1    3    4    6 
##  &quot;a&quot; &quot;ab&quot;  &quot;c&quot;  &quot;b&quot;</code></pre>
<p>Here we get all <span class="math inline">\(6\)</span> pairs of pairwise comparisons. And it appears as country 1 and 3 are not statistically different, as well as country 3 and 6 (<span class="math inline">\(p&gt;0.1\)</span>). However, country 1 and 6.</p>
<p>Does this compare with the percentages from the descriptive analysis?</p>
</div>
</div>
<div id="segment-2-and-3" class="section level2 hasAnchor" number="12.8">
<h2><span class="header-section-number">12.8</span> Segment 2 and 3<a href="logistic-regression.html#segment-2-and-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Use the code above to conduct the same analysis for segment/cluster 2 and 3, and reveal</p>
<ul>
<li>Gender differences</li>
<li>Age effect</li>
<li>Country differences</li>
</ul>
</div>
<div id="a-new-set-of-data" class="section level2 hasAnchor" number="12.9">
<h2><span class="header-section-number">12.9</span> A new set of data<a href="logistic-regression.html#a-new-set-of-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The data <strong>plantbaseddiet</strong>, found in the <strong>data4consumerscience</strong>-package constitute data from the following study:</p>
<p><em>Reipurth, Malou FS, Lasse HÃ¸rby, Charlotte G. Gregersen, Astrid Bonke, and Federico JA Perez Cueto. âBarriers and facilitators towards adopting a more plant-based diet in a sample of Danish consumers.â Food quality and preference 73 (2019): 288-292.</em></p>
<p>Here we use the clusters from the consumer segmentation analysis as provided in <a href="consumer-segmentation.html#segmentation---another-example">Segmentation - another example</a></p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="logistic-regression.html#cb263-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span><span class="fu">ls</span>())</span>
<span id="cb263-2"><a href="logistic-regression.html#cb263-2" tabindex="-1"></a><span class="fu">library</span>(data4consumerscience)</span>
<span id="cb263-3"><a href="logistic-regression.html#cb263-3" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;plantbaseddiet&quot;</span>)</span>
<span id="cb263-4"><a href="logistic-regression.html#cb263-4" tabindex="-1"></a></span>
<span id="cb263-5"><a href="logistic-regression.html#cb263-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb263-6"><a href="logistic-regression.html#cb263-6" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(plantbaseddiet[,<span class="fu">c</span>(<span class="st">&#39;a_meat&#39;</span>, <span class="st">&#39;a_dairy&#39;</span>,<span class="st">&#39;a_eggs&#39;</span>)], <span class="dv">4</span>)</span>
<span id="cb263-7"><a href="logistic-regression.html#cb263-7" tabindex="-1"></a>res<span class="sc">$</span>centers</span></code></pre></div>
<pre><code>##      a_meat   a_dairy   a_eggs
## 1 18.812500  5.729167 4.492188
## 2  3.719886  5.167045 2.915909
## 3  4.688508 18.854839 3.601815
## 4 19.150000 21.850000 7.678571</code></pre>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="logistic-regression.html#cb265-1" tabindex="-1"></a>plantbaseddiet<span class="sc">$</span>clusters <span class="ot">&lt;-</span> <span class="fu">factor</span>(res<span class="sc">$</span>cluster,<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;High Meat&#39;</span>,<span class="st">&#39;Low all&#39;</span>,<span class="st">&#39;High Dairy&#39;</span>,<span class="st">&#39;High All&#39;</span>))</span>
<span id="cb265-2"><a href="logistic-regression.html#cb265-2" tabindex="-1"></a></span>
<span id="cb265-3"><a href="logistic-regression.html#cb265-3" tabindex="-1"></a><span class="co"># add as binary columns</span></span>
<span id="cb265-4"><a href="logistic-regression.html#cb265-4" tabindex="-1"></a>plantbaseddiet<span class="sc">$</span>cluster_highmeat <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(plantbaseddiet<span class="sc">$</span>clusters<span class="sc">==</span><span class="st">&#39;High Meat&#39;</span>)</span>
<span id="cb265-5"><a href="logistic-regression.html#cb265-5" tabindex="-1"></a>plantbaseddiet<span class="sc">$</span>cluster_lowall <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(plantbaseddiet<span class="sc">$</span>clusters<span class="sc">==</span><span class="st">&#39;Low all&#39;</span>)</span>
<span id="cb265-6"><a href="logistic-regression.html#cb265-6" tabindex="-1"></a>plantbaseddiet<span class="sc">$</span>cluster_highdairy <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(plantbaseddiet<span class="sc">$</span>clusters<span class="sc">==</span><span class="st">&#39;High Dairy&#39;</span>)</span>
<span id="cb265-7"><a href="logistic-regression.html#cb265-7" tabindex="-1"></a>plantbaseddiet<span class="sc">$</span>cluster_highall <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(plantbaseddiet<span class="sc">$</span>clusters<span class="sc">==</span><span class="st">&#39;High All&#39;</span>)</span></code></pre></div>
</div>
<div id="logistic-regression-for-demographic-characterization" class="section level2 hasAnchor" number="12.10">
<h2><span class="header-section-number">12.10</span> Logistic regression for demographic characterization<a href="logistic-regression.html#logistic-regression-for-demographic-characterization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="age" class="section level3 hasAnchor" number="12.10.1">
<h3><span class="header-section-number">12.10.1</span> Age<a href="logistic-regression.html#age" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="logistic-regression.html#cb266-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb266-2"><a href="logistic-regression.html#cb266-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plantbaseddiet, <span class="fu">aes</span>(clusters,age)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-148-1.png" width="672" /></p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="logistic-regression.html#cb267-1" tabindex="-1"></a>mdl_age <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data =</span> plantbaseddiet, clusters<span class="sc">==</span><span class="st">&#39;High Meat&#39;</span> <span class="sc">~</span> age)</span>
<span id="cb267-2"><a href="logistic-regression.html#cb267-2" tabindex="-1"></a></span>
<span id="cb267-3"><a href="logistic-regression.html#cb267-3" tabindex="-1"></a><span class="co"># This is essentially the same as: </span></span>
<span id="cb267-4"><a href="logistic-regression.html#cb267-4" tabindex="-1"></a><span class="co"># res &lt;- glm(data = plantbaseddiet, cluster_highmeat ~ age)</span></span>
<span id="cb267-5"><a href="logistic-regression.html#cb267-5" tabindex="-1"></a></span>
<span id="cb267-6"><a href="logistic-regression.html#cb267-6" tabindex="-1"></a><span class="fu">summary</span>(mdl_age)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = clusters == &quot;High Meat&quot; ~ age, data = plantbaseddiet)
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)  0.137638   0.042711   3.223  0.00136 **
## age         -0.000978   0.001167  -0.838  0.40260   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for gaussian family taken to be 0.09336404)
## 
##     Null deviance: 43.013  on 461  degrees of freedom
## Residual deviance: 42.947  on 460  degrees of freedom
## AIC: 219.58
## 
## Number of Fisher Scoring iterations: 2</code></pre>
</div>
<div id="gender" class="section level3 hasAnchor" number="12.10.2">
<h3><span class="header-section-number">12.10.2</span> Gender<a href="logistic-regression.html#gender" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="logistic-regression.html#cb269-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plantbaseddiet, <span class="fu">aes</span>(clusters,<span class="at">fill =</span> gender)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-149-1.png" width="672" /></p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="logistic-regression.html#cb270-1" tabindex="-1"></a>tb2 <span class="ot">&lt;-</span> <span class="fu">table</span>(plantbaseddiet<span class="sc">$</span>clusters,plantbaseddiet<span class="sc">$</span>gender)</span>
<span id="cb270-2"><a href="logistic-regression.html#cb270-2" tabindex="-1"></a>tb2</span></code></pre></div>
<pre><code>##             
##              Female Male
##   High Meat      29   19
##   Low all       168   52
##   High Dairy     99   25
##   High All       44   26</code></pre>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="logistic-regression.html#cb272-1" tabindex="-1"></a><span class="fu">prop.table</span>(tb2,<span class="at">margin =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##             
##                 Female      Male
##   High Meat  0.6041667 0.3958333
##   Low all    0.7636364 0.2363636
##   High Dairy 0.7983871 0.2016129
##   High All   0.6285714 0.3714286</code></pre>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="logistic-regression.html#cb274-1" tabindex="-1"></a>mdl_gender <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data =</span> plantbaseddiet, clusters<span class="sc">==</span><span class="st">&#39;High Meat&#39;</span> <span class="sc">~</span> gender)</span>
<span id="cb274-2"><a href="logistic-regression.html#cb274-2" tabindex="-1"></a></span>
<span id="cb274-3"><a href="logistic-regression.html#cb274-3" tabindex="-1"></a><span class="fu">summary</span>(mdl_gender)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = clusters == &quot;High Meat&quot; ~ gender, data = plantbaseddiet)
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.12052    0.01605   7.508 3.15e-13 ***
## gender1     -0.03522    0.01605  -2.194   0.0287 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for gaussian family taken to be 0.09253794)
## 
##     Null deviance: 43.013  on 461  degrees of freedom
## Residual deviance: 42.567  on 460  degrees of freedom
## AIC: 215.47
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="logistic-regression.html#cb276-1" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(mdl_gender))[<span class="dv">2</span>, <span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 0.9653913</code></pre>
</div>
</div>
<div id="task" class="section level2 hasAnchor" number="12.11">
<h2><span class="header-section-number">12.11</span> TASK<a href="logistic-regression.html#task" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Try to exchange which cluster you are looking at to see relation to age and gender</li>
<li>Try to look at some other characteristics in the dataset.</li>
<li>Can you compare clusters against the variables <em>a_meat</em>, <em>a_dairy</em> or <em>a_eggs</em> using logistic regression? Why should you be cautios with interpreting these results?</li>
</ul>
</div>
<div id="the-tidyverse-way-1" class="section level2 hasAnchor" number="12.12">
<h2><span class="header-section-number">12.12</span> The tidyverse way<a href="logistic-regression.html#the-tidyverse-way-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We want to produce the results from the Table 4 in the paper.</p>
<p>In principle, this table is <span class="math inline">\(11\)</span> survey likert scale answers against <span class="math inline">\(4\)</span> clustersâ¦ I.e. <span class="math inline">\(44\)</span> logistic regression models. If you do this in the traditional way it takes up tons of code, and even small changes will be time-consuming to implement.</p>
<p>For instance, the first element of Table 4 is calculated as:</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="logistic-regression.html#cb278-1" tabindex="-1"></a>mdl <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data =</span> plantbaseddiet, clusters<span class="sc">==</span><span class="st">&#39;High Dairy&#39;</span> <span class="sc">~</span> o_prepar <span class="sc">+</span> age <span class="sc">+</span> gender <span class="sc">+</span> <span class="fu">factor</span>(education), </span>
<span id="cb278-2"><a href="logistic-regression.html#cb278-2" tabindex="-1"></a>           <span class="at">family =</span> binomial) </span>
<span id="cb278-3"><a href="logistic-regression.html#cb278-3" tabindex="-1"></a></span>
<span id="cb278-4"><a href="logistic-regression.html#cb278-4" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(mdl)))</span></code></pre></div>
<pre><code>##                     Estimate Std. Error    z value Pr(&gt;|z|)
## (Intercept)        0.1233580   1.606315 0.01208922 1.000010
## o_prepar           1.0350811   1.112082 1.38342790 2.107518
## age                1.0194420   1.008492 9.74805146 1.023044
## gender1            1.2520173   1.137510 5.72266605 1.084461
## factor(education)1 0.5138224   1.803580 0.32334359 1.295480
## factor(education)2 1.0871876   1.300013 1.37521044 2.117052
## factor(education)3 1.3334406   1.274791 3.27156968 1.266061</code></pre>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="logistic-regression.html#cb280-1" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">confint</span>(mdl))</span></code></pre></div>
<pre><code>##                         2.5 %   97.5 %
## (Intercept)        0.04731725 0.305777
## o_prepar           0.83959291 1.274398
## age                1.00255942 1.036456
## gender1            0.97841139 1.624150
## factor(education)1 0.12451725 1.417995
## factor(education)2 0.66391303 1.912630
## factor(education)3 0.85310374 2.280131</code></pre>
<p>But we want all!</p>
<p>So: Tidyverse and broom for the rescue!</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="logistic-regression.html#cb282-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb282-2"><a href="logistic-regression.html#cb282-2" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb282-3"><a href="logistic-regression.html#cb282-3" tabindex="-1"></a></span>
<span id="cb282-4"><a href="logistic-regression.html#cb282-4" tabindex="-1"></a>tb <span class="ot">&lt;-</span> plantbaseddiet <span class="sc">%&gt;%</span> </span>
<span id="cb282-5"><a href="logistic-regression.html#cb282-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="co"># make a vector of 1&#39;s</span></span>
<span id="cb282-6"><a href="logistic-regression.html#cb282-6" tabindex="-1"></a>  <span class="fu">spread</span>(clusters,id, <span class="at">fill =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="co"># distribute the clustering into 4 new coloumns and make sure that the binary cluster vectors are 1 and 0. </span></span>
<span id="cb282-7"><a href="logistic-regression.html#cb282-7" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">&#39;plant_plantbaseddiet&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;answ&#39;</span>,o_prepar<span class="sc">:</span>o_family) <span class="sc">%&gt;%</span> <span class="co"># long format for survey questions</span></span>
<span id="cb282-8"><a href="logistic-regression.html#cb282-8" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">&#39;cluster_type&#39;</span>,<span class="at">values_to =</span> <span class="st">&#39;cluster&#39;</span>,<span class="st">`</span><span class="at">High Meat</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">High All</span><span class="st">`</span>) <span class="sc">%&gt;%</span> <span class="co"># long format for clusters </span></span>
<span id="cb282-9"><a href="logistic-regression.html#cb282-9" tabindex="-1"></a>  <span class="fu">group_by</span>(plant_plantbaseddiet,cluster_type) <span class="sc">%&gt;%</span> <span class="co"># loop over all questions and all clusters</span></span>
<span id="cb282-10"><a href="logistic-regression.html#cb282-10" tabindex="-1"></a>  <span class="fu">do</span>(<span class="fu">glm</span>(<span class="at">data =</span> ., cluster<span class="sc">==</span><span class="dv">1</span> <span class="sc">~</span> answ <span class="sc">+</span> <span class="fu">factor</span>(education) <span class="sc">+</span> age <span class="sc">+</span> gender, <span class="at">family =</span> binomial) <span class="sc">%&gt;%</span></span>
<span id="cb282-11"><a href="logistic-regression.html#cb282-11" tabindex="-1"></a>       <span class="fu">tidy</span>(<span class="at">exponentiate =</span> T,<span class="at">conf.int =</span> T)) <span class="co"># perform logistic regression</span></span>
<span id="cb282-12"><a href="logistic-regression.html#cb282-12" tabindex="-1"></a></span>
<span id="cb282-13"><a href="logistic-regression.html#cb282-13" tabindex="-1"></a></span>
<span id="cb282-14"><a href="logistic-regression.html#cb282-14" tabindex="-1"></a>tb <span class="sc">%&gt;%</span> <span class="fu">head</span>() </span></code></pre></div>
<pre><code>## # A tibble: 6 Ã 9
## # Groups:   plant_plantbaseddiet, cluster_type [1]
##   plant_plantbaseddiet cluster_type term    estimate std.error statistic p.value
##   &lt;chr&gt;                &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 o_easy_a             High All     (Interâ¦   0.0981    0.627    -3.70   2.14e-4
## 2 o_easy_a             High All     answ      1.20      0.133     1.39   1.64e-1
## 3 o_easy_a             High All     factorâ¦   0.911     0.586    -0.158  8.74e-1
## 4 o_easy_a             High All     factorâ¦   1.49      0.271     1.46   1.44e-1
## 5 o_easy_a             High All     factorâ¦   1.01      0.265     0.0398 9.68e-1
## 6 o_easy_a             High All     age       1.00      0.0109    0.307  7.59e-1
## # â¹ 2 more variables: conf.low &lt;dbl&gt;, conf.high &lt;dbl&gt;</code></pre>
<p>This table (tb) has all the results, with estimates being OR and with confidence intervals. However, there are <em>too much</em> information. For instance are the intercept as well as the covariates reported. We can tidy it even more:</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="logistic-regression.html#cb284-1" tabindex="-1"></a>tb4 <span class="ot">&lt;-</span> tb <span class="sc">%&gt;%</span> </span>
<span id="cb284-2"><a href="logistic-regression.html#cb284-2" tabindex="-1"></a>  ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb284-3"><a href="logistic-regression.html#cb284-3" tabindex="-1"></a>  <span class="fu">filter</span>(term<span class="sc">==</span><span class="st">&#39;answ&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb284-4"><a href="logistic-regression.html#cb284-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">OR =</span> <span class="fu">paste</span>(<span class="fu">round</span>(estimate,<span class="dv">2</span>), </span>
<span id="cb284-5"><a href="logistic-regression.html#cb284-5" tabindex="-1"></a>                    <span class="st">&#39; (&#39;</span>, <span class="fu">round</span>(conf.low,<span class="dv">2</span>),<span class="st">&#39;-&#39;</span>,</span>
<span id="cb284-6"><a href="logistic-regression.html#cb284-6" tabindex="-1"></a>                    <span class="fu">round</span>(conf.high,<span class="dv">2</span>),<span class="st">&#39;)&#39;</span>, </span>
<span id="cb284-7"><a href="logistic-regression.html#cb284-7" tabindex="-1"></a>                    <span class="at">sep =</span> <span class="st">&#39;&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb284-8"><a href="logistic-regression.html#cb284-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(plant_plantbaseddiet,cluster_type,OR) <span class="sc">%&gt;%</span> </span>
<span id="cb284-9"><a href="logistic-regression.html#cb284-9" tabindex="-1"></a>  <span class="fu">spread</span>(cluster_type,OR)</span>
<span id="cb284-10"><a href="logistic-regression.html#cb284-10" tabindex="-1"></a>tb4  </span></code></pre></div>
<pre><code>## # A tibble: 11 Ã 5
##    plant_plantbaseddiet `High All`       `High Dairy`     `High Meat`  `Low all`
##    &lt;chr&gt;                &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;        &lt;chr&gt;    
##  1 o_easy_a             1.2 (0.93-1.57)  1.07 (0.87-1.32) 1.07 (0.79-â¦ 0.83 (0.â¦
##  2 o_family             1.14 (0.91-1.42) 0.96 (0.8-1.15)  1.18 (0.9-1â¦ 0.91 (0.â¦
##  3 o_fulnes             1.48 (1.16-1.9)  0.91 (0.73-1.12) 1.66 (1.24-â¦ 0.71 (0.â¦
##  4 o_health             0.69 (0.52-0.92) 1.21 (0.95-1.56) 0.82 (0.59-â¦ 1.14 (0.â¦
##  5 o_prepar             1.28 (0.99-1.65) 1.04 (0.84-1.27) 1.32 (0.98-â¦ 0.77 (0.â¦
##  6 o_price              1.11 (0.87-1.42) 1.01 (0.83-1.24) 1.19 (0.89-â¦ 0.88 (0.â¦
##  7 o_protei             1.93 (1.48-2.55) 0.84 (0.68-1.04) 1.74 (1.29-â¦ 0.65 (0.â¦
##  8 o_restau             0.88 (0.65-1.18) 1.06 (0.84-1.34) 0.99 (0.7-1â¦ 1.02 (0.â¦
##  9 o_social             0.98 (0.75-1.28) 0.94 (0.75-1.16) 1.39 (1.01-â¦ 0.94 (0.â¦
## 10 o_sustai             0.69 (0.52-0.91) 1.15 (0.91-1.47) 0.8 (0.58-1â¦ 1.21 (0.â¦
## 11 o_taste              0.82 (0.63-1.08) 1.09 (0.87-1.39) 0.59 (0.43-â¦ 1.29 (1.â¦</code></pre>
<p>Now this just needs to be exported to excel (use e.g.Â export() from the rio package), and a bit of <strong>love</strong> to be ready for a publication.</p>
</div>
<div id="comment" class="section level2 hasAnchor" number="12.13">
<h2><span class="header-section-number">12.13</span> Comment<a href="logistic-regression.html#comment" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Try to understand each of the commands in the pipeline, what they do and why they make sense.</p>
<p>You can put in a hash-tag (#) before the the pipe sign (%&gt;%) to block the pipeline and see the structure of the output at this point.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="profiling-segments.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cata-data-check-all-that-apply.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mortenarendt/dataanalyssisconsumerscience/edit/master/12_LogisticRegression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/mortenarendt/dataanalyssisconsumerscience/blob/master/12_LogisticRegression.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
