<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Inferential statistics | Data Analysis in R for Sensory and Consumer Science</title>
  <meta name="description" content="Chapter 5 Inferential statistics | Data Analysis in R for Sensory and Consumer Science" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Inferential statistics | Data Analysis in R for Sensory and Consumer Science" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Inferential statistics | Data Analysis in R for Sensory and Consumer Science" />
  
  
  

<meta name="author" content="Morten Arendt Rasmussen, Julius Jessen Terp, Helene C. Reinbach and Bodil H. Allesen-Holm" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="descriptive-statistics.html"/>
<link rel="next" href="plotting-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Analysis in R for Consumer Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction to the book</a></li>
<li class="chapter" data-level="2" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>2</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#how-to-get-started---understanding-r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> How to get started - understanding R (and RStudio)</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#organise-and-save-scripts"><i class="fa fa-check"></i><b>2.1.1</b> Organise and save scripts</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#how-to-import-data"><i class="fa fa-check"></i><b>2.2</b> How to import data</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#import-data-from-r-package"><i class="fa fa-check"></i><b>2.2.1</b> Import data from R-package</a></li>
<li class="chapter" data-level="2.2.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#importing-a-csv-file"><i class="fa fa-check"></i><b>2.2.2</b> Importing a csv file</a></li>
<li class="chapter" data-level="2.2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#importing-an-excel-filesheet"><i class="fa fa-check"></i><b>2.2.3</b> Importing an Excel file/sheet</a></li>
<li class="chapter" data-level="2.2.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#clipboard-import"><i class="fa fa-check"></i><b>2.2.4</b> Clipboard import</a></li>
<li class="chapter" data-level="2.2.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#looking-at-the-imported-elements"><i class="fa fa-check"></i><b>2.2.5</b> Looking at the imported elements</a></li>
<li class="chapter" data-level="2.2.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#numbers-and-factors---changing-categorisation"><i class="fa fa-check"></i><b>2.2.6</b> Numbers and factors - changing categorisation</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#how-to-edit-and-merge-datasets"><i class="fa fa-check"></i><b>2.3</b> How to edit and merge datasets</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#how-to-save-the-data"><i class="fa fa-check"></i><b>2.4</b> How to save the data</a></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#how-to-export-data-results"><i class="fa fa-check"></i><b>2.5</b> How to export data / results</a></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r.html"><a href="introduction-to-r.html#how-to-load-your-rdata"><i class="fa fa-check"></i><b>2.6</b> How to load your RData</a></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-r.html"><a href="introduction-to-r.html#how-to-clear-your-environment"><i class="fa fa-check"></i><b>2.7</b> How to clear your environment</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="libraries.html"><a href="libraries.html"><i class="fa fa-check"></i><b>3</b> Libraries</a></li>
<li class="chapter" data-level="4" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html"><i class="fa fa-check"></i><b>4</b> Descriptive statistics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#descriptives-for-a-continuous-variable"><i class="fa fa-check"></i><b>4.1</b> Descriptives for a continuous variable</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#mean-median"><i class="fa fa-check"></i><b>4.1.1</b> Mean / median</a></li>
<li class="chapter" data-level="4.1.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#variance"><i class="fa fa-check"></i><b>4.1.2</b> Variance</a></li>
<li class="chapter" data-level="4.1.3" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#standard-deviation"><i class="fa fa-check"></i><b>4.1.3</b> Standard deviation</a></li>
<li class="chapter" data-level="4.1.4" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#calculations"><i class="fa fa-check"></i><b>4.1.4</b> Calculations</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#distributions-of-count-data"><i class="fa fa-check"></i><b>4.2</b> Distributions of count data</a></li>
<li class="chapter" data-level="4.3" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#aggregate"><i class="fa fa-check"></i><b>4.3</b> Aggregate</a></li>
<li class="chapter" data-level="4.4" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#tidyverse"><i class="fa fa-check"></i><b>4.4</b> Tidyverse</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="inferential-statistics.html"><a href="inferential-statistics.html"><i class="fa fa-check"></i><b>5</b> Inferential statistics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="inferential-statistics.html"><a href="inferential-statistics.html#intro"><i class="fa fa-check"></i><b>5.1</b> Intro</a></li>
<li class="chapter" data-level="5.2" data-path="inferential-statistics.html"><a href="inferential-statistics.html#hypothesis-testing"><i class="fa fa-check"></i><b>5.2</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="inferential-statistics.html"><a href="inferential-statistics.html#power"><i class="fa fa-check"></i><b>5.2.1</b> Power</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="inferential-statistics.html"><a href="inferential-statistics.html#confidence-intervals"><i class="fa fa-check"></i><b>5.3</b> Confidence intervals</a></li>
<li class="chapter" data-level="5.4" data-path="inferential-statistics.html"><a href="inferential-statistics.html#t-test"><i class="fa fa-check"></i><b>5.4</b> T-test</a></li>
<li class="chapter" data-level="5.5" data-path="inferential-statistics.html"><a href="inferential-statistics.html#f-test"><i class="fa fa-check"></i><b>5.5</b> F-test</a></li>
<li class="chapter" data-level="5.6" data-path="inferential-statistics.html"><a href="inferential-statistics.html#analysis-of-variance-anova"><i class="fa fa-check"></i><b>5.6</b> Analysis of Variance (ANOVA)</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="inferential-statistics.html"><a href="inferential-statistics.html#one-way-anova"><i class="fa fa-check"></i><b>5.6.1</b> One-way ANOVA</a></li>
<li class="chapter" data-level="5.6.2" data-path="inferential-statistics.html"><a href="inferential-statistics.html#two-way-anova"><i class="fa fa-check"></i><b>5.6.2</b> Two-way ANOVA</a></li>
<li class="chapter" data-level="5.6.3" data-path="inferential-statistics.html"><a href="inferential-statistics.html#post-hoc-test---tukeys-honest-significant-difference"><i class="fa fa-check"></i><b>5.6.3</b> Post hoc test - Tukey’s Honest Significant Difference</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="inferential-statistics.html"><a href="inferential-statistics.html#introduction-to-linear-and-mixed-models"><i class="fa fa-check"></i><b>5.7</b> Introduction to linear and mixed models</a></li>
<li class="chapter" data-level="5.8" data-path="inferential-statistics.html"><a href="inferential-statistics.html#normal-and-mixed-models"><i class="fa fa-check"></i><b>5.8</b> Normal and Mixed models</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="inferential-statistics.html"><a href="inferential-statistics.html#normal-model"><i class="fa fa-check"></i><b>5.8.1</b> Normal model</a></li>
<li class="chapter" data-level="5.8.2" data-path="inferential-statistics.html"><a href="inferential-statistics.html#mixed-model"><i class="fa fa-check"></i><b>5.8.2</b> Mixed model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="plotting-data.html"><a href="plotting-data.html"><i class="fa fa-check"></i><b>6</b> Plotting data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="plotting-data.html"><a href="plotting-data.html#histograms-and-boxplots"><i class="fa fa-check"></i><b>6.1</b> Histograms and boxplots</a></li>
<li class="chapter" data-level="6.2" data-path="plotting-data.html"><a href="plotting-data.html#scatter-plots"><i class="fa fa-check"></i><b>6.2</b> Scatter plots</a></li>
<li class="chapter" data-level="6.3" data-path="plotting-data.html"><a href="plotting-data.html#how-to-export-plots"><i class="fa fa-check"></i><b>6.3</b> How to export plots</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="introduction-to-pca-and-multivariate-data.html"><a href="introduction-to-pca-and-multivariate-data.html"><i class="fa fa-check"></i><b>7</b> Introduction to PCA and multivariate data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="introduction-to-pca-and-multivariate-data.html"><a href="introduction-to-pca-and-multivariate-data.html#a-bit-of-math"><i class="fa fa-check"></i><b>7.1</b> A bit of math</a></li>
<li class="chapter" data-level="7.2" data-path="introduction-to-pca-and-multivariate-data.html"><a href="introduction-to-pca-and-multivariate-data.html#interpreting-model-output"><i class="fa fa-check"></i><b>7.2</b> Interpreting model output</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="introduction-to-pca-and-multivariate-data.html"><a href="introduction-to-pca-and-multivariate-data.html#biplot"><i class="fa fa-check"></i><b>7.2.1</b> Biplot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html"><i class="fa fa-check"></i><b>8</b> Buffet and survey data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html#buffet-data"><i class="fa fa-check"></i><b>8.1</b> Buffet data</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html#introduction-to-buffet-data"><i class="fa fa-check"></i><b>8.1.1</b> Introduction to buffet data</a></li>
<li class="chapter" data-level="8.1.2" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html#plotting-buffet-data"><i class="fa fa-check"></i><b>8.1.2</b> Plotting buffet data</a></li>
<li class="chapter" data-level="8.1.3" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html#mixed-model-for-buffet-data"><i class="fa fa-check"></i><b>8.1.3</b> Mixed model for buffet data</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html#survey-data"><i class="fa fa-check"></i><b>8.2</b> Survey data</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html#plotting-survey-data"><i class="fa fa-check"></i><b>8.2.1</b> Plotting survey data</a></li>
<li class="chapter" data-level="8.2.2" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html#linear-model-for-buffet-data"><i class="fa fa-check"></i><b>8.2.2</b> Linear model for buffet data</a></li>
<li class="chapter" data-level="8.2.3" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html#post-hoc-test-for-survey-data"><i class="fa fa-check"></i><b>8.2.3</b> Post-hoc test for survey data</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="buffet-and-survey-data.html"><a href="buffet-and-survey-data.html#combining-consumption-and-survey-data"><i class="fa fa-check"></i><b>8.3</b> Combining consumption and survey data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mst-exercises.html"><a href="mst-exercises.html"><i class="fa fa-check"></i><b>9</b> MST exercises</a>
<ul>
<li class="chapter" data-level="9.1" data-path="mst-exercises.html"><a href="mst-exercises.html#exercise-1"><i class="fa fa-check"></i><b>9.1</b> Exercise 1</a></li>
<li class="chapter" data-level="9.2" data-path="mst-exercises.html"><a href="mst-exercises.html#exercise-2"><i class="fa fa-check"></i><b>9.2</b> Exercise 2</a></li>
<li class="chapter" data-level="9.3" data-path="mst-exercises.html"><a href="mst-exercises.html#exercise-3"><i class="fa fa-check"></i><b>9.3</b> Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="cata-data-check-all-that-apply.html"><a href="cata-data-check-all-that-apply.html"><i class="fa fa-check"></i><b>10</b> CATA data (Check-All-That-Apply)</a>
<ul>
<li class="chapter" data-level="10.1" data-path="cata-data-check-all-that-apply.html"><a href="cata-data-check-all-that-apply.html#importing-and-looking-at-the-beer-data"><i class="fa fa-check"></i><b>10.1</b> Importing and looking at the beer data</a></li>
<li class="chapter" data-level="10.2" data-path="cata-data-check-all-that-apply.html"><a href="cata-data-check-all-that-apply.html#two-versions-of-the-data"><i class="fa fa-check"></i><b>10.2</b> Two versions of the data</a></li>
<li class="chapter" data-level="10.3" data-path="cata-data-check-all-that-apply.html"><a href="cata-data-check-all-that-apply.html#cochrans-q-test"><i class="fa fa-check"></i><b>10.3</b> Cochran’s Q test</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="cata-data-check-all-that-apply.html"><a href="cata-data-check-all-that-apply.html#post-hoc-test"><i class="fa fa-check"></i><b>10.3.1</b> Post hoc test</a></li>
<li class="chapter" data-level="10.3.2" data-path="cata-data-check-all-that-apply.html"><a href="cata-data-check-all-that-apply.html#for-all-attributes-in-one-run-nice-to-know"><i class="fa fa-check"></i><b>10.3.2</b> For all attributes in one run (nice to know)</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="cata-data-check-all-that-apply.html"><a href="cata-data-check-all-that-apply.html#pca-on-cata-data"><i class="fa fa-check"></i><b>10.4</b> PCA on CATA data</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="hedonic-rating-e.g.-liking-scores.html"><a href="hedonic-rating-e.g.-liking-scores.html"><i class="fa fa-check"></i><b>11</b> Hedonic rating (e.g. liking scores)</a>
<ul>
<li class="chapter" data-level="11.1" data-path="hedonic-rating-e.g.-liking-scores.html"><a href="hedonic-rating-e.g.-liking-scores.html#plotting-liking-scores"><i class="fa fa-check"></i><b>11.1</b> Plotting liking scores</a></li>
<li class="chapter" data-level="11.2" data-path="hedonic-rating-e.g.-liking-scores.html"><a href="hedonic-rating-e.g.-liking-scores.html#simple-mixed-models"><i class="fa fa-check"></i><b>11.2</b> Simple mixed models</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="hedonic-rating-e.g.-liking-scores.html"><a href="hedonic-rating-e.g.-liking-scores.html#post-hoc-test-1"><i class="fa fa-check"></i><b>11.2.1</b> Post hoc test</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="hedonic-rating-e.g.-liking-scores.html"><a href="hedonic-rating-e.g.-liking-scores.html#multivariable-models"><i class="fa fa-check"></i><b>11.3</b> Multivariable models</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="hedonic-rating-e.g.-liking-scores.html"><a href="hedonic-rating-e.g.-liking-scores.html#additive-models"><i class="fa fa-check"></i><b>11.3.1</b> Additive models</a></li>
<li class="chapter" data-level="11.3.2" data-path="hedonic-rating-e.g.-liking-scores.html"><a href="hedonic-rating-e.g.-liking-scores.html#effect-modification-and-interactions"><i class="fa fa-check"></i><b>11.3.2</b> Effect modification and Interactions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="cata-and-hedonics.html"><a href="cata-and-hedonics.html"><i class="fa fa-check"></i><b>12</b> CATA and Hedonics</a>
<ul>
<li class="chapter" data-level="12.1" data-path="cata-and-hedonics.html"><a href="cata-and-hedonics.html#individual-attributes-and-liking"><i class="fa fa-check"></i><b>12.1</b> Individual attributes and liking</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="cata-and-hedonics.html"><a href="cata-and-hedonics.html#an-example-with-refreshing"><i class="fa fa-check"></i><b>12.1.1</b> An example with Refreshing</a></li>
<li class="chapter" data-level="12.1.2" data-path="cata-and-hedonics.html"><a href="cata-and-hedonics.html#all-attributes"><i class="fa fa-check"></i><b>12.1.2</b> All attributes</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="cata-and-hedonics.html"><a href="cata-and-hedonics.html#pca-on-cata-and-liking"><i class="fa fa-check"></i><b>12.2</b> PCA on CATA and Liking</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="cata-and-hedonics.html"><a href="cata-and-hedonics.html#a-beer-centric-model"><i class="fa fa-check"></i><b>12.2.1</b> A beer centric model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="preference-mapping.html"><a href="preference-mapping.html"><i class="fa fa-check"></i><b>13</b> Preference Mapping</a>
<ul>
<li class="chapter" data-level="13.1" data-path="preference-mapping.html"><a href="preference-mapping.html#example-of-preference-mapping"><i class="fa fa-check"></i><b>13.1</b> Example of Preference Mapping</a></li>
<li class="chapter" data-level="13.2" data-path="preference-mapping.html"><a href="preference-mapping.html#pca"><i class="fa fa-check"></i><b>13.2</b> PCA</a></li>
<li class="chapter" data-level="13.3" data-path="preference-mapping.html"><a href="preference-mapping.html#analysis-by-pls"><i class="fa fa-check"></i><b>13.3</b> Analysis by PLS</a></li>
<li class="chapter" data-level="13.4" data-path="preference-mapping.html"><a href="preference-mapping.html#l-pls-for-the-future"><i class="fa fa-check"></i><b>13.4</b> L-PLS [For the future…]</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="projective-mapping.html"><a href="projective-mapping.html"><i class="fa fa-check"></i><b>14</b> Projective mapping</a>
<ul>
<li class="chapter" data-level="14.1" data-path="projective-mapping.html"><a href="projective-mapping.html#example-from-mapping-of-xx"><i class="fa fa-check"></i><b>14.1</b> Example from mapping of XX</a></li>
<li class="chapter" data-level="14.2" data-path="projective-mapping.html"><a href="projective-mapping.html#a-collated-version-of-the-data"><i class="fa fa-check"></i><b>14.2</b> A Collated version of the data</a></li>
<li class="chapter" data-level="14.3" data-path="projective-mapping.html"><a href="projective-mapping.html#pca-on-collated-data"><i class="fa fa-check"></i><b>14.3</b> PCA on Collated data</a></li>
<li class="chapter" data-level="14.4" data-path="projective-mapping.html"><a href="projective-mapping.html#section"><i class="fa fa-check"></i><b>14.4</b> </a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="tfih-exercises.html"><a href="tfih-exercises.html"><i class="fa fa-check"></i><b>15</b> TFIH Exercises</a>
<ul>
<li class="chapter" data-level="15.1" data-path="tfih-exercises.html"><a href="tfih-exercises.html#exercise-1-descriptive-statistics-and-plots"><i class="fa fa-check"></i><b>15.1</b> Exercise 1: Descriptive statistics and plots</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="tfih-exercises.html"><a href="tfih-exercises.html#cata-counts"><i class="fa fa-check"></i><b>15.1.1</b> CATA counts</a></li>
<li class="chapter" data-level="15.1.2" data-path="tfih-exercises.html"><a href="tfih-exercises.html#hedonics"><i class="fa fa-check"></i><b>15.1.2</b> Hedonics</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="tfih-exercises.html"><a href="tfih-exercises.html#exercise-2-consumer-background-and-pca"><i class="fa fa-check"></i><b>15.2</b> Exercise 2: Consumer background and PCA</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="tfih-exercises.html"><a href="tfih-exercises.html#demographics"><i class="fa fa-check"></i><b>15.2.1</b> Demographics</a></li>
<li class="chapter" data-level="15.2.2" data-path="tfih-exercises.html"><a href="tfih-exercises.html#pca-on-interests"><i class="fa fa-check"></i><b>15.2.2</b> PCA on <em>Interests</em></a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="tfih-exercises.html"><a href="tfih-exercises.html#exercise-3-pca-on-cata-counts"><i class="fa fa-check"></i><b>15.3</b> Exercise 3: PCA on CATA counts</a></li>
<li class="chapter" data-level="15.4" data-path="tfih-exercises.html"><a href="tfih-exercises.html#exercise-4-cochrans-q-test-on-cata-binary-data"><i class="fa fa-check"></i><b>15.4</b> Exercise 4: Cochran’s Q test on CATA binary data</a></li>
<li class="chapter" data-level="15.5" data-path="tfih-exercises.html"><a href="tfih-exercises.html#exercise-5-hedonic-ratings-and-consumer-characteristics"><i class="fa fa-check"></i><b>15.5</b> Exercise 5: Hedonic ratings and consumer characteristics</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="tfih-exercises.html"><a href="tfih-exercises.html#pca-on-joint-data"><i class="fa fa-check"></i><b>15.5.1</b> PCA on joint data</a></li>
<li class="chapter" data-level="15.5.2" data-path="tfih-exercises.html"><a href="tfih-exercises.html#all-demographics"><i class="fa fa-check"></i><b>15.5.2</b> All demographics</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="tfih-exercises.html"><a href="tfih-exercises.html#exercise-6-pca-on-cata-counts-and-hedonic-ratings"><i class="fa fa-check"></i><b>15.6</b> Exercise 6: PCA on CATA counts and hedonic ratings</a></li>
<li class="chapter" data-level="15.7" data-path="tfih-exercises.html"><a href="tfih-exercises.html#exercise-7-mixed-modelling-on-hedonic-ratings"><i class="fa fa-check"></i><b>15.7</b> Exercise 7: Mixed modelling on hedonic ratings</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="latent-factor-models.html"><a href="latent-factor-models.html"><i class="fa fa-check"></i><b>16</b> Latent Factor Models</a></li>
<li class="chapter" data-level="17" data-path="lpls.html"><a href="lpls.html"><i class="fa fa-check"></i><b>17</b> LPLS</a></li>
<li class="chapter" data-level="18" data-path="consumer-segmentation.html"><a href="consumer-segmentation.html"><i class="fa fa-check"></i><b>18</b> Consumer Segmentation</a>
<ul>
<li class="chapter" data-level="18.1" data-path="consumer-segmentation.html"><a href="consumer-segmentation.html#kmeans"><i class="fa fa-check"></i><b>18.1</b> Kmeans</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="more-pca.html"><a href="more-pca.html"><i class="fa fa-check"></i><b>19</b> More PCA</a></li>
<li class="chapter" data-level="20" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>20</b> Logistic Regression</a></li>
<li class="chapter" data-level="21" data-path="confirmatory-factor-analysis-using-lavaan.html"><a href="confirmatory-factor-analysis-using-lavaan.html"><i class="fa fa-check"></i><b>21</b> Confirmatory Factor Analysis using lavaan</a>
<ul>
<li class="chapter" data-level="21.1" data-path="confirmatory-factor-analysis-using-lavaan.html"><a href="confirmatory-factor-analysis-using-lavaan.html#example---food-neophobia"><i class="fa fa-check"></i><b>21.1</b> Example - Food Neophobia</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="structured-equation-modelling.html"><a href="structured-equation-modelling.html"><i class="fa fa-check"></i><b>22</b> Structured Equation Modelling</a>
<ul>
<li class="chapter" data-level="22.1" data-path="structured-equation-modelling.html"><a href="structured-equation-modelling.html#example---theory-of-planned-behaviour"><i class="fa fa-check"></i><b>22.1</b> Example - Theory of Planned Behaviour</a>
<ul>
<li class="chapter" data-level="22.1.1" data-path="structured-equation-modelling.html"><a href="structured-equation-modelling.html#plsda-cataon-cata-and-liking"><i class="fa fa-check"></i><b>22.1.1</b> PLSDA (CATA??)on CATA and liking??</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="pca-on-survey-answers.html"><a href="pca-on-survey-answers.html"><i class="fa fa-check"></i><b>23</b> PCA on survey answers</a>
<ul>
<li class="chapter" data-level="23.1" data-path="pca-on-survey-answers.html"><a href="pca-on-survey-answers.html#bi-plot"><i class="fa fa-check"></i><b>23.1</b> Bi-plot</a>
<ul>
<li class="chapter" data-level="23.1.1" data-path="pca-on-survey-answers.html"><a href="pca-on-survey-answers.html#extract-the-components-and-run-all-associations."><i class="fa fa-check"></i><b>23.1.1</b> Extract the components and run all associations.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="24" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>24</b> Linear models</a>
<ul>
<li class="chapter" data-level="24.1" data-path="linear-models.html"><a href="linear-models.html#example"><i class="fa fa-check"></i><b>24.1</b> Example</a></li>
<li class="chapter" data-level="24.2" data-path="linear-models.html"><a href="linear-models.html#run-a-bunch-of-models-at-once"><i class="fa fa-check"></i><b>24.2</b> Run a bunch of models at once</a>
<ul>
<li class="chapter" data-level="24.2.1" data-path="linear-models.html"><a href="linear-models.html#a-plot"><i class="fa fa-check"></i><b>24.2.1</b> A plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="25" data-path="mixed-models.html"><a href="mixed-models.html"><i class="fa fa-check"></i><b>25</b> Mixed models</a>
<ul>
<li class="chapter" data-level="25.1" data-path="mixed-models.html"><a href="mixed-models.html#with-several-variables"><i class="fa fa-check"></i><b>25.1</b> With several variables</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis in R for Sensory and Consumer Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="inferential-statistics" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Inferential statistics<a href="inferential-statistics.html#inferential-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="intro" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Intro<a href="inferential-statistics.html#intro" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Inferential statistics is a branch of statistics that deals with making predictions or estimates about a population based on a sample of data from that population. The goal of inferential statistics is to use the sample data to draw conclusions about the population as a whole.</p>
<p>This approach is quite neat, as it would be rather time-consuming to e.g. measure the height of every person in the whole world (the population), to be able to show the average height of a person. To avoid this, a (more or less) representative sample is used to estimate the average height of a person, while taking into account the uncertainty that arises from not measuring the whole population.</p>
<p>And while the process of obtaining a representative sample is a crucial aspect of inferential statistics, it is outside the scope of this book, and will therefore not be addressed further.</p>
<p>Inferential statistics use a variety of techniques such as hypothesis testing, confidence intervals or Analysis of Variance (ANOVA), all of which will be introduced in the following sections.</p>
</div>
<div id="hypothesis-testing" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Hypothesis testing<a href="inferential-statistics.html#hypothesis-testing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Statistical hypothesis testing starts with a hypothesis about a population parameter (such as the mean or proportion). Then data are collected, after which statistical techniques are used to decide whether the data provide sufficient evidence to support the hypothesis or not.</p>
<p>There are two types of hypotheses in hypothesis testing: the null hypothesis and the alternative hypothesis. The null hypothesis is a statement of no effect or no difference between groups. It is typically denoted as <span class="math inline">\(H_{0}\)</span>. The alternative hypothesis is a statement of the opposite of the null hypothesis. It is typically denoted as <span class="math inline">\(H_{A}\)</span> or <span class="math inline">\(H_{1}\)</span>.</p>
<p>The process of hypothesis testing typically involves the following steps:</p>
<ol style="list-style-type: decimal">
<li><p>Formulate the null and alternative hypotheses. For example: The average height of men and women is the same. <span class="math inline">\(H_{0}: \mu_{men}=\mu_{women} \\ H_{A}: \mu_{men}\neq\mu_{women}\)</span></p></li>
<li><p>Select a significance level (<span class="math inline">\(\alpha\)</span>). This is the probability of making a Type I error, which means rejecting the null hypothesis when in fact, it is true (usually, <span class="math inline">\(\alpha = 0.05\)</span> is used, but this can vary depending on the application).</p></li>
<li><p>Collect data and compute a test statistic (which test statistic will depend on the desired test - examples will be presented in the following sections).</p></li>
<li><p>Determine the p-value. The p-value is the probability of obtaining a test statistic at least as extreme as the one observed, assuming the null hypothesis is true.</p></li>
<li><p>Compare the p-value to the significance level. If the p-value is less than the significance level, we reject the null hypothesis. If the p-value is greater than the significance level, we fail to reject the null hypothesis.</p></li>
</ol>
<p>It’s important to note that hypothesis testing is not about proving the hypothesis to be true or false. Instead, it’s about deciding whether the data provide sufficient evidence to reject the null hypothesis in favor of the alternative hypothesis.</p>
<p>A measure to evaluate whether the conclusion of the hypothesis test is valid, is called power, and will be introduced in the following section.</p>
<div id="power" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Power<a href="inferential-statistics.html#power" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Statistical power is a measure of the probability that a statistical test will detect a difference between two groups or treatments if one actually exists. It can also be described as the probability to NOT commit a Type II/<span class="math inline">\(\beta\)</span>-error.</p>
<!-- Indsæt billede af to fordelinger, med alpha og beta-fejl markeret -->
<!-- Indsæt tabel med alpha og beta-fejl der viser falsk positiv og falsk negativ -->
<p>The statistical power of a hypothesis test is influenced by several factors, including the size of the sample, the magnitude of the difference between the groups or treatments being compared, and the level of significance (alpha) that is chosen for the test. A test with high statistical power is more likely to detect a difference between the groups or treatments being compared, while a test with low statistical power is less likely to detect a difference.</p>
<p>In practice, power can be hard to calculate, as one needs to know the characteristics of the distribution describing the alternative hypothesis (e.g. mean, standard deviation, etc.). These characteristics are unknown, but are sometimes estimated using previous trials dealing with similar samples to estimate the power of a trial.</p>
</div>
</div>
<div id="confidence-intervals" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Confidence intervals<a href="inferential-statistics.html#confidence-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A confidence interval is a range of values that is calculated from a sample of data, and it is used to estimate the true population parameter. It is called a confidence interval because it provides a level of confidence that the true population parameter falls within the range of values calculated from the sample.</p>
<p>The size of the confidence interval depends on the size of the sample, the level of confidence chosen, and the variability of the data. The larger the sample size and the lower the variability, the smaller the confidence interval will be. Confidence intervals are commonly used in statistical analysis to estimate the mean, standard deviation, and other parameters of a population.</p>
<p>Below is shown how to calculate the confidence interval of an estimated mean, assuming the the population follows a T-distribution. <span class="math display">\[CI_{\mu}: \hat{\mu} \pm t_{1-\alpha/2,df} \cdot \hat{\sigma}/\sqrt{n}\]</span> The t-fratcile can be found in a T-table, or using qt(1-<span class="math inline">\(\alpha\)</span>/2,df) (which usually means qt(0.975, n-1)). <span class="math inline">\(\hat{\sigma}\)</span> is the estimated standard deviation, and n is the number of samples used to calculate the mean.</p>
<p>The confidence interval can also be used in hypothesis testing. For example, let’s say that the average height of men is 180cm, with a 95% confidence interval of <span class="math inline">\(\pm10cm\)</span>. The null hypothesis is, that men and women have the same average height (<span class="math inline">\(\mu_{men} = \mu_{women}\)</span>), whereas the alternative hypothesis is, that their average height is not the same (<span class="math inline">\(\mu_{men} \neq \mu_{women}\)</span>).</p>
<p>If the height of women falls outside this confidence interval (meaning that the mean is larger than 190cm or lower than 170cm), one would be able to reject the null hypothesis, and conclude, that men and women do not have the same average height.</p>
</div>
<div id="t-test" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> T-test<a href="inferential-statistics.html#t-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A T-test is a statistical test that is used to determine whether there is a significant difference between the means of two groups. It is commonly used to compare the means of two groups that have been sampled from a larger population, to see if the groups are significantly different from one another.</p>
<p>The hypotheses of a T-test: <span class="math display">\[ H_{0}: \mu_{1}=\mu_{2} \\ H_{A}: \mu_{1}\neq\mu_{2}, \ \mu_{1}&gt;\mu_{2}  \ or \ \mu_{1}&lt;\mu_{2}\]</span>
Which alternative hypothesis to choose depends on the question that one wants answered.</p>
<p>There are several types of T-tests, including the independent samples T-test and the paired samples T-test. The independent samples T-test is used to compare the means of two separate groups, while the paired samples T-test is used to compare the means of two related groups, such as before and after measurements.</p>
<p>To conduct a T-test in R, you can use the <strong>t.test()</strong> function. This function takes the following arguments:</p>
<ul>
<li><p>x and y: These are the two groups that you want to compare. They can be vectors or data frames.</p></li>
<li><p>alternative: This specifies the alternative hypothesis. You can choose between “two.sided” (the default), “greater”, or “less”.</p></li>
<li><p>mu: This specifies the hypothesized mean difference between the two groups. By default, it is set to 0.</p></li>
<li><p>paired: This should be set to TRUE if you are conducting a paired samples t-test. Default is FALSE.</p></li>
<li><p>var.equal: Can be TRUE or FALSE, depending on whether or not the variances of the two groups can be treated as equal. Default is FALSE.</p></li>
<li><p>conf.level: The confidence level of choice. Default is 0.95.</p></li>
</ul>
<p>Here is an example using the BuffetSurvey data set:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="inferential-statistics.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data4consumerscience)</span>
<span id="cb61-2"><a href="inferential-statistics.html#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(pasta)</span>
<span id="cb61-3"><a href="inferential-statistics.html#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="inferential-statistics.html#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> pasta<span class="sc">$</span>Pasta_with_legumes_is_visually_appealing, </span>
<span id="cb61-5"><a href="inferential-statistics.html#cb61-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> pasta<span class="sc">$</span>Pasta_with_mushrooms_is_visually_appealing)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  pasta$Pasta_with_legumes_is_visually_appealing and pasta$Pasta_with_mushrooms_is_visually_appealing
## t = -3.0654, df = 103.39, p-value = 0.002774
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -1.152872 -0.247128
## sample estimates:
## mean of x mean of y 
##       5.5       6.2</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="inferential-statistics.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(readxl)</span></span>
<span id="cb63-2"><a href="inferential-statistics.html#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># BuffetSurvey &lt;- read_excel(&#39;~/Dropbox/DataAnalysis_ConsumerScience/dataanalyssisconsumerscience/DatasetRbook.xlsx&#39;, sheet = &#39;BuffetSurvey&#39;)</span></span>
<span id="cb63-3"><a href="inferential-statistics.html#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="inferential-statistics.html#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># t.test(BuffetSurvey$`Pasta with legumes is visually appealing to me. `,</span></span>
<span id="cb63-5"><a href="inferential-statistics.html#cb63-5" aria-hidden="true" tabindex="-1"></a>       <span class="co"># BuffetSurvey$`Pasta with mushrooms is visually appealing to me. `)</span></span></code></pre></div>
<p>This results in a p-value of 0.036, which is below the chosen <span class="math inline">\(\alpha\)</span>-level of 0.05. This means, that there is a significant difference between how visually appealing pasta with legumes and pasta with mushrooms perceived.</p>
</div>
<div id="f-test" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> F-test<a href="inferential-statistics.html#f-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An F-test is a statistical test that is used to compare the variance of two populations or samples. It is often used to test whether two groups have the same variance, or whether the variance of one group is significantly larger or smaller than the variance of another group.</p>
<p>The hypotheses of an F-test: <span class="math display">\[ H_{0}: var_{1}=var_{2} \\ H_{A}: var_{1}\neq var_{2}, \ var_{1}&gt;var_{2}  \ or \ var_{1}&lt;var_{2}\]</span></p>
<p>To conduct an F-test in R, you can use the <strong>var.test()</strong> function. This function takes two numeric vectors as input, and returns the F-value and p-value of the test.</p>
<p>Here is an example using the BuffetSurvey data set:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="inferential-statistics.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data4consumerscience)</span>
<span id="cb64-2"><a href="inferential-statistics.html#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(pasta)</span>
<span id="cb64-3"><a href="inferential-statistics.html#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="inferential-statistics.html#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">var.test</span>(<span class="at">x =</span> pasta<span class="sc">$</span>Pasta_with_legumes_is_visually_appealing, </span>
<span id="cb64-5"><a href="inferential-statistics.html#cb64-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> pasta<span class="sc">$</span>Pasta_with_mushrooms_is_visually_appealing)</span></code></pre></div>
<pre><code>## 
##  F test to compare two variances
## 
## data:  pasta$Pasta_with_legumes_is_visually_appealing and pasta$Pasta_with_mushrooms_is_visually_appealing
## F = 2.2049, num df = 59, denom df = 59, p-value = 0.002828
## alternative hypothesis: true ratio of variances is not equal to 1
## 95 percent confidence interval:
##  1.317018 3.691228
## sample estimates:
## ratio of variances 
##           2.204861</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="inferential-statistics.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(readxl)</span></span>
<span id="cb66-2"><a href="inferential-statistics.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co"># BuffetSurvey &lt;- read_excel(&#39;~/Dropbox/DataAnalysis_ConsumerScience/dataanalyssisconsumerscience/DatasetRbook.xlsx&#39;, sheet = &#39;BuffetSurvey&#39;)</span></span>
<span id="cb66-3"><a href="inferential-statistics.html#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="inferential-statistics.html#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># var.test(BuffetSurvey$`Pasta with legumes is visually appealing to me. `,</span></span>
<span id="cb66-5"><a href="inferential-statistics.html#cb66-5" aria-hidden="true" tabindex="-1"></a>       <span class="co"># BuffetSurvey$`Pasta with mushrooms is visually appealing to me. `)</span></span></code></pre></div>
<p>The p-value of the F-test is 0.037, which is below the chosen <span class="math inline">\(\alpha\)</span>-level of 0.05. This means, that the variance of the scores for how visually appealing pasta with legumes is significantly different from variance of the scores for how visually appealing pasta with mushrooms. - This actually confirms, that the correct T-test was used in the section above, since the T-test with unequal variance was used.</p>
<p>While it is nice to use the F-test on two groups of samples, another very important statistical method uses the F-test to calculate its p-values - the ANOVA or Analysis of Variance, which will be introduced in the following section.</p>
</div>
<div id="analysis-of-variance-anova" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Analysis of Variance (ANOVA)<a href="inferential-statistics.html#analysis-of-variance-anova" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>ANOVA (Analysis of Variance) is a statistical method used to test the equality of means among more than two groups. But instead of directly comparing the observed means of the groups (which would lead to multiple tests), one can use get away with one test analyzing variance (hence the name).</p>
<p>This is done by comparing the variance BETWEEN groups to the variance WITHIN groups. If the variance between the groups is significantly larger than the variance within the groups, we can conclude, that the mean of at least one of the groups is significantly different from the rest. To test whether the variances differ significantly, an F-test is used to compare the variances. If the p-value is below the selected <span class="math inline">\(\alpha\)</span>-level (often <span class="math inline">\(\alpha\)</span>=0.05)</p>
<p>As hypotheses, it looks like this (k is the number of groups):
<span class="math display">\[ H_{0}: \mu_{1}=\mu_{2} = ... =\mu_{k}  \\ H_{A}: At \ least \ one \ mean \ is \ different\]</span>
ANOVA can be performed using one-way ANOVA, multiple-way ANOVA, depending on the application, which can be seen below.</p>
<div id="one-way-anova" class="section level3 hasAnchor" number="5.6.1">
<h3><span class="header-section-number">5.6.1</span> One-way ANOVA<a href="inferential-statistics.html#one-way-anova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In a one-way ANOVA, we analyze the effect of one categorical factor on a response. This could e.g. be if country of origin has an impact on the alcohol content of the wine produced in that country, or if your dietary preference has an impact on your body weight.
When conducting a one-way ANOVA, the model looks like this:
<span class="math display">\[ Y_{ij} = \mu + \alpha(A_{i}) + e_{ij}  \\ where \ e_{ij}  \sim \mathcal{N}(0,\sigma^{2}) \ and \ independent \\ for \ j=1,...,n_{i} \ and \ i=1,...,k \]</span>
Here, <span class="math inline">\(Y_{ij}\)</span> represents the jth observation of the ith treatment level (i = 1 to k and j = 1 to <span class="math inline">\(n_i\)</span>).This means, that e.g., <span class="math inline">\(Y_{23}\)</span> represents the 3rd observation of the 2nd factor. <span class="math inline">\(\mu\)</span> is the grand mean of the dataset, and <span class="math inline">\(\alpha\)</span> is effect of the i-th level of our factor A (e.g. Argentina or France as wine-producing countries, or pescetarian as your dietary preference).</p>
<p>The ANOVA works, when the above-mentioned assumptions are true: The residuals (<span class="math inline">\(e_{ij}\)</span>) are normally distributed around 0, and independent. A way to check the assumptions, is to use the built-in <strong>plot</strong>-function in R, and look at whether the data are normally distributed using the QQ-plot, and looking at the residuals, to check if the assumptions are viable.</p>
<p>To show how to perform a one-way ANOVA in R, here is an example using the beerliking-dataset:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="inferential-statistics.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data4consumerscience)</span>
<span id="cb67-2"><a href="inferential-statistics.html#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;beerliking&quot;</span>)</span>
<span id="cb67-3"><a href="inferential-statistics.html#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="inferential-statistics.html#cb67-4" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> beerliking, Liking <span class="sc">~</span> Beer)</span>
<span id="cb67-5"><a href="inferential-statistics.html#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="inferential-statistics.html#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model,<span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-43-1.png" width="672" /><img src="bookdownproj_files/figure-html/unnamed-chunk-43-2.png" width="672" /></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="inferential-statistics.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Liking
##            Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## Beer        5  110.41 22.0818  7.3939 8.269e-07 ***
## Residuals 914 2729.64  2.9865                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>First, the model is created using <strong>lm</strong>, specifying the dataset used, and the dependent and independent variables (Liking and Beer, respectively)</p>
<p>The resulting table of the <strong>anova</strong>-function is called an ANOVA-table, and contains a lot of information about the data. But the column that we are most often looking at is Pr(&gt;F), which is another name for the p-value. If this value is below the chosen <span class="math inline">\(\alpha\)</span>-level (often <span class="math inline">\(\alpha\)</span>=0.05, which in this case it is), then we can conclude, that the judges like at least one of the Beers significantly better/worse than the rest.</p>
</div>
<div id="two-way-anova" class="section level3 hasAnchor" number="5.6.2">
<h3><span class="header-section-number">5.6.2</span> Two-way ANOVA<a href="inferential-statistics.html#two-way-anova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As the name suggests, the two-way ANOVA includes two categorical factors in the model instead of one in one-way ANOVA, and compares both factors’ (and their interaction) effects on the response. This could be the effect of e.g. both the country of origin as well as the grape variety on the liking of wine.</p>
<p>For a two-way ANOVA with factor A with a levels, and factor B with b levels:
<span class="math display">\[ Y_{ijk} = \mu + \alpha(A_{i}) + \beta(B_{j}) + \gamma(A_{i}\times B_{j}) + e_{ijk}  \\ where \ e_{ijk}  \sim \mathcal{N}(0,\sigma^{2}) \ and \ independent \\ for \ i=1,...,a \ and \ j=1,...,b \ and \ k=1,...,n_{ij} \]</span></p>
<p>Here, <span class="math inline">\(Y_{ijk}\)</span> represents the kth observation of the ith level of factor A, and jth level of factor B.This means, that e.g., <span class="math inline">\(Y_{234}\)</span> represents the 4th observation of the 2nd level of A and the 3rd level of B. <span class="math inline">\(\mu\)</span> is the grand mean of the dataset, <span class="math inline">\(\alpha\)</span> is the effect of the ith level of factor A (e.g. Argentina or France as wine-producing countries), <span class="math inline">\(\beta\)</span> is the effect of the jth level of factor B (e.g. Pinot Gris, Chardonnay, Riesling, etc.) and <span class="math inline">\(\gamma\)</span> is the interaction effect between factor A and B (e.g. French Chardonnay or German Riesling).</p>
<p>As with the one-way ANOVA, the same assumptions about normality and independence of the residuals has to hold, and these can again be checked using <strong>plot</strong> as shown below.</p>
<p>However, the <strong>anova</strong>-function should be used with caution, when model have more than one independent variable. This is the case, because, <strong>anova</strong> is performing what is commonly referred to as a Type I ANOVA, also called a sequential ANOVA, where the factors are tested in the specified order. Theoretically, this could be what you want, but in most cases we are interested in the effect of a factor, regardless of order.</p>
<p>This is called a Type II ANOVA, and in R it can be performed using <strong>drop1</strong>, as shown below in model2.</p>
<p>However, if an interaction effect is present (e.g. if the effect of Riesling is enhanced by the wine originating from Germany), then a Type II ANOVA only returns the effect of this interaction, due to the <a href="https://randomeffect.net/post/2020/08/11/principle-of-marginality/">principle of marginality</a>. This implies, that if an interaction is in fact present, the “simple” main effects (of e.g. country and grape alone) are poor estimators of the response. If the interaction is non-significant, however, it should be removed from the model, and we end up with a Type II model with the main effects.</p>
<p>If for some reason we are interested in both the main effects and the interaction (if the interaction effect is significant), we can perform what is called a Type III ANOVA. This will test all effects against a model without said effect. As this will over-parameterise the model, in R, one has to choose a contrasts setting that sums to zero, otherwise the ANOVA analysis will give incorrect results. This is what is done with <strong>options</strong>. Then model3 is created to also test the interaction, and in <strong>drop1</strong> it is specified, that we want all model components to be tested (Type III ANOVA), using <strong>.~.</strong>.</p>
<p>If there is no significant interaction effect, a Type II ANOVA is a stronger test, which is why one should choose it if possible.</p>
<p>More on the different types of ANOVA <a href="https://towardsdatascience.com/anovas-three-types-of-estimating-sums-of-squares-don-t-make-the-wrong-choice-91107c77a27a">here</a> and <a href="https://mcfromnz.wordpress.com/2011/03/02/anova-type-iiiiii-ss-explained/">here</a>.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="inferential-statistics.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data4consumerscience)</span>
<span id="cb70-2"><a href="inferential-statistics.html#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(beerliking)</span>
<span id="cb70-3"><a href="inferential-statistics.html#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="inferential-statistics.html#cb70-4" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> beerliking, Liking <span class="sc">~</span> Beer <span class="sc">+</span> Age)</span>
<span id="cb70-5"><a href="inferential-statistics.html#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="inferential-statistics.html#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model2,<span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-44-1.png" width="672" /><img src="bookdownproj_files/figure-html/unnamed-chunk-44-2.png" width="672" /></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="inferential-statistics.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(model2, <span class="at">test =</span> <span class="st">&#39;F&#39;</span>)</span></code></pre></div>
<pre><code>## Single term deletions
## 
## Model:
## Liking ~ Beer + Age
##        Df Sum of Sq    RSS    AIC F value    Pr(&gt;F)    
## &lt;none&gt;              2692.2 1011.8                      
## Beer    5   110.948 2803.1 1039.0  7.4841 6.784e-07 ***
## Age     6    37.493 2729.6 1012.5  2.1076    0.0501 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="inferential-statistics.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="st">&#39;contr.sum&#39;</span>,<span class="st">&#39;contr.poly&#39;</span>))</span>
<span id="cb73-2"><a href="inferential-statistics.html#cb73-2" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> beerliking, Liking <span class="sc">~</span> Beer <span class="sc">+</span> Age <span class="sc">+</span> Beer<span class="sc">:</span>Age)</span>
<span id="cb73-3"><a href="inferential-statistics.html#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="inferential-statistics.html#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model3,<span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-44-3.png" width="672" /><img src="bookdownproj_files/figure-html/unnamed-chunk-44-4.png" width="672" /></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="inferential-statistics.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(model3, .<span class="sc">~</span>., <span class="at">test =</span> <span class="st">&#39;F&#39;</span>)</span></code></pre></div>
<pre><code>## Single term deletions
## 
## Model:
## Liking ~ Beer + Age + Beer:Age
##          Df Sum of Sq    RSS    AIC F value   Pr(&gt;F)   
## &lt;none&gt;                2604.1 1041.2                    
## Beer      5    57.549 2661.6 1051.3  3.8807 0.001745 **
## Age       6    37.158 2641.2 1042.2  2.0880 0.052306 . 
## Beer:Age 30    88.089 2692.2 1011.8  0.9900 0.482521   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>It looks like we have no significant interaction effect, since the p-value = 0.48 &gt; <span class="math inline">\(\alpha\)</span> (0.05). This means, that we can look at the Type II-analysis. Here, it shows that Beer-type is very important for the Liking score, since the p-value = 6.784e-07, which is way lower than <span class="math inline">\(\alpha\)</span>. Age is very close to <span class="math inline">\(\alpha\)</span>, which suggests, that even though the effect is technically non-significant, it might be worth looking into whether all ages like beer the same.</p>
</div>
<div id="post-hoc-test---tukeys-honest-significant-difference" class="section level3 hasAnchor" number="5.6.3">
<h3><span class="header-section-number">5.6.3</span> Post hoc test - Tukey’s Honest Significant Difference<a href="inferential-statistics.html#post-hoc-test---tukeys-honest-significant-difference" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>After the ANOVA, we might have concluded, that at least one of the groups of at least one of the factors is significantly different from the rest. Now you would like to know which one(s) of the groups this significant difference originates from.</p>
<p>This is where the Tukey’s Honest Significant Difference (in short, Tukey test) is very useful.</p>
<p>To compare more than two groups, one would have to conduct multiple pairwise T-tests. This does, however, not hold up, as probabilities are cumulative, which means that while the first test would yield a p-value lower than <span class="math inline">\(\alpha\)</span> (often 0.05), when conducting multiple tests, the cumulative p-value could exceed <span class="math inline">\(\alpha\)</span>.</p>
<p>A Tukey test corrects for this, and is therefore a better fit when dealing with more than two groups.</p>
<p>There are several ways to conduct a Tukey test in R, but the one that works in most usecases is the one shown below, using the <strong>multcomp</strong>-package and the <strong>glht</strong>-function. The dataset used here is the beerliking-dataset.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="inferential-statistics.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb76-2"><a href="inferential-statistics.html#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data4consumerscience)</span>
<span id="cb76-3"><a href="inferential-statistics.html#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;beerliking&quot;</span>)</span>
<span id="cb76-4"><a href="inferential-statistics.html#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="inferential-statistics.html#cb76-5" aria-hidden="true" tabindex="-1"></a>beerliking<span class="sc">$</span>Beer <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(beerliking<span class="sc">$</span>Beer)</span>
<span id="cb76-6"><a href="inferential-statistics.html#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="inferential-statistics.html#cb76-7" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> beerliking, Liking <span class="sc">~</span> Beer)</span>
<span id="cb76-8"><a href="inferential-statistics.html#cb76-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-9"><a href="inferential-statistics.html#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(model, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">Beer =</span> <span class="st">&quot;Tukey&quot;</span>)))</span></code></pre></div>
<pre><code>## 
##   Simultaneous Tests for General Linear Hypotheses
## 
## Multiple Comparisons of Means: Tukey Contrasts
## 
## 
## Fit: lm(formula = Liking ~ Beer, data = beerliking)
## 
## Linear Hypotheses:
##                                   Estimate Std. Error t value Pr(&gt;|t|)    
## NY Lager - Brown Ale == 0       -6.399e-01  1.979e-01  -3.233  0.01600 *  
## Porse Bock - Brown Ale == 0     -8.364e-01  1.976e-01  -4.233  &lt; 0.001 ***
## Ravnsborg Red - Brown Ale == 0  -2.325e-01  1.976e-01  -1.177  0.84802    
## River Beer - Brown Ale == 0     -8.364e-01  1.976e-01  -4.233  &lt; 0.001 ***
## Wheat IPA - Brown Ale == 0      -9.405e-01  1.979e-01  -4.752  &lt; 0.001 ***
## Porse Bock - NY Lager == 0      -1.965e-01  1.973e-01  -0.996  0.91921    
## Ravnsborg Red - NY Lager == 0    4.074e-01  1.973e-01   2.065  0.30656    
## River Beer - NY Lager == 0      -1.965e-01  1.973e-01  -0.996  0.91920    
## Wheat IPA - NY Lager == 0       -3.007e-01  1.976e-01  -1.522  0.65031    
## Ravnsborg Red - Porse Bock == 0  6.039e-01  1.969e-01   3.066  0.02704 *  
## River Beer - Porse Bock == 0    -2.831e-15  1.969e-01   0.000  1.00000    
## Wheat IPA - Porse Bock == 0     -1.042e-01  1.973e-01  -0.528  0.99506    
## River Beer - Ravnsborg Red == 0 -6.039e-01  1.969e-01  -3.066  0.02698 *  
## Wheat IPA - Ravnsborg Red == 0  -7.080e-01  1.973e-01  -3.589  0.00476 ** 
## Wheat IPA - River Beer == 0     -1.042e-01  1.973e-01  -0.528  0.99506    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## (Adjusted p values reported -- single-step method)</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="inferential-statistics.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cld</span>(<span class="fu">glht</span>(model, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">Beer =</span> <span class="st">&quot;Tukey&quot;</span>)))</span></code></pre></div>
<pre><code>##     Brown Ale      NY Lager    Porse Bock Ravnsborg Red    River Beer 
##           &quot;a&quot;          &quot;bc&quot;           &quot;c&quot;          &quot;ab&quot;           &quot;c&quot; 
##     Wheat IPA 
##           &quot;c&quot;</code></pre>
<p>When inserting the <strong>glht</strong>-object into <strong>summary</strong>, the individual, pairwise comparisons are shown, with the adjusted p-values.</p>
<p>Another (sometimes easier to interpret) way of displaying the pairwise comparison is by the use of letters, as is shown using <strong>cld</strong>. When groups have different letter, they are significantly different from one another, while groups sharing a letter means no significant difference between the two. Here, we can see, that Brown Ale has scored significantly higher than Wheat IPA, since they have been assigned with c and a respectively. But the Brown Ale is not significantly different from the Ravnsborg Red, as they both have been assigned with c’s.</p>
</div>
</div>
<div id="introduction-to-linear-and-mixed-models" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Introduction to linear and mixed models<a href="inferential-statistics.html#introduction-to-linear-and-mixed-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Linear models are one of the most used statistical methods. The definition is that the response is linear in the parameters. This means, that it one can see it as an extention of the ANOVA-models already described, but with the independent variable now being continuos rather than categorical. If <span class="math inline">\(y\)</span> is the response, and <span class="math inline">\(x\)</span> is the predictor, then both of the models below are linear models</p>
<p><span class="math display">\[y = a + b\cdot x + e\]</span></p>
<p><span class="math display">\[y = a + b\cdot x + c\cdot x^2 + e\]</span>
Here you see that the response is linear in the parameters <span class="math inline">\(a,b,c\)</span>. I.e. it has nothing to do with being linear in the predictor.</p>
</div>
<div id="normal-and-mixed-models" class="section level2 hasAnchor" number="5.8">
<h2><span class="header-section-number">5.8</span> Normal and Mixed models<a href="inferential-statistics.html#normal-and-mixed-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="normal-model" class="section level3 hasAnchor" number="5.8.1">
<h3><span class="header-section-number">5.8.1</span> Normal model<a href="inferential-statistics.html#normal-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In a <em>normal</em> linear model such as:</p>
<p><span class="math display">\[y = a + b\cdot x + e\]</span></p>
<p>The assumption is that the uncertainty is captured by one entry, namely the residuals (<span class="math inline">\(e\)</span>).
For instance, the relation between <em>Hunger</em> and the intake <em>AdLibg</em> of dishes with Capsaicin can be visualized and modeled by:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="inferential-statistics.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb80-2"><a href="inferential-statistics.html#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data4consumerscience)</span>
<span id="cb80-3"><a href="inferential-statistics.html#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&#39;chili&#39;</span>)</span>
<span id="cb80-4"><a href="inferential-statistics.html#cb80-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> chili <span class="sc">%&gt;%</span> </span>
<span id="cb80-5"><a href="inferential-statistics.html#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># only include a single treatment</span></span>
<span id="cb80-6"><a href="inferential-statistics.html#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Treatment<span class="sc">==</span><span class="st">&#39;Capsaicin&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb80-7"><a href="inferential-statistics.html#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># only include the first trial for each judge</span></span>
<span id="cb80-8"><a href="inferential-statistics.html#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">duplicated</span>(Judge)) </span>
<span id="cb80-9"><a href="inferential-statistics.html#cb80-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-10"><a href="inferential-statistics.html#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> x, <span class="fu">aes</span>(<span class="at">x =</span> Hunger, <span class="at">y =</span> AdLibg)) <span class="sc">+</span> </span>
<span id="cb80-11"><a href="inferential-statistics.html#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb80-12"><a href="inferential-statistics.html#cb80-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> F)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<p>Naturally, the more hungry, the higher the intake.</p>
<p>A model describing this relation:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="inferential-statistics.html#cb81-1" aria-hidden="true" tabindex="-1"></a>mdl <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> x, AdLibg<span class="sc">~</span>Hunger)</span>
<span id="cb81-2"><a href="inferential-statistics.html#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mdl)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = AdLibg ~ Hunger, data = x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -347.34 -106.69  -18.06  133.88  341.60 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  379.826     73.814   5.146 2.56e-05 ***
## Hunger         3.447      1.078   3.196  0.00375 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 190.5 on 25 degrees of freedom
## Multiple R-squared:  0.2901, Adjusted R-squared:  0.2617 
## F-statistic: 10.21 on 1 and 25 DF,  p-value: 0.003753</code></pre>
<p>Here we see that consumption increases by <span class="math inline">\(3.45g\)</span> per increase in <span class="math inline">\(1\)</span> hunger scale, and that this slope has a standard error of <span class="math inline">\(1.08g\)</span>. Further, at Hunger=0 the intake is <span class="math inline">\(379.8g\)</span>. Furhter, we see that this relation is significant <span class="math inline">\(p = 0.0036\)</span>.</p>
<p>More details on the use of linear models in R and how-to can be viewed in these videos:</p>
<div class="vembedr">
<div>
<iframe src="https://www.youtube.com/embed/66z_MRwtFJM" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
<div class="vembedr">
<div>
<iframe src="https://www.youtube.com/embed/2mAqgL0Xc-s" width="533" height="300" frameborder="0" allowfullscreen="" data-external="1"></iframe>
</div>
</div>
</div>
<div id="mixed-model" class="section level3 hasAnchor" number="5.8.2">
<h3><span class="header-section-number">5.8.2</span> Mixed model<a href="inferential-statistics.html#mixed-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A <em>mixed</em> model refers to the situation, where more than one part of the model is handling the uncertainty.
For instance, in the chili data set there are two instances for each judge, and hence the uncertainty can be split into <em>between</em> judges and <em>within</em> judges.</p>
<p>In this plot the intake is shown across products (<em>Treatment</em>) and labelled with the <em>Judge</em> number. For instance, Judge 1 is in general high and 24 generally low. Further, the plot is splitted according to the two test-repetition (First: TestDays = 1,..,5, Second: TestDays = 6,..,10).</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="inferential-statistics.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb83-2"><a href="inferential-statistics.html#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> chili, <span class="fu">aes</span>(<span class="at">x =</span> Hunger, <span class="at">y =</span> AdLibg, <span class="at">color =</span> Treatment)) <span class="sc">+</span> </span>
<span id="cb83-3"><a href="inferential-statistics.html#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Judge)) <span class="sc">+</span> </span>
<span id="cb83-4"><a href="inferential-statistics.html#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> lm, <span class="at">se =</span> F) <span class="sc">+</span> </span>
<span id="cb83-5"><a href="inferential-statistics.html#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>TestDay<span class="sc">&gt;</span><span class="dv">5</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<p>The above-mentioned structure is encoded in the modelling. <strong>lmer</strong> is used, when creating a mixed effect model. The judges and the test day are considered random effects, and are assigned to be so by adding a 1 and a horizontal line when creating the model.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="inferential-statistics.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb84-2"><a href="inferential-statistics.html#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb84-3"><a href="inferential-statistics.html#cb84-3" aria-hidden="true" tabindex="-1"></a>chili<span class="sc">$</span>TestDay2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(chili<span class="sc">$</span>TestDay<span class="sc">&gt;</span><span class="dv">5</span>) <span class="co"># adding a new testday variable</span></span>
<span id="cb84-4"><a href="inferential-statistics.html#cb84-4" aria-hidden="true" tabindex="-1"></a>mdlmix <span class="ot">&lt;-</span> <span class="fu">lmer</span>(<span class="at">data =</span> chili, AdLibg <span class="sc">~</span> Hunger<span class="sc">*</span>Treatment <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Judge)  <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>(TestDay2)))</span>
<span id="cb84-5"><a href="inferential-statistics.html#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mdlmix)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML. t-tests use Satterthwaite&#39;s method [
## lmerModLmerTest]
## Formula: AdLibg ~ Hunger * Treatment + (1 | Judge) + (1 | (TestDay2))
##    Data: chili
## 
## REML criterion at convergence: 3414.4
## 
## Scaled residuals: 
##      Min       1Q   Median       3Q      Max 
## -2.78687 -0.60988  0.01365  0.51858  2.85224 
## 
## Random effects:
##  Groups     Name        Variance Std.Dev.
##  Judge      (Intercept) 27011    164.35  
##  (TestDay2) (Intercept)  2974     54.53  
##  Residual               16870    129.89  
## Number of obs: 269, groups:  Judge, 27; (TestDay2), 2
## 
## Fixed effects:
##                    Estimate Std. Error        df t value Pr(&gt;|t|)    
## (Intercept)       352.28066   52.75937   3.16773   6.677  0.00576 ** 
## Hunger              2.92939    0.24957 238.99649  11.738  &lt; 2e-16 ***
## Treatment1        -18.77367   31.47373 232.74410  -0.596  0.55143    
## Treatment2          5.88641   30.88143 232.74962   0.191  0.84899    
## Treatment3        -11.29847   33.80720 232.71363  -0.334  0.73853    
## Treatment4        -17.75656   29.41156 232.57574  -0.604  0.54661    
## Hunger:Treatment1   0.53290    0.45930 233.05709   1.160  0.24714    
## Hunger:Treatment2  -0.35878    0.44660 233.00610  -0.803  0.42259    
## Hunger:Treatment3   0.03973    0.46252 233.14079   0.086  0.93163    
## Hunger:Treatment4  -0.28247    0.43373 232.88188  -0.651  0.51551    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##             (Intr) Hunger Trtmn1 Trtmn2 Trtmn3 Trtmn4 Hng:T1 Hng:T2 Hng:T3
## Hunger      -0.289                                                        
## Treatment1  -0.007  0.002                                                 
## Treatment2  -0.013  0.028 -0.220                                          
## Treatment3   0.014 -0.018 -0.269 -0.262                                   
## Treatment4  -0.033  0.081 -0.214 -0.198 -0.238                            
## Hngr:Trtmn1 -0.001  0.022 -0.865  0.192  0.229  0.194                     
## Hngr:Trtmn2  0.009 -0.012  0.196 -0.856  0.218  0.171 -0.239              
## Hngr:Trtmn3 -0.004 -0.021  0.241  0.231 -0.881  0.208 -0.263 -0.253       
## Hngr:Trtmn4  0.023 -0.041  0.192  0.169  0.193 -0.841 -0.247 -0.222 -0.233</code></pre>
<p>The summary spits out the model estimates, and especially the random effects shows that the within individual residual variation is <span class="math inline">\(130g\)</span> while the between individual variation is larger: <span class="math inline">\(164g\)</span>. I.e. the consumption is more depend on the individual than the repetitions. Further, the testday also has a little effect (<span class="math inline">\(54g\)</span>).</p>
<p>We can evaluate the systematic effect overall by <strong>anova</strong>. When <strong>anova</strong> is used on a model created by <strong>lmer</strong>, it conducts a Type III ANOVA.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="inferential-statistics.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mdlmix)</span></code></pre></div>
<pre><code>## Type III Analysis of Variance Table with Satterthwaite&#39;s method
##                   Sum Sq Mean Sq NumDF  DenDF  F value Pr(&gt;F)    
## Hunger           2324398 2324398     1 239.00 137.7801 &lt;2e-16 ***
## Treatment          31278    7820     4 232.75   0.4635 0.7625    
## Hunger:Treatment   33035    8259     4 233.05   0.4895 0.7434    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>This shows that Hunger indeed will make you eat more, but the slopes and offsets in relation to the different products is non-significant.</p>
<p>To learn more and see how to conduct the analysis in R, see here: <a href="https://stat.ethz.ch/~meier/teaching/anova/index.html">More on ANOVA and mixed models</a></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="descriptive-statistics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="plotting-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mortenarendt/dataanalyssisconsumerscience/edit/master/05_InferentialStatistics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/mortenarendt/dataanalyssisconsumerscience/blob/master/05_InferentialStatistics.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
