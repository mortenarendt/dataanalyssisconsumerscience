<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Data | Data Analysis in R for Consumer Science</title>
  <meta name="description" content="Chapter 2 Data | Data Analysis in R for Consumer Science" />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Data | Data Analysis in R for Consumer Science" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Data | Data Analysis in R for Consumer Science" />
  
  
  

<meta name="author" content="Morten Arendt Rasmussens" />


<meta name="date" content="2022-08-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="libraries.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Analysis in R for Consumer Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>2</b> Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data.html"><a href="data.html#read-in-data-from-excel---ibuffet"><i class="fa fa-check"></i><b>2.1</b> Read in data from Excel - iBuffet</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="data.html"><a href="data.html#example-of-survey-data"><i class="fa fa-check"></i><b>2.1.1</b> Example of Survey data</a></li>
<li class="chapter" data-level="2.1.2" data-path="data.html"><a href="data.html#example-of-survey-scale"><i class="fa fa-check"></i><b>2.1.2</b> Example of Survey Scale</a></li>
<li class="chapter" data-level="2.1.3" data-path="data.html"><a href="data.html#edit-in-excel"><i class="fa fa-check"></i><b>2.1.3</b> Edit in excel</a></li>
<li class="chapter" data-level="2.1.4" data-path="data.html"><a href="data.html#importing-to-r"><i class="fa fa-check"></i><b>2.1.4</b> Importing to R</a></li>
<li class="chapter" data-level="2.1.5" data-path="data.html"><a href="data.html#editing-in-r"><i class="fa fa-check"></i><b>2.1.5</b> Editing in R</a></li>
<li class="chapter" data-level="2.1.6" data-path="data.html"><a href="data.html#merging-the-data"><i class="fa fa-check"></i><b>2.1.6</b> Merging the data</a></li>
<li class="chapter" data-level="2.1.7" data-path="data.html"><a href="data.html#save-the-data"><i class="fa fa-check"></i><b>2.1.7</b> Save the data</a></li>
<li class="chapter" data-level="2.1.8" data-path="data.html"><a href="data.html#ready-for-analysis"><i class="fa fa-check"></i><b>2.1.8</b> Ready for analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="libraries.html"><a href="libraries.html"><i class="fa fa-check"></i><b>3</b> Libraries</a></li>
<li class="chapter" data-level="4" data-path="descriptive-statistics-and-plotting.html"><a href="descriptive-statistics-and-plotting.html"><i class="fa fa-check"></i><b>4</b> Descriptive statistics and plotting</a>
<ul>
<li class="chapter" data-level="4.1" data-path="descriptive-statistics-and-plotting.html"><a href="descriptive-statistics-and-plotting.html#distributions-of-count-data"><i class="fa fa-check"></i><b>4.1</b> Distributions of count data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="descriptive-statistics-and-plotting.html"><a href="descriptive-statistics-and-plotting.html#descriptives-for-a-continouos-variable"><i class="fa fa-check"></i><b>4.1.1</b> Descriptives for a continouos variable</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="descriptive-statistics-and-plotting.html"><a href="descriptive-statistics-and-plotting.html#scatter-plots"><i class="fa fa-check"></i><b>4.2</b> Scatter plots</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="pca-on-survey-answers.html"><a href="pca-on-survey-answers.html"><i class="fa fa-check"></i><b>5</b> PCA on survey answers</a>
<ul>
<li class="chapter" data-level="5.1" data-path="pca-on-survey-answers.html"><a href="pca-on-survey-answers.html#bi-plot"><i class="fa fa-check"></i><b>5.1</b> Bi-plot</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="pca-on-survey-answers.html"><a href="pca-on-survey-answers.html#extract-the-components-and-run-all-associations."><i class="fa fa-check"></i><b>5.1.1</b> Extract the components and run all associations.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>6</b> Linear models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="linear-models.html"><a href="linear-models.html#example"><i class="fa fa-check"></i><b>6.1</b> Example</a></li>
<li class="chapter" data-level="6.2" data-path="linear-models.html"><a href="linear-models.html#run-a-bunch-of-models-at-once"><i class="fa fa-check"></i><b>6.2</b> Run a bunch of models at once</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="linear-models.html"><a href="linear-models.html#a-plot"><i class="fa fa-check"></i><b>6.2.1</b> A plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="mixed-models.html"><a href="mixed-models.html"><i class="fa fa-check"></i><b>7</b> Mixed models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mixed-models.html"><a href="mixed-models.html#with-several-variables"><i class="fa fa-check"></i><b>7.1</b> With several variables</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="check-all-that-applies-cata.html"><a href="check-all-that-applies-cata.html"><i class="fa fa-check"></i><b>8</b> Check All That Applies (CATA)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="check-all-that-applies-cata.html"><a href="check-all-that-applies-cata.html#an-example-from-beer-profiling"><i class="fa fa-check"></i><b>8.1</b> An example from Beer profiling</a></li>
<li class="chapter" data-level="8.2" data-path="check-all-that-applies-cata.html"><a href="check-all-that-applies-cata.html#two-versions-of-the-data"><i class="fa fa-check"></i><b>8.2</b> Two versions of the data</a></li>
<li class="chapter" data-level="8.3" data-path="check-all-that-applies-cata.html"><a href="check-all-that-applies-cata.html#pca"><i class="fa fa-check"></i><b>8.3</b> PCA</a></li>
<li class="chapter" data-level="8.4" data-path="check-all-that-applies-cata.html"><a href="check-all-that-applies-cata.html#cochranes-q-test"><i class="fa fa-check"></i><b>8.4</b> Cochranes Q-test</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="check-all-that-applies-cata.html"><a href="check-all-that-applies-cata.html#post-hoc-contrasts"><i class="fa fa-check"></i><b>8.4.1</b> Post hoc contrasts</a></li>
<li class="chapter" data-level="8.4.2" data-path="check-all-that-applies-cata.html"><a href="check-all-that-applies-cata.html#for-all-attributes"><i class="fa fa-check"></i><b>8.4.2</b> For all Attributes</a></li>
<li class="chapter" data-level="8.4.3" data-path="check-all-that-applies-cata.html"><a href="check-all-that-applies-cata.html#plsda"><i class="fa fa-check"></i><b>8.4.3</b> PLSDA</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="projective-mapping.html"><a href="projective-mapping.html"><i class="fa fa-check"></i><b>9</b> Projective mapping</a>
<ul>
<li class="chapter" data-level="9.1" data-path="projective-mapping.html"><a href="projective-mapping.html#example-from-mapping-of-xx"><i class="fa fa-check"></i><b>9.1</b> Example from mapping of XX</a></li>
<li class="chapter" data-level="9.2" data-path="projective-mapping.html"><a href="projective-mapping.html#a-collated-version-of-the-data"><i class="fa fa-check"></i><b>9.2</b> A Collated version of the data</a></li>
<li class="chapter" data-level="9.3" data-path="projective-mapping.html"><a href="projective-mapping.html#pca-on-collated-data"><i class="fa fa-check"></i><b>9.3</b> PCA on Collated data</a></li>
<li class="chapter" data-level="9.4" data-path="projective-mapping.html"><a href="projective-mapping.html#section"><i class="fa fa-check"></i><b>9.4</b> </a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="preference-mapping.html"><a href="preference-mapping.html"><i class="fa fa-check"></i><b>10</b> Preference Mapping</a>
<ul>
<li class="chapter" data-level="10.1" data-path="preference-mapping.html"><a href="preference-mapping.html#example-of-preference-mapping"><i class="fa fa-check"></i><b>10.1</b> Example of Preference Mapping</a></li>
<li class="chapter" data-level="10.2" data-path="preference-mapping.html"><a href="preference-mapping.html#pca-1"><i class="fa fa-check"></i><b>10.2</b> PCA</a></li>
<li class="chapter" data-level="10.3" data-path="preference-mapping.html"><a href="preference-mapping.html#analysis-by-pls"><i class="fa fa-check"></i><b>10.3</b> Analysis by PLS</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="consumer-segmentation.html"><a href="consumer-segmentation.html"><i class="fa fa-check"></i><b>11</b> Consumer Segmentation</a>
<ul>
<li class="chapter" data-level="11.1" data-path="consumer-segmentation.html"><a href="consumer-segmentation.html#kmeans"><i class="fa fa-check"></i><b>11.1</b> Kmeans</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="more-pca.html"><a href="more-pca.html"><i class="fa fa-check"></i><b>12</b> More PCA</a></li>
<li class="chapter" data-level="13" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>13</b> Logistic Regression</a></li>
<li class="chapter" data-level="14" data-path="confirmatory-factor-analysis-using-lavaan.html"><a href="confirmatory-factor-analysis-using-lavaan.html"><i class="fa fa-check"></i><b>14</b> Confirmatory Factor Analysis using lavaan</a>
<ul>
<li class="chapter" data-level="14.1" data-path="confirmatory-factor-analysis-using-lavaan.html"><a href="confirmatory-factor-analysis-using-lavaan.html#example---food-neophobia"><i class="fa fa-check"></i><b>14.1</b> Example - Food Neophobia</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="structured-equation-modelling.html"><a href="structured-equation-modelling.html"><i class="fa fa-check"></i><b>15</b> Structured Equation Modelling</a>
<ul>
<li class="chapter" data-level="15.1" data-path="structured-equation-modelling.html"><a href="structured-equation-modelling.html#example---theory-of-planned-behaviour"><i class="fa fa-check"></i><b>15.1</b> Example - Theory of Planned Behaviour</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis in R for Consumer Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Data<a href="data.html#data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this book several datasets are used targeting different research questions.
However, a fair part of the analysis tools are common. That is, descriptive analysis, plots, response correlations etc.</p>
<p>The data is included in the R-packgage you get by running the code below.
Be aware that you need devtools package to install from github.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="data.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install data-package</span></span>
<span id="cb1-2"><a href="data.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;devtools&#39;</span>)</span>
<span id="cb1-3"><a href="data.html#cb1-3" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&#39;mortenarendt/data4consumerscience&#39;</span>)</span></code></pre></div>
<p>The data is also available as excel sheets, and can be loaded using packages capable of reading from excel.
Below is an example using data from the so-called <em>iBuffet</em></p>
<div id="read-in-data-from-excel---ibuffet" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Read in data from Excel - iBuffet<a href="data.html#read-in-data-from-excel---ibuffet" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The data from the iBuffet comes in the form of csv or excel files.</p>
<p>Lad os se om skidtet virker… - take 2</p>
<p>These can be in the form of</p>
<ul>
<li>Consumption data from the Buffet</li>
<li>Survey data on liking, motivation, choices etc attaced to the particular buffet</li>
<li>Survey data on demographics for the participants such as age, gender, eating habits etc. These are general and different from the former, in that they have nothing to do with the current buffet.</li>
</ul>
<div class="figure">
<img src="buffetdata.png" width="500" alt="" />
<p class="caption">Example of Buffet data</p>
</div>
<div id="example-of-survey-data" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Example of Survey data<a href="data.html#example-of-survey-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure">
<img src="surveydata.png" width="500" alt="" />
<p class="caption">Example of Survey data</p>
</div>
</div>
<div id="example-of-survey-scale" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Example of Survey Scale<a href="data.html#example-of-survey-scale" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="figure">
<img src="surveyscale.png" width="200" alt="" />
<p class="caption">Survey Scale used</p>
</div>
</div>
<div id="edit-in-excel" class="section level3 hasAnchor" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> Edit in excel<a href="data.html#edit-in-excel" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Turn the files into sheets in excel having all in one file.</p>
<p>Setup the data in excel such that they match the above in terms of format.</p>
<p>What is important is:</p>
<ul>
<li>First row is used on headings and none of these are repeated. I.e. all unique within a sheet</li>
<li>Data comes from row 2.</li>
<li>All rows should contain data (empty cell as also data), so all empty rows are removed</li>
<li>Headings between sheets refering to the same: e.g. participant ID should have exactly similar heading.</li>
<li>If you have calculated stuff within excel such as a sum of the numbers in a coloum, then these should be removed from the sheet. It is not data!</li>
</ul>
<p>We suggest that you keep both the original version of the data as a sheet, and the ready-to-import as a sheet.</p>
</div>
<div id="importing-to-r" class="section level3 hasAnchor" number="2.1.4">
<h3><span class="header-section-number">2.1.4</span> Importing to R<a href="data.html#importing-to-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Each of the sheets are imported seperately. Here we use the package readxl with the function read_excel.
If the data is not in the same folder as your script, then include the path to the data, or move the data to the location.
Be aware that the SurveyScale sheet does not have a heading. Here we import without (col_names = F), and set it manually afterwards, but you can also put it in manually.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="data.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb2-2"><a href="data.html#cb2-2" aria-hidden="true" tabindex="-1"></a>Buffet <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&#39;./data/iBuffet.xlsx&#39;</span>,<span class="at">sheet =</span> <span class="st">&#39;BuffetData&#39;</span>)</span>
<span id="cb2-3"><a href="data.html#cb2-3" aria-hidden="true" tabindex="-1"></a>Survey <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&#39;./data/iBuffet.xlsx&#39;</span>,<span class="at">sheet =</span> <span class="st">&#39;SurveyData&#39;</span>)</span>
<span id="cb2-4"><a href="data.html#cb2-4" aria-hidden="true" tabindex="-1"></a>Surveyscales <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&#39;./data/iBuffet.xlsx&#39;</span>,</span>
<span id="cb2-5"><a href="data.html#cb2-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">sheet =</span> <span class="st">&#39;SurveyScale&#39;</span>, <span class="at">col_names =</span>  F)</span></code></pre></div>
<pre><code>## New names:
## • `` -&gt; `...1`
## • `` -&gt; `...2`</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="data.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Surveyscales) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;answ&#39;</span>,<span class="st">&#39;number&#39;</span>)</span></code></pre></div>
<p>Have a look at the imported elements to ensure that indeed, they mimic the excel-sheets. head(), str() and View() is your tools.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="data.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Buffet)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   Person   Day StationName         Consumption
##   &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;                     &lt;dbl&gt;
## 1 P01        1 Pasta with legumes           90
## 2 P01        1 Pasta with mushroom         148
## 3 P02        1 Pasta with legumes          172
## 4 P02        1 Pasta with mushroom          40
## 5 P03        1 Pasta with legumes           56
## 6 P03        1 Pasta with mushroom          52</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="data.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Buffet)</span></code></pre></div>
<pre><code>## tibble [60 × 4] (S3: tbl_df/tbl/data.frame)
##  $ Person     : chr [1:60] &quot;P01&quot; &quot;P01&quot; &quot;P02&quot; &quot;P02&quot; ...
##  $ Day        : num [1:60] 1 1 1 1 1 1 1 1 1 1 ...
##  $ StationName: chr [1:60] &quot;Pasta with legumes&quot; &quot;Pasta with mushroom&quot; &quot;Pasta with legumes&quot; &quot;Pasta with mushroom&quot; ...
##  $ Consumption: num [1:60] 90 148 172 40 56 52 66 86 304 336 ...</code></pre>
<p>We see that the coloum with names (Person and StationName) is interpreted as characters (chr) while the stuff which should be numbers (Comsuption) is numeric (num). If that is not the case, you will need to transform them using as.numeric() or as.character().</p>
</div>
<div id="editing-in-r" class="section level3 hasAnchor" number="2.1.5">
<h3><span class="header-section-number">2.1.5</span> Editing in R<a href="data.html#editing-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The Buffet data is optimal as is. We have the data as long format with all repsonse in <em>one</em> coloumn and then coloums clearifying the design, time, type, person etc.</p>
<p>However the Survey data is not optimal directly.</p>
<p>Things to fix:
* The 7-point for the last four questions we want en encode as a numerical factor correctly leveled.
* The data can additionally be versioned in both long and wide format</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="data.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
## ✔ ggplot2 3.3.6     ✔ purrr   0.3.4
## ✔ tibble  3.1.8     ✔ dplyr   1.0.9
## ✔ tidyr   1.2.0     ✔ stringr 1.4.0
## ✔ readr   2.1.2     ✔ forcats 0.5.1
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="data.html#cb11-1" aria-hidden="true" tabindex="-1"></a>Surveylong <span class="ot">&lt;-</span> Survey <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="data.html#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(question,answ, <span class="st">`</span><span class="at">Pasta with legumes is visually appealing to me. </span><span class="st">`</span><span class="sc">:</span></span>
<span id="cb11-3"><a href="data.html#cb11-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">`</span><span class="at">I like the taste of pasta with mushrooms! </span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb11-4"><a href="data.html#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">answ =</span> answ <span class="sc">%&gt;%</span> <span class="fu">factor</span>(<span class="at">levels =</span> Surveyscales<span class="sc">$</span>answ), </span>
<span id="cb11-5"><a href="data.html#cb11-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">answnum =</span> answ <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>())</span>
<span id="cb11-6"><a href="data.html#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="data.html#cb11-7" aria-hidden="true" tabindex="-1"></a>Surveywide <span class="ot">&lt;-</span> Surveylong <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>answ) <span class="sc">%&gt;%</span> <span class="fu">spread</span>(question,answnum)</span></code></pre></div>
</div>
<div id="merging-the-data" class="section level3 hasAnchor" number="2.1.6">
<h3><span class="header-section-number">2.1.6</span> Merging the data<a href="data.html#merging-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For the sake of being able to compare consumption (obtained from buffet data) with liking and motives (obtained from the survey data) these data frames needs to be merged. There are several merge options, here we use left_join() but full_join() and right_join() might more suited in some situations.</p>
<div id="adding-survey-to-buffets" class="section level4 hasAnchor" number="2.1.6.1">
<h4><span class="header-section-number">2.1.6.1</span> Adding survey to buffets<a href="data.html#adding-survey-to-buffets" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Merging should be done such that Person and Day match.
If you additionally have demographic data (gender, age, etc.) then obviously only Person should match, as the data is constant over Days.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="data.html#cb12-1" aria-hidden="true" tabindex="-1"></a>Buffet_survey <span class="ot">&lt;-</span> Buffet <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="data.html#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(Surveywide, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;Person&#39;</span>,<span class="st">&#39;Day&#39;</span>))</span></code></pre></div>
</div>
<div id="adding-buffet-to-survey" class="section level4 hasAnchor" number="2.1.6.2">
<h4><span class="header-section-number">2.1.6.2</span> Adding buffet to survey<a href="data.html#adding-buffet-to-survey" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Similarly, merging should be done such that Person and Day match.
If you additionally have demographic data (gender, age, etc.) then obviously only Person should match, as the data is constant over Days.
Further, we use the long format of the survey data here.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="data.html#cb13-1" aria-hidden="true" tabindex="-1"></a>Surveylong_buffet <span class="ot">&lt;-</span> Surveylong <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="data.html#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(Buffet, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;Person&#39;</span>,<span class="st">&#39;Day&#39;</span>))</span></code></pre></div>
<p>Due to not having a total overlap of information, some responses (here for consumption) will be missing. That you can see using the table function.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="data.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">is.na</span>(Surveylong_buffet<span class="sc">$</span>Consumption))</span></code></pre></div>
<pre><code>## 
## FALSE 
##   240</code></pre>
</div>
</div>
<div id="save-the-data" class="section level3 hasAnchor" number="2.1.7">
<h3><span class="header-section-number">2.1.7</span> Save the data<a href="data.html#save-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can export any data frame from R to excel (for instance using the <em>rio</em> package), as well as saving it as .RData for further analysis.</p>
<p>Use save.image() to save everything, or use save() to specify which elements to save</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="data.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save.image</span>(<span class="at">file =</span> <span class="st">&#39;iBuffetSurveyDataEverything.RData&#39;</span>) <span class="co"># everything</span></span>
<span id="cb16-2"><a href="data.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(<span class="at">file =</span> <span class="st">&#39;iBuffetSurveyData.RData&#39;</span>,</span>
<span id="cb16-3"><a href="data.html#cb16-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">list =</span> <span class="fu">c</span>(<span class="st">&#39;Survey&#39;</span>,<span class="st">&#39;Surveylong_buffet&#39;</span>,</span>
<span id="cb16-4"><a href="data.html#cb16-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">&#39;Surveylong&#39;</span>,<span class="st">&#39;Buffet_survey&#39;</span>,<span class="st">&#39;Surveyscales&#39;</span>)) <span class="co"># just the usesul and non-redundant stuff.</span></span>
<span id="cb16-5"><a href="data.html#cb16-5" aria-hidden="true" tabindex="-1"></a>rio<span class="sc">::</span><span class="fu">export</span>(Surveylong_buffet,<span class="at">file =</span> <span class="st">&#39;Surveylong_buffet.xlsx&#39;</span>) <span class="co"># export one data frame</span></span></code></pre></div>
</div>
<div id="ready-for-analysis" class="section level3 hasAnchor" number="2.1.8">
<h3><span class="header-section-number">2.1.8</span> Ready for analysis<a href="data.html#ready-for-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now you can simply load the data directly, and do not need to do the import-setup every time you want to do an analysis on the data.</p>
<p>This part is not a part of the data import, but it is a good idea just to check that the data indeed is setup as expected.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="data.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&#39;iBuffetSurveyData.RData&#39;</span>) </span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="libraries.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mortenarendt/dataanalyssisconsumerscience/edit/master/00_Data.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/mortenarendt/dataanalyssisconsumerscience/blob/master/00_Data.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
