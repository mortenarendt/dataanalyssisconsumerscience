<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Check All That Applies (CATA) | Data Analysis in R for Consumer Science</title>
  <meta name="description" content="Chapter 11 Check All That Applies (CATA) | Data Analysis in R for Consumer Science" />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Check All That Applies (CATA) | Data Analysis in R for Consumer Science" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Check All That Applies (CATA) | Data Analysis in R for Consumer Science" />
  
  
  

<meta name="author" content="Morten Arendt Rasmussens" />


<meta name="date" content="2022-09-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="latent-factor-models.html"/>
<link rel="next" href="projective-mapping.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Analysis in R for Consumer Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="introduction-to-pca.html"><a href="introduction-to-pca.html"><i class="fa fa-check"></i><b>2</b> Introduction to PCA</a></li>
<li class="chapter" data-level="3" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>3</b> Introduction to R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#how-to-import-data"><i class="fa fa-check"></i><b>3.1</b> How to import data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="introduction-to-r.html"><a href="introduction-to-r.html#importing-a-csv-file"><i class="fa fa-check"></i><b>3.1.1</b> Importing a csv file</a></li>
<li class="chapter" data-level="3.1.2" data-path="introduction-to-r.html"><a href="introduction-to-r.html#importing-an-excel-filesheet"><i class="fa fa-check"></i><b>3.1.2</b> Importing an Excel file/sheet</a></li>
<li class="chapter" data-level="3.1.3" data-path="introduction-to-r.html"><a href="introduction-to-r.html#looking-at-the-imported-elements"><i class="fa fa-check"></i><b>3.1.3</b> Looking at the imported elements</a></li>
<li class="chapter" data-level="3.1.4" data-path="introduction-to-r.html"><a href="introduction-to-r.html#save-the-data"><i class="fa fa-check"></i><b>3.1.4</b> Save the data</a></li>
<li class="chapter" data-level="3.1.5" data-path="introduction-to-r.html"><a href="introduction-to-r.html#ready-for-analysis"><i class="fa fa-check"></i><b>3.1.5</b> Ready for analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="how-to-import-your-data.html"><a href="how-to-import-your-data.html"><i class="fa fa-check"></i><b>4</b> How to import your data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="how-to-import-your-data.html"><a href="how-to-import-your-data.html#ibuffet-data---read-in-data-from-excel"><i class="fa fa-check"></i><b>4.1</b> iBuffet data - Read in data from Excel</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="how-to-import-your-data.html"><a href="how-to-import-your-data.html#example-of-survey-data"><i class="fa fa-check"></i><b>4.1.1</b> Example of Survey data</a></li>
<li class="chapter" data-level="4.1.2" data-path="how-to-import-your-data.html"><a href="how-to-import-your-data.html#example-of-survey-scale"><i class="fa fa-check"></i><b>4.1.2</b> Example of Survey Scale</a></li>
<li class="chapter" data-level="4.1.3" data-path="how-to-import-your-data.html"><a href="how-to-import-your-data.html#edit-your-dataset-in-excel"><i class="fa fa-check"></i><b>4.1.3</b> Edit your dataset in Excel</a></li>
<li class="chapter" data-level="4.1.4" data-path="how-to-import-your-data.html"><a href="how-to-import-your-data.html#importing-to-r"><i class="fa fa-check"></i><b>4.1.4</b> Importing to R</a></li>
<li class="chapter" data-level="4.1.5" data-path="how-to-import-your-data.html"><a href="how-to-import-your-data.html#editing-in-r"><i class="fa fa-check"></i><b>4.1.5</b> Editing in R</a></li>
<li class="chapter" data-level="4.1.6" data-path="how-to-import-your-data.html"><a href="how-to-import-your-data.html#merging-the-data"><i class="fa fa-check"></i><b>4.1.6</b> Merging the data</a></li>
<li class="chapter" data-level="4.1.7" data-path="how-to-import-your-data.html"><a href="how-to-import-your-data.html#save-the-data-1"><i class="fa fa-check"></i><b>4.1.7</b> Save the data</a></li>
<li class="chapter" data-level="4.1.8" data-path="how-to-import-your-data.html"><a href="how-to-import-your-data.html#ready-for-analysis-1"><i class="fa fa-check"></i><b>4.1.8</b> Ready for analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="libraries.html"><a href="libraries.html"><i class="fa fa-check"></i><b>5</b> Libraries</a></li>
<li class="chapter" data-level="6" data-path="descriptive-statistics-and-plotting.html"><a href="descriptive-statistics-and-plotting.html"><i class="fa fa-check"></i><b>6</b> Descriptive statistics and plotting</a>
<ul>
<li class="chapter" data-level="6.1" data-path="descriptive-statistics-and-plotting.html"><a href="descriptive-statistics-and-plotting.html#distributions-of-count-data"><i class="fa fa-check"></i><b>6.1</b> Distributions of count data</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="descriptive-statistics-and-plotting.html"><a href="descriptive-statistics-and-plotting.html#descriptives-for-a-continouos-variable"><i class="fa fa-check"></i><b>6.1.1</b> Descriptives for a continouos variable</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="descriptive-statistics-and-plotting.html"><a href="descriptive-statistics-and-plotting.html#scatter-plots"><i class="fa fa-check"></i><b>6.2</b> Scatter plots</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="pca-on-survey-answers.html"><a href="pca-on-survey-answers.html"><i class="fa fa-check"></i><b>7</b> PCA on survey answers</a>
<ul>
<li class="chapter" data-level="7.1" data-path="pca-on-survey-answers.html"><a href="pca-on-survey-answers.html#bi-plot"><i class="fa fa-check"></i><b>7.1</b> Bi-plot</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="pca-on-survey-answers.html"><a href="pca-on-survey-answers.html#extract-the-components-and-run-all-associations."><i class="fa fa-check"></i><b>7.1.1</b> Extract the components and run all associations.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>8</b> Linear models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="linear-models.html"><a href="linear-models.html#example"><i class="fa fa-check"></i><b>8.1</b> Example</a></li>
<li class="chapter" data-level="8.2" data-path="linear-models.html"><a href="linear-models.html#run-a-bunch-of-models-at-once"><i class="fa fa-check"></i><b>8.2</b> Run a bunch of models at once</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="linear-models.html"><a href="linear-models.html#a-plot"><i class="fa fa-check"></i><b>8.2.1</b> A plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mixed-models.html"><a href="mixed-models.html"><i class="fa fa-check"></i><b>9</b> Mixed models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="mixed-models.html"><a href="mixed-models.html#with-several-variables"><i class="fa fa-check"></i><b>9.1</b> With several variables</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="latent-factor-models.html"><a href="latent-factor-models.html"><i class="fa fa-check"></i><b>10</b> Latent Factor Models</a></li>
<li class="chapter" data-level="11" data-path="check-all-that-applies-cata.html"><a href="check-all-that-applies-cata.html"><i class="fa fa-check"></i><b>11</b> Check All That Applies (CATA)</a>
<ul>
<li class="chapter" data-level="11.1" data-path="check-all-that-applies-cata.html"><a href="check-all-that-applies-cata.html#an-example-from-beer-profiling"><i class="fa fa-check"></i><b>11.1</b> An example from Beer profiling</a></li>
<li class="chapter" data-level="11.2" data-path="check-all-that-applies-cata.html"><a href="check-all-that-applies-cata.html#two-versions-of-the-data"><i class="fa fa-check"></i><b>11.2</b> Two versions of the data</a></li>
<li class="chapter" data-level="11.3" data-path="check-all-that-applies-cata.html"><a href="check-all-that-applies-cata.html#pca"><i class="fa fa-check"></i><b>11.3</b> PCA</a></li>
<li class="chapter" data-level="11.4" data-path="check-all-that-applies-cata.html"><a href="check-all-that-applies-cata.html#cochranes-q-test"><i class="fa fa-check"></i><b>11.4</b> Cochranes Q-test</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="check-all-that-applies-cata.html"><a href="check-all-that-applies-cata.html#post-hoc-contrasts"><i class="fa fa-check"></i><b>11.4.1</b> Post hoc contrasts</a></li>
<li class="chapter" data-level="11.4.2" data-path="check-all-that-applies-cata.html"><a href="check-all-that-applies-cata.html#for-all-attributes"><i class="fa fa-check"></i><b>11.4.2</b> For all Attributes</a></li>
<li class="chapter" data-level="11.4.3" data-path="check-all-that-applies-cata.html"><a href="check-all-that-applies-cata.html#plsda"><i class="fa fa-check"></i><b>11.4.3</b> PLSDA</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="check-all-that-applies-cata.html"><a href="check-all-that-applies-cata.html#exerecise"><i class="fa fa-check"></i><b>11.5</b> Exerecise</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="check-all-that-applies-cata.html"><a href="check-all-that-applies-cata.html#exercise-1-pca-on-consumer-background"><i class="fa fa-check"></i><b>11.5.1</b> Exercise 1: PCA on consumer background</a></li>
<li class="chapter" data-level="11.5.2" data-path="check-all-that-applies-cata.html"><a href="check-all-that-applies-cata.html#exercise-2-pca-on-cata-counts"><i class="fa fa-check"></i><b>11.5.2</b> Exercise 2: PCA on CATA counts</a></li>
<li class="chapter" data-level="11.5.3" data-path="check-all-that-applies-cata.html"><a href="check-all-that-applies-cata.html#exercise-3-pca-on-liking"><i class="fa fa-check"></i><b>11.5.3</b> Exercise 3: PCA on liking</a></li>
<li class="chapter" data-level="11.5.4" data-path="check-all-that-applies-cata.html"><a href="check-all-that-applies-cata.html#exercise-4-pls-on-cata-counts-and-liking"><i class="fa fa-check"></i><b>11.5.4</b> Exercise 4: PLS on CATA counts and liking</a></li>
<li class="chapter" data-level="11.5.5" data-path="check-all-that-applies-cata.html"><a href="check-all-that-applies-cata.html#exercise-5-mixed-modelling-on-the-liking"><i class="fa fa-check"></i><b>11.5.5</b> Exercise 5: Mixed modelling on the liking</a></li>
<li class="chapter" data-level="11.5.6" data-path="check-all-that-applies-cata.html"><a href="check-all-that-applies-cata.html#exercise-6-comparing-cata-binary-data-and-counts"><i class="fa fa-check"></i><b>11.5.6</b> Exercise 6: Comparing CATA binary data and counts</a></li>
<li class="chapter" data-level="11.5.7" data-path="check-all-that-applies-cata.html"><a href="check-all-that-applies-cata.html#exercise-7-cochrans-q-test-on-cata-binary-data"><i class="fa fa-check"></i><b>11.5.7</b> Exercise 7: Cochran’s Q test on CATA binary data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="projective-mapping.html"><a href="projective-mapping.html"><i class="fa fa-check"></i><b>12</b> Projective mapping</a>
<ul>
<li class="chapter" data-level="12.1" data-path="projective-mapping.html"><a href="projective-mapping.html#example-from-mapping-of-xx"><i class="fa fa-check"></i><b>12.1</b> Example from mapping of XX</a></li>
<li class="chapter" data-level="12.2" data-path="projective-mapping.html"><a href="projective-mapping.html#a-collated-version-of-the-data"><i class="fa fa-check"></i><b>12.2</b> A Collated version of the data</a></li>
<li class="chapter" data-level="12.3" data-path="projective-mapping.html"><a href="projective-mapping.html#pca-on-collated-data"><i class="fa fa-check"></i><b>12.3</b> PCA on Collated data</a></li>
<li class="chapter" data-level="12.4" data-path="projective-mapping.html"><a href="projective-mapping.html#section"><i class="fa fa-check"></i><b>12.4</b> </a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="preference-mapping.html"><a href="preference-mapping.html"><i class="fa fa-check"></i><b>13</b> Preference Mapping</a>
<ul>
<li class="chapter" data-level="13.1" data-path="preference-mapping.html"><a href="preference-mapping.html#example-of-preference-mapping"><i class="fa fa-check"></i><b>13.1</b> Example of Preference Mapping</a></li>
<li class="chapter" data-level="13.2" data-path="preference-mapping.html"><a href="preference-mapping.html#pca-1"><i class="fa fa-check"></i><b>13.2</b> PCA</a></li>
<li class="chapter" data-level="13.3" data-path="preference-mapping.html"><a href="preference-mapping.html#analysis-by-pls"><i class="fa fa-check"></i><b>13.3</b> Analysis by PLS</a></li>
<li class="chapter" data-level="13.4" data-path="preference-mapping.html"><a href="preference-mapping.html#l-pls-for-the-future"><i class="fa fa-check"></i><b>13.4</b> L-PLS [For the future…]</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="lpls.html"><a href="lpls.html"><i class="fa fa-check"></i><b>14</b> LPLS</a></li>
<li class="chapter" data-level="15" data-path="consumer-segmentation.html"><a href="consumer-segmentation.html"><i class="fa fa-check"></i><b>15</b> Consumer Segmentation</a>
<ul>
<li class="chapter" data-level="15.1" data-path="consumer-segmentation.html"><a href="consumer-segmentation.html#kmeans"><i class="fa fa-check"></i><b>15.1</b> Kmeans</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="more-pca.html"><a href="more-pca.html"><i class="fa fa-check"></i><b>16</b> More PCA</a></li>
<li class="chapter" data-level="17" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>17</b> Logistic Regression</a></li>
<li class="chapter" data-level="18" data-path="confirmatory-factor-analysis-using-lavaan.html"><a href="confirmatory-factor-analysis-using-lavaan.html"><i class="fa fa-check"></i><b>18</b> Confirmatory Factor Analysis using lavaan</a>
<ul>
<li class="chapter" data-level="18.1" data-path="confirmatory-factor-analysis-using-lavaan.html"><a href="confirmatory-factor-analysis-using-lavaan.html#example---food-neophobia"><i class="fa fa-check"></i><b>18.1</b> Example - Food Neophobia</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="structured-equation-modelling.html"><a href="structured-equation-modelling.html"><i class="fa fa-check"></i><b>19</b> Structured Equation Modelling</a>
<ul>
<li class="chapter" data-level="19.1" data-path="structured-equation-modelling.html"><a href="structured-equation-modelling.html#example---theory-of-planned-behaviour"><i class="fa fa-check"></i><b>19.1</b> Example - Theory of Planned Behaviour</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis in R for Consumer Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="check-all-that-applies-cata" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">Chapter 11</span> Check All That Applies (CATA)<a href="check-all-that-applies-cata.html#check-all-that-applies-cata" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Check All That Apply (CATA) data is in its raw form binary indicating whether a judge finds a product to have the attribute (1) or not (0).</p>
<p>Usually, such data is organized in a matrix where each row corresponds to the evaluation of one product by one judge. And the coloumns are then the attributes.</p>
<p>Say you for instance have 26 judges/consummers and 4 products, and further that all products are evaluated by all judges once on 13 attributes. Your data matrix would then have 104 rows and 13 coloums (with responses) and additionally coloumns indicating judge, product, record id, date, etc.</p>
<div id="an-example-from-beer-profiling" class="section level2 hasAnchor" number="11.1">
<h2><span class="header-section-number">11.1</span> An example from Beer profiling<a href="check-all-that-applies-cata.html#an-example-from-beer-profiling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Six different commercial beers from Danish craft brewers, evaluated by <span class="math inline">\(160\)</span> consumers on a range of different questions:</p>
<ul>
<li>Background information: a range of questions, including appropriateness ratings for 27 sensory descriptors on a 7-points scale (e.g. <em>how appropriate do you think it is for a beer to be bitter?</em>). The two semantic anchors were <em>1 = not at all appropriate</em> and <em>7 = extremely appropriate</em>. This dataset is called <em>beercata</em>.</li>
<li>Hedonics: Their liking/hedonic responses of the beer on a 7-point Likert scale (1-7). This dataset is called <em>beerliking</em>.</li>
</ul>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="check-all-that-applies-cata.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data4consumerscience)</span>
<span id="cb114-2"><a href="check-all-that-applies-cata.html#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb114-3"><a href="check-all-that-applies-cata.html#cb114-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-4"><a href="check-all-that-applies-cata.html#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;beercata&quot;</span>)</span>
<span id="cb114-5"><a href="check-all-that-applies-cata.html#cb114-5" aria-hidden="true" tabindex="-1"></a>beercata <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##   Consumer.ID      Beer S_Flowers S_Beans S_Intense berries S_Caramel S_Nuts S_Savoury spices
## 1         a01 Wheat IPA         0       0                 0         0      1                0
## 2         a02 Wheat IPA         0       0                 0         0      0                0
## 3         a03 Wheat IPA         0       0                 0         0      0                0
## 4         a04 Wheat IPA         0       1                 0         0      0                1
## 5         a05 Wheat IPA         0       0                 0         0      0                0
## 6         a06 Wheat IPA         0       0                 0         0      0                0
##   S_Dessert spices S_Regional spices S_Herbs S_Citrus fruit S_Berries S_Fruit S_Dried fruit S_Liquor
## 1                0                 0       1              0         0       0             0        0
## 2                0                 1       0              0         0       0             0        0
## 3                0                 0       0              0         1       0             0        0
## 4                0                 0       0              0         0       0             0        0
## 5                0                 0       0              1         0       0             0        0
## 6                0                 0       1              0         0       0             1        0
##   S_Bitter S_Sparkling S_Refreshing S_Fruity S_Aromatic S_Pungent S_Still S_Smoked S_Foamy S_Sour S_Sweet
## 1        1           0            0        0          1         1       0        0       0      0       0
## 2        0           0            0        0          0         0       0        0       0      1       0
## 3        1           0            0        0          0         0       0        1       1      0       0
## 4        1           0            1        0          0         0       0        0       0      0       0
## 5        1           0            1        0          0         0       0        0       0      0       0
## 6        1           1            0        0          0         0       0        1       0      0       0
##   S_Warming S_Vinous
## 1         0        0
## 2         0        0
## 3         0        0
## 4         0        0
## 5         0        0
## 6         0        0</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="check-all-that-applies-cata.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(beercata<span class="sc">$</span>Beer) </span></code></pre></div>
<pre><code>## 
##     Brown Ale      NY Lager    Porse Bock Ravnsborg Red    River Beer     Wheat IPA 
##           160           160           160           160           160           160</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="check-all-that-applies-cata.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(beercata<span class="sc">$</span>Consumer.ID))</span></code></pre></div>
<pre><code>## [1] 160</code></pre>
</div>
<div id="two-versions-of-the-data" class="section level2 hasAnchor" number="11.2">
<h2><span class="header-section-number">11.2</span> Two versions of the data<a href="check-all-that-applies-cata.html#two-versions-of-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>RAW data with each row being responses from one evaluation</li>
<li>Agglomerated to counts, with each row being one product</li>
</ul>
<p>[Put in the pictures from Rinnan et al 2015]</p>
<p>The agglomerated version is computed by:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="check-all-that-applies-cata.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Questions we want answer using these data</span></span>
<span id="cb120-2"><a href="check-all-that-applies-cata.html#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="co"># - Are the products different / similar? </span></span>
<span id="cb120-3"><a href="check-all-that-applies-cata.html#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># - Which attributes drives discrimination? </span></span>
<span id="cb120-4"><a href="check-all-that-applies-cata.html#cb120-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># - Are there any judges who are really of? </span></span>
<span id="cb120-5"><a href="check-all-that-applies-cata.html#cb120-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb120-6"><a href="check-all-that-applies-cata.html#cb120-6" aria-hidden="true" tabindex="-1"></a>beercatasum <span class="ot">&lt;-</span> beercata <span class="sc">%&gt;%</span> </span>
<span id="cb120-7"><a href="check-all-that-applies-cata.html#cb120-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(attrib, val, S_Flowers<span class="sc">:</span>S_Vinous) <span class="sc">%&gt;%</span> </span>
<span id="cb120-8"><a href="check-all-that-applies-cata.html#cb120-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Beer,attrib) <span class="sc">%&gt;%</span></span>
<span id="cb120-9"><a href="check-all-that-applies-cata.html#cb120-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">sum</span>(val)) <span class="sc">%&gt;%</span> </span>
<span id="cb120-10"><a href="check-all-that-applies-cata.html#cb120-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(attrib,n)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;Beer&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="check-all-that-applies-cata.html#cb122-1" aria-hidden="true" tabindex="-1"></a>beercatasum</span></code></pre></div>
<pre><code>## # A tibble: 6 × 28
## # Groups:   Beer [6]
##   Beer       S_Aro…¹ S_Beans S_Ber…² S_Bit…³ S_Car…⁴ S_Cit…⁵ S_Des…⁶ S_Dri…⁷ S_Flo…⁸ S_Foamy S_Fruit S_Fru…⁹
##   &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1 Brown Ale       57      54       6      63      52      10      13      21       4      27      11      22
## 2 NY Lager        37      10       5      69      16      30      20       6      46      27      15      45
## 3 Porse Bock      20       2       5      67       7      34      16       6      27      26       8      22
## 4 Ravnsborg…      52      25       6      71      35      11      19      14      17      16      11      26
## 5 River Beer      22      12       4      65       3      29       8       4      22      30      18      24
## 6 Wheat IPA       29       9       9      57       9      30      24       6      45      26      21      43
## # … with 15 more variables: S_Herbs &lt;dbl&gt;, `S_Intense berries` &lt;dbl&gt;, S_Liquor &lt;dbl&gt;, S_Nuts &lt;dbl&gt;,
## #   S_Pungent &lt;dbl&gt;, S_Refreshing &lt;dbl&gt;, `S_Regional spices` &lt;dbl&gt;, `S_Savoury spices` &lt;dbl&gt;,
## #   S_Smoked &lt;dbl&gt;, S_Sour &lt;dbl&gt;, S_Sparkling &lt;dbl&gt;, S_Still &lt;dbl&gt;, S_Sweet &lt;dbl&gt;, S_Vinous &lt;dbl&gt;,
## #   S_Warming &lt;dbl&gt;, and abbreviated variable names ¹​S_Aromatic, ²​S_Berries, ³​S_Bitter, ⁴​S_Caramel,
## #   ⁵​`S_Citrus fruit`, ⁶​`S_Dessert spices`, ⁷​`S_Dried fruit`, ⁸​S_Flowers, ⁹​S_Fruity</code></pre>
<p>… and visualized by for instance a barplot.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="check-all-that-applies-cata.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary counts over attrobite</span></span>
<span id="cb124-2"><a href="check-all-that-applies-cata.html#cb124-2" aria-hidden="true" tabindex="-1"></a>beercatasum <span class="sc">%&gt;%</span> </span>
<span id="cb124-3"><a href="check-all-that-applies-cata.html#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(attrib, n, S_Flowers<span class="sc">:</span>S_Vinous) <span class="sc">%&gt;%</span> </span>
<span id="cb124-4"><a href="check-all-that-applies-cata.html#cb124-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> ., <span class="fu">aes</span>(attrib,n, <span class="at">fill =</span> Beer)) <span class="sc">+</span> </span>
<span id="cb124-5"><a href="check-all-that-applies-cata.html#cb124-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;identity&#39;</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span> </span>
<span id="cb124-6"><a href="check-all-that-applies-cata.html#cb124-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
</div>
<div id="pca" class="section level2 hasAnchor" number="11.3">
<h2><span class="header-section-number">11.3</span> PCA<a href="check-all-that-applies-cata.html#pca" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A PCA on the agglomerated counts, reveal the attributes associated with the individual products:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="check-all-that-applies-cata.html#cb125-1" aria-hidden="true" tabindex="-1"></a>mdlPCA <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(beercatasum[,<span class="sc">-</span><span class="dv">1</span>], <span class="at">scale. =</span> T)</span>
<span id="cb125-2"><a href="check-all-that-applies-cata.html#cb125-2" aria-hidden="true" tabindex="-1"></a>ggbiplot<span class="sc">::</span><span class="fu">ggbiplot</span>(mdlPCA, <span class="at">labels =</span> beercatasum<span class="sc">$</span>Beer)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
<p>The attributes Bean, Caramel, Warming, Aromatic etc is associated to the beer <em>Brown ale</em>, while Berrie, Dessert, Pungent, etc. is characteristic of <em>Wheat IPA</em> [Maybe add some more narrative]</p>
</div>
<div id="cochranes-q-test" class="section level2 hasAnchor" number="11.4">
<h2><span class="header-section-number">11.4</span> Cochranes Q-test<a href="check-all-that-applies-cata.html#cochranes-q-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Cochranes Q-test is a statistical test for the comparison of several products, where the response is binary, and there is repeated responses across several judges. We need a package (<em>RVAideeeeMemoire</em>).</p>
<p>For one response variable: <em>S_Flowers</em></p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="check-all-that-applies-cata.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RVAideMemoire)</span></code></pre></div>
<pre><code>## *** Package RVAideMemoire v 0.9-81-2 ***</code></pre>
<pre><code>## 
## Attaching package: &#39;RVAideMemoire&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lme4&#39;:
## 
##     dummy</code></pre>
<pre><code>## The following object is masked from &#39;package:broom&#39;:
## 
##     bootstrap</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="check-all-that-applies-cata.html#cb131-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">cochran.qtest</span>(S_Flowers <span class="sc">~</span> Beer <span class="sc">|</span> Consumer.ID,</span>
<span id="cb131-2"><a href="check-all-that-applies-cata.html#cb131-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> beercata)</span>
<span id="cb131-3"><a href="check-all-that-applies-cata.html#cb131-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-4"><a href="check-all-that-applies-cata.html#cb131-4" aria-hidden="true" tabindex="-1"></a>m</span></code></pre></div>
<pre><code>## 
##  Cochran&#39;s Q test
## 
## data:  S_Flowers by Beer, block = Consumer.ID 
## Q = 63.252, df = 5, p-value = 2.581e-12
## alternative hypothesis: true difference in probabilities is not equal to 0 
## sample estimates:
## proba in group             &lt;NA&gt;            &lt;NA&gt;            &lt;NA&gt;            &lt;NA&gt;            &lt;NA&gt; 
##         0.02500         0.28750         0.16875         0.10625         0.13750         0.28125</code></pre>
<p>The p.value is strongly significant, indicating that we cannot assumme the same level of S_Flower in all beers. I.e. the beers seems different based on this characteristics. This is in agreement with the barplot above, where S_Flower is high in NY Lager and really low for Brown ale.</p>
<div id="post-hoc-contrasts" class="section level3 hasAnchor" number="11.4.1">
<h3><span class="header-section-number">11.4.1</span> Post hoc contrasts<a href="check-all-that-applies-cata.html#post-hoc-contrasts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As we observe differences based on this attribute, we pursue the question on which products sticks out? And are there products which are similar? This is done by pairwise comparisons:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="check-all-that-applies-cata.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rcompanion)</span>
<span id="cb133-2"><a href="check-all-that-applies-cata.html#cb133-2" aria-hidden="true" tabindex="-1"></a>PT <span class="ot">=</span> <span class="fu">pairwiseMcnemar</span>(S_Flowers <span class="sc">~</span> Beer <span class="sc">|</span> Consumer.ID,</span>
<span id="cb133-3"><a href="check-all-that-applies-cata.html#cb133-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data   =</span> beercata,</span>
<span id="cb133-4"><a href="check-all-that-applies-cata.html#cb133-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">test   =</span> <span class="st">&quot;permutation&quot;</span>,</span>
<span id="cb133-5"><a href="check-all-that-applies-cata.html#cb133-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">method =</span> <span class="st">&quot;fdr&quot;</span>,</span>
<span id="cb133-6"><a href="check-all-that-applies-cata.html#cb133-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb133-7"><a href="check-all-that-applies-cata.html#cb133-7" aria-hidden="true" tabindex="-1"></a>PT<span class="sc">$</span>Pairwise <span class="sc">%&gt;%</span> </span>
<span id="cb133-8"><a href="check-all-that-applies-cata.html#cb133-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span><span class="fu">abs</span>(<span class="fu">as.numeric</span>(Z))) <span class="sc">%&gt;%</span> </span>
<span id="cb133-9"><a href="check-all-that-applies-cata.html#cb133-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>()</span></code></pre></div>
<pre><code>##                        Comparison      Z  p.value p.adjust
## 1        Brown Ale - NY Lager = 0  -6.48 9.13e-11 1.37e-09
## 2       Brown Ale - Wheat IPA = 0  -5.86 4.71e-09 3.53e-08
## 3      Brown Ale - Porse Bock = 0  -4.27 1.95e-05 9.75e-05
## 4    NY Lager - Ravnsborg Red = 0   4.14 3.43e-05 1.29e-04
## 5   Ravnsborg Red - Wheat IPA = 0  -3.96  7.5e-05 2.25e-04
## 6       NY Lager - River Beer = 0   3.54 0.000402 8.48e-04
## 7      Brown Ale - River Beer = 0  -3.53 0.000415 8.48e-04
## 8      River Beer - Wheat IPA = 0  -3.51 0.000452 8.48e-04
## 9   Brown Ale - Ravnsborg Red = 0  -2.98  0.00286 4.77e-03
## 10      NY Lager - Porse Bock = 0   2.52   0.0118 1.77e-02
## 11     Porse Bock - Wheat IPA = 0  -2.36   0.0181 2.47e-02
## 12 Porse Bock - Ravnsborg Red = 0   1.54    0.123 1.54e-01
## 13    Porse Bock - River Beer = 0  0.845    0.398 4.26e-01
## 14 Ravnsborg Red - River Beer = 0 -0.845    0.398 4.26e-01
## 15       NY Lager - Wheat IPA = 0  0.135    0.893 8.93e-01</code></pre>
<p>The table is sorted with the most different pairs at the top, and the least different at the bottom. Hence most products are different, while <em>Porse Bock</em> and <em>Ravnsborg Red</em> are fairly alike.</p>
</div>
<div id="for-all-attributes" class="section level3 hasAnchor" number="11.4.2">
<h3><span class="header-section-number">11.4.2</span> For all Attributes<a href="check-all-that-applies-cata.html#for-all-attributes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We use tidyverse and broom for this, but need a function capable of handling Cochranes Q-test outputs.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="check-all-that-applies-cata.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb135-2"><a href="check-all-that-applies-cata.html#cb135-2" aria-hidden="true" tabindex="-1"></a>tidy.RVtest <span class="ot">&lt;-</span> <span class="cf">function</span>(m){</span>
<span id="cb135-3"><a href="check-all-that-applies-cata.html#cb135-3" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">statistic =</span> m<span class="sc">$</span>statistic,<span class="at">df =</span> m<span class="sc">$</span>parameter,</span>
<span id="cb135-4"><a href="check-all-that-applies-cata.html#cb135-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">p.value=</span> m<span class="sc">$</span>p.value,</span>
<span id="cb135-5"><a href="check-all-that-applies-cata.html#cb135-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">method =</span> m<span class="sc">$</span>method.test)</span>
<span id="cb135-6"><a href="check-all-that-applies-cata.html#cb135-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r)</span>
<span id="cb135-7"><a href="check-all-that-applies-cata.html#cb135-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb135-8"><a href="check-all-that-applies-cata.html#cb135-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-9"><a href="check-all-that-applies-cata.html#cb135-9" aria-hidden="true" tabindex="-1"></a>tb_cochran <span class="ot">&lt;-</span> beercata <span class="sc">%&gt;%</span> </span>
<span id="cb135-10"><a href="check-all-that-applies-cata.html#cb135-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(attrib, val, S_Flowers<span class="sc">:</span>S_Vinous) <span class="sc">%&gt;%</span> </span>
<span id="cb135-11"><a href="check-all-that-applies-cata.html#cb135-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(attrib) <span class="sc">%&gt;%</span></span>
<span id="cb135-12"><a href="check-all-that-applies-cata.html#cb135-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do</span>(<span class="fu">cochran.qtest</span>(val <span class="sc">~</span> Beer <span class="sc">|</span> Consumer.ID,</span>
<span id="cb135-13"><a href="check-all-that-applies-cata.html#cb135-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> .) <span class="sc">%&gt;%</span> tidy)</span>
<span id="cb135-14"><a href="check-all-that-applies-cata.html#cb135-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-15"><a href="check-all-that-applies-cata.html#cb135-15" aria-hidden="true" tabindex="-1"></a>tb_cochran <span class="sc">%&gt;%</span> </span>
<span id="cb135-16"><a href="check-all-that-applies-cata.html#cb135-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(p.value) </span></code></pre></div>
<pre><code>## # A tibble: 27 × 5
## # Groups:   attrib [27]
##    attrib         statistic    df  p.value method          
##    &lt;chr&gt;              &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;           
##  1 S_Beans            114.      5 7.19e-23 Cochran&#39;s Q test
##  2 S_Caramel          108.      5 1.08e-21 Cochran&#39;s Q test
##  3 S_Flowers           63.3     5 2.58e-12 Cochran&#39;s Q test
##  4 S_Aromatic          45.8     5 9.90e- 9 Cochran&#39;s Q test
##  5 S_Sweet             36.3     5 8.24e- 7 Cochran&#39;s Q test
##  6 S_Warming           35.9     5 1.01e- 6 Cochran&#39;s Q test
##  7 S_Smoked            33.9     5 2.47e- 6 Cochran&#39;s Q test
##  8 S_Liquor            33.9     5 2.55e- 6 Cochran&#39;s Q test
##  9 S_Citrus fruit      29.4     5 1.96e- 5 Cochran&#39;s Q test
## 10 S_Dried fruit       26.0     5 8.81e- 5 Cochran&#39;s Q test
## # … with 17 more rows</code></pre>
<p>This output indicates that <em>S_Beans</em> is the most discriminatory attribute, while <em>S_Pungent</em> is the least.</p>
</div>
<div id="plsda" class="section level3 hasAnchor" number="11.4.3">
<h3><span class="header-section-number">11.4.3</span> PLSDA<a href="check-all-that-applies-cata.html#plsda" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This needs more love.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="check-all-that-applies-cata.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code></pre></div>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## 
## Attaching package: &#39;caret&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     lift</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="check-all-that-applies-cata.html#cb141-1" aria-hidden="true" tabindex="-1"></a>mdl <span class="ot">&lt;-</span> <span class="fu">plsda</span>(<span class="fu">data.frame</span>(beercata[,<span class="dv">3</span><span class="sc">:</span><span class="dv">29</span>]),<span class="fu">factor</span>(beercata<span class="sc">$</span>Beer),<span class="at">ncomp =</span> <span class="dv">3</span>)</span>
<span id="cb141-2"><a href="check-all-that-applies-cata.html#cb141-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-3"><a href="check-all-that-applies-cata.html#cb141-3" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> mdl<span class="sc">$</span>scores <span class="sc">%&gt;%</span> </span>
<span id="cb141-4"><a href="check-all-that-applies-cata.html#cb141-4" aria-hidden="true" tabindex="-1"></a>  unclass <span class="sc">%&gt;%</span> </span>
<span id="cb141-5"><a href="check-all-that-applies-cata.html#cb141-5" aria-hidden="true" tabindex="-1"></a>  as.data.frame <span class="sc">%&gt;%</span> </span>
<span id="cb141-6"><a href="check-all-that-applies-cata.html#cb141-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(beercata)</span>
<span id="cb141-7"><a href="check-all-that-applies-cata.html#cb141-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-8"><a href="check-all-that-applies-cata.html#cb141-8" aria-hidden="true" tabindex="-1"></a>loadings <span class="ot">&lt;-</span> mdl<span class="sc">$</span>loadings <span class="sc">%&gt;%</span> </span>
<span id="cb141-9"><a href="check-all-that-applies-cata.html#cb141-9" aria-hidden="true" tabindex="-1"></a>  unclass <span class="sc">%&gt;%</span> </span>
<span id="cb141-10"><a href="check-all-that-applies-cata.html#cb141-10" aria-hidden="true" tabindex="-1"></a>  as.data.frame <span class="sc">%&gt;%</span> </span>
<span id="cb141-11"><a href="check-all-that-applies-cata.html#cb141-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">&#39;attrib&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb141-12"><a href="check-all-that-applies-cata.html#cb141-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">attrib2 =</span> <span class="fu">substr</span>(attrib,<span class="dv">3</span>,<span class="dv">50</span>)) <span class="co"># lets remove the S_</span></span>
<span id="cb141-13"><a href="check-all-that-applies-cata.html#cb141-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-14"><a href="check-all-that-applies-cata.html#cb141-14" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> loadings, <span class="fu">aes</span>(<span class="st">`</span><span class="at">Comp 1</span><span class="st">`</span>, <span class="st">`</span><span class="at">Comp 2</span><span class="st">`</span>, <span class="at">label =</span> attrib2)) <span class="sc">+</span> </span>
<span id="cb141-15"><a href="check-all-that-applies-cata.html#cb141-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_point() + </span></span>
<span id="cb141-16"><a href="check-all-that-applies-cata.html#cb141-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>()</span>
<span id="cb141-17"><a href="check-all-that-applies-cata.html#cb141-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-18"><a href="check-all-that-applies-cata.html#cb141-18" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> scores, <span class="fu">aes</span>(<span class="st">`</span><span class="at">Comp 1</span><span class="st">`</span>, <span class="st">`</span><span class="at">Comp 2</span><span class="st">`</span>, <span class="at">color =</span> Beer)) <span class="sc">+</span> </span>
<span id="cb141-19"><a href="check-all-that-applies-cata.html#cb141-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_point() + </span></span>
<span id="cb141-20"><a href="check-all-that-applies-cata.html#cb141-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="at">level =</span> <span class="fl">0.5</span>)</span>
<span id="cb141-21"><a href="check-all-that-applies-cata.html#cb141-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-22"><a href="check-all-that-applies-cata.html#cb141-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb141-23"><a href="check-all-that-applies-cata.html#cb141-23" aria-hidden="true" tabindex="-1"></a>g1 <span class="sc">+</span> g2</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="check-all-that-applies-cata.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># do multiple splithalfs</span></span>
<span id="cb142-2"><a href="check-all-that-applies-cata.html#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="co"># INPUT: judge id. CATA, class, ncomp</span></span>
<span id="cb142-3"><a href="check-all-that-applies-cata.html#cb142-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> beercata[,<span class="dv">3</span><span class="sc">:</span><span class="dv">29</span>]</span>
<span id="cb142-4"><a href="check-all-that-applies-cata.html#cb142-4" aria-hidden="true" tabindex="-1"></a>clss <span class="ot">&lt;-</span> <span class="fu">factor</span>(beercata<span class="sc">$</span>Beer)</span>
<span id="cb142-5"><a href="check-all-that-applies-cata.html#cb142-5" aria-hidden="true" tabindex="-1"></a>judge <span class="ot">&lt;-</span> beercata<span class="sc">$</span>Consumer.ID</span>
<span id="cb142-6"><a href="check-all-that-applies-cata.html#cb142-6" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb142-7"><a href="check-all-that-applies-cata.html#cb142-7" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb142-8"><a href="check-all-that-applies-cata.html#cb142-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-9"><a href="check-all-that-applies-cata.html#cb142-9" aria-hidden="true" tabindex="-1"></a>mdl0 <span class="ot">&lt;-</span> <span class="fu">plsda</span>(X,clss,<span class="at">ncomp =</span> k)</span>
<span id="cb142-10"><a href="check-all-that-applies-cata.html#cb142-10" aria-hidden="true" tabindex="-1"></a>lds0 <span class="ot">&lt;-</span> mdl0<span class="sc">$</span>loadings <span class="sc">%&gt;%</span> </span>
<span id="cb142-11"><a href="check-all-that-applies-cata.html#cb142-11" aria-hidden="true" tabindex="-1"></a>  unclass <span class="sc">%&gt;%</span> </span>
<span id="cb142-12"><a href="check-all-that-applies-cata.html#cb142-12" aria-hidden="true" tabindex="-1"></a>  as.data.frame <span class="sc">%&gt;%</span> </span>
<span id="cb142-13"><a href="check-all-that-applies-cata.html#cb142-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">&#39;attrib&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb142-14"><a href="check-all-that-applies-cata.html#cb142-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(cmp,val0,<span class="sc">-</span>attrib) </span>
<span id="cb142-15"><a href="check-all-that-applies-cata.html#cb142-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-16"><a href="check-all-that-applies-cata.html#cb142-16" aria-hidden="true" tabindex="-1"></a>unjudge <span class="ot">&lt;-</span> <span class="fu">unique</span>(judge)</span>
<span id="cb142-17"><a href="check-all-that-applies-cata.html#cb142-17" aria-hidden="true" tabindex="-1"></a>nindiv <span class="ot">&lt;-</span> <span class="fu">length</span>(unjudge)</span>
<span id="cb142-18"><a href="check-all-that-applies-cata.html#cb142-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-19"><a href="check-all-that-applies-cata.html#cb142-19" aria-hidden="true" tabindex="-1"></a>LOADS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb142-20"><a href="check-all-that-applies-cata.html#cb142-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>A){</span>
<span id="cb142-21"><a href="check-all-that-applies-cata.html#cb142-21" aria-hidden="true" tabindex="-1"></a>  ic <span class="ot">&lt;-</span> judge <span class="sc">%in%</span> <span class="fu">sample</span>(unjudge)[<span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(nindiv<span class="sc">/</span><span class="dv">2</span>)]</span>
<span id="cb142-22"><a href="check-all-that-applies-cata.html#cb142-22" aria-hidden="true" tabindex="-1"></a>  mdlSH <span class="ot">&lt;-</span> <span class="fu">plsda</span>(X[ic,],clss[ic],<span class="at">ncomp =</span> k)</span>
<span id="cb142-23"><a href="check-all-that-applies-cata.html#cb142-23" aria-hidden="true" tabindex="-1"></a>  df_flip <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">sng =</span> <span class="fu">sign</span>(<span class="fu">diag</span>(<span class="fu">t</span>(mdl0<span class="sc">$</span>loadings) <span class="sc">%*%</span> mdlSH<span class="sc">$</span>loadings))) <span class="sc">%&gt;%</span> </span>
<span id="cb142-24"><a href="check-all-that-applies-cata.html#cb142-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">&#39;cmp&#39;</span>)</span>
<span id="cb142-25"><a href="check-all-that-applies-cata.html#cb142-25" aria-hidden="true" tabindex="-1"></a>  lds <span class="ot">&lt;-</span> mdlSH<span class="sc">$</span>loadings <span class="sc">%&gt;%</span> </span>
<span id="cb142-26"><a href="check-all-that-applies-cata.html#cb142-26" aria-hidden="true" tabindex="-1"></a>    unclass <span class="sc">%&gt;%</span> </span>
<span id="cb142-27"><a href="check-all-that-applies-cata.html#cb142-27" aria-hidden="true" tabindex="-1"></a>    as.data.frame <span class="sc">%&gt;%</span> </span>
<span id="cb142-28"><a href="check-all-that-applies-cata.html#cb142-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="st">&#39;attrib&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb142-29"><a href="check-all-that-applies-cata.html#cb142-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">gather</span>(cmp,val,<span class="sc">-</span>attrib) <span class="sc">%&gt;%</span> </span>
<span id="cb142-30"><a href="check-all-that-applies-cata.html#cb142-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(df_flip, <span class="at">by =</span> <span class="st">&#39;cmp&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb142-31"><a href="check-all-that-applies-cata.html#cb142-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">SHiter =</span> i, </span>
<span id="cb142-32"><a href="check-all-that-applies-cata.html#cb142-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">val =</span> val<span class="sc">*</span>sng)  </span>
<span id="cb142-33"><a href="check-all-that-applies-cata.html#cb142-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb142-34"><a href="check-all-that-applies-cata.html#cb142-34" aria-hidden="true" tabindex="-1"></a>  LOADS <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(LOADS,lds)</span>
<span id="cb142-35"><a href="check-all-that-applies-cata.html#cb142-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb142-36"><a href="check-all-that-applies-cata.html#cb142-36" aria-hidden="true" tabindex="-1"></a>fc <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">/</span> A)<span class="sc">*</span>((A <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>A)</span>
<span id="cb142-37"><a href="check-all-that-applies-cata.html#cb142-37" aria-hidden="true" tabindex="-1"></a>sdloads <span class="ot">&lt;-</span> LOADS <span class="sc">%&gt;%</span> </span>
<span id="cb142-38"><a href="check-all-that-applies-cata.html#cb142-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(lds0, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;attrib&#39;</span>,<span class="st">&#39;cmp&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb142-39"><a href="check-all-that-applies-cata.html#cb142-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(attrib,cmp) <span class="sc">%&gt;%</span> </span>
<span id="cb142-40"><a href="check-all-that-applies-cata.html#cb142-40" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">sd =</span> <span class="fu">sum</span>((val<span class="sc">-</span>val0)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span>fc) <span class="sc">%&gt;%</span> </span>
<span id="cb142-41"><a href="check-all-that-applies-cata.html#cb142-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cmp =</span> <span class="fu">paste</span>(<span class="st">&#39;sd&#39;</span>,cmp,<span class="at">sep =</span> <span class="st">&#39;&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb142-42"><a href="check-all-that-applies-cata.html#cb142-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(cmp,sd)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;attrib&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="check-all-that-applies-cata.html#cb144-1" aria-hidden="true" tabindex="-1"></a>loadsSH <span class="ot">&lt;-</span> lds0 <span class="sc">%&gt;%</span> </span>
<span id="cb144-2"><a href="check-all-that-applies-cata.html#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(cmp,val0) <span class="sc">%&gt;%</span> </span>
<span id="cb144-3"><a href="check-all-that-applies-cata.html#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sdloads, <span class="at">by =</span> <span class="st">&#39;attrib&#39;</span>)</span>
<span id="cb144-4"><a href="check-all-that-applies-cata.html#cb144-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-5"><a href="check-all-that-applies-cata.html#cb144-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb144-6"><a href="check-all-that-applies-cata.html#cb144-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> loadsSH, <span class="fu">aes</span>(<span class="at">x0 =</span> <span class="st">`</span><span class="at">Comp 1</span><span class="st">`</span>,<span class="at">y0 =</span> <span class="st">`</span><span class="at">Comp 2</span><span class="st">`</span>,<span class="at">a =</span> <span class="st">`</span><span class="at">sdComp 1</span><span class="st">`</span>,<span class="at">b =</span> <span class="st">`</span><span class="at">sdComp 2</span><span class="st">`</span>,<span class="at">angle =</span> <span class="dv">0</span>)) <span class="sc">+</span> <span class="fu">geom_ellipse</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-66-2.png" width="672" /></p>
</div>
</div>
<div id="exerecise" class="section level2 hasAnchor" number="11.5">
<h2><span class="header-section-number">11.5</span> Exerecise<a href="check-all-that-applies-cata.html#exerecise" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Take 5-10 minutes to look at the publication to get an overview [hvilken publ?]</p>
<div id="exercise-1-pca-on-consumer-background" class="section level3 hasAnchor" number="11.5.1">
<h3><span class="header-section-number">11.5.1</span> Exercise 1: PCA on consumer background<a href="check-all-that-applies-cata.html#exercise-1-pca-on-consumer-background" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>From this exercise you should be able to describe who your consumers are.</p>
<p>Make the data available:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="check-all-that-applies-cata.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;beerdemo&quot;</span>)</span></code></pre></div>
<p>Calculate a PCA model including the Variables 7 ( <em>Interest in food</em> ) to 39 ( <em>App_Vinous</em> ). Remember to standardize/scale the variables</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="check-all-that-applies-cata.html#cb146-1" aria-hidden="true" tabindex="-1"></a>mdlPCA <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(beerdemo[,<span class="dv">7</span><span class="sc">:</span><span class="dv">39</span>],<span class="at">scale. =</span> T)</span></code></pre></div>
<p>Plot the scores and loadings in a biplot and look for groupings of the consumers in the scores.</p>
<p>Group and color according to the background information not used in the model (Gender, Age,..)</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="check-all-that-applies-cata.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbiplot)</span>
<span id="cb147-2"><a href="check-all-that-applies-cata.html#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbiplot</span>(mdlPCA, <span class="at">groups =</span> beerdemo<span class="sc">$</span>Gender, <span class="at">ellipse =</span> T)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
<p>Describe what you find.</p>
</div>
<div id="exercise-2-pca-on-cata-counts" class="section level3 hasAnchor" number="11.5.2">
<h3><span class="header-section-number">11.5.2</span> Exercise 2: PCA on CATA counts<a href="check-all-that-applies-cata.html#exercise-2-pca-on-cata-counts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>From this exercise you should be able to describe your samples (beers) from the CATA counts. Collated (summed) for each beer of CATA score from all consumers.</p>
<p>Setup the collated version as described above.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="check-all-that-applies-cata.html#cb148-1" aria-hidden="true" tabindex="-1"></a>beercatasum <span class="ot">&lt;-</span> beercata <span class="sc">%&gt;%</span> </span>
<span id="cb148-2"><a href="check-all-that-applies-cata.html#cb148-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(attrib, ...</span></code></pre></div>
<p>Calculate a PCA model including all Variables and all Objects.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="check-all-that-applies-cata.html#cb149-1" aria-hidden="true" tabindex="-1"></a>PCAmdl <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(beercatasum, <span class="at">scale. =</span> T)</span></code></pre></div>
<p>Plot the scores and describe the groupings of the samples.
Plot the loadings and describe the correlations between the variables.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="check-all-that-applies-cata.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbiplot</span>(PCAmdl)</span></code></pre></div>
<p>Use this biplot to find out which samples are described by which words.</p>
</div>
<div id="exercise-3-pca-on-liking" class="section level3 hasAnchor" number="11.5.3">
<h3><span class="header-section-number">11.5.3</span> Exercise 3: PCA on liking<a href="check-all-that-applies-cata.html#exercise-3-pca-on-liking" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>From this exercise you should be able to describe the liking of the beer samples and see how the consumers do this.</p>
<p>Calculate a PCA model including all Variables and all Objects.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="check-all-that-applies-cata.html#cb151-1" aria-hidden="true" tabindex="-1"></a>include_these <span class="ot">&lt;-</span> <span class="fu">complete.cases</span>(beerliking)</span>
<span id="cb151-2"><a href="check-all-that-applies-cata.html#cb151-2" aria-hidden="true" tabindex="-1"></a>PCAliking <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(beerliking[include_these,<span class="sc">-</span><span class="dv">1</span>], <span class="at">scale. =</span> T)</span></code></pre></div>
<p>Plot a biplot or loading plot, and use the loadings and describe the correlations between the variables (liking of beers in this case).</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="check-all-that-applies-cata.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbiplot</span>(PCAliking)</span></code></pre></div>
<p>Plot the scores and describe the groupings of the samples by colouring the score plot according to the consumer background variables. Note that the 160 rows in both datasets match each-other, so we can glue the demo information directly onto the liking model. If that was not the case, matching using left_join() or inner_join() would be nessesary before analysis.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="check-all-that-applies-cata.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbiplot</span>(PCAliking,<span class="at">groups =</span> beerdemo<span class="sc">$</span>Age[include_these], <span class="at">ellipse =</span> T)</span></code></pre></div>
<p>Any trends? For instance, how is liking related to the individual consumer diversity of beer (<em>Beer types/month</em>)?</p>
<p>… Some code to get all 7-scale demo information plots. You may want to export and view in a pdf viewer for zooming etc.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="check-all-that-applies-cata.html#cb154-1" aria-hidden="true" tabindex="-1"></a>gall <span class="ot">&lt;-</span> <span class="fu">cbind</span>(PCAliking<span class="sc">$</span>x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], beerdemo[include_these,]) <span class="sc">%&gt;%</span> </span>
<span id="cb154-2"><a href="check-all-that-applies-cata.html#cb154-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(var,val,<span class="st">`</span><span class="at">Interest in food</span><span class="st">`</span><span class="sc">:</span>App_Vinous) <span class="sc">%&gt;%</span> </span>
<span id="cb154-3"><a href="check-all-that-applies-cata.html#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> ., <span class="fu">aes</span>(PC1,PC2, <span class="at">color =</span> <span class="fu">factor</span>(val))) <span class="sc">+</span> </span>
<span id="cb154-4"><a href="check-all-that-applies-cata.html#cb154-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb154-5"><a href="check-all-that-applies-cata.html#cb154-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>() <span class="sc">+</span> </span>
<span id="cb154-6"><a href="check-all-that-applies-cata.html#cb154-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>var)</span>
<span id="cb154-7"><a href="check-all-that-applies-cata.html#cb154-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">&#39;anicebigfigure.pdf&#39;</span>,gall, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">width =</span> <span class="dv">20</span>)</span></code></pre></div>
</div>
<div id="exercise-4-pls-on-cata-counts-and-liking" class="section level3 hasAnchor" number="11.5.4">
<h3><span class="header-section-number">11.5.4</span> Exercise 4: PLS on CATA counts and liking<a href="check-all-that-applies-cata.html#exercise-4-pls-on-cata-counts-and-liking" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>From this exercise you should be able to conclude what drives the liking of your samples (beers).</p>
<p>For each beer, the collated CATA counts is the predictors, and the averaged liking is the response.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="check-all-that-applies-cata.html#cb155-1" aria-hidden="true" tabindex="-1"></a>likingsum <span class="ot">&lt;-</span> beerliking <span class="sc">%&gt;%</span> </span>
<span id="cb155-2"><a href="check-all-that-applies-cata.html#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(Beer, liking, <span class="sc">-</span><span class="st">`</span><span class="at">Consumer ID</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb155-3"><a href="check-all-that-applies-cata.html#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Beer) <span class="sc">%&gt;%</span> </span>
<span id="cb155-4"><a href="check-all-that-applies-cata.html#cb155-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">lik =</span> <span class="fu">mean</span>(liking, <span class="at">na.rm =</span> T))</span></code></pre></div>
<p>Check that the rows are ordered in the same way:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="check-all-that-applies-cata.html#cb156-1" aria-hidden="true" tabindex="-1"></a>likingsum<span class="sc">$</span>beer</span></code></pre></div>
<pre><code>## Warning: Unknown or uninitialised column: `beer`.</code></pre>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="check-all-that-applies-cata.html#cb159-1" aria-hidden="true" tabindex="-1"></a>beercatasum<span class="sc">$</span>Beer</span></code></pre></div>
<pre><code>## [1] &quot;Brown Ale&quot;     &quot;NY Lager&quot;      &quot;Porse Bock&quot;    &quot;Ravnsborg Red&quot; &quot;River Beer&quot;    &quot;Wheat IPA&quot;</code></pre>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="check-all-that-applies-cata.html#cb161-1" aria-hidden="true" tabindex="-1"></a>CATAlik <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb161-2"><a href="check-all-that-applies-cata.html#cb161-2" aria-hidden="true" tabindex="-1"></a>CATAlik<span class="sc">$</span>CATA <span class="ot">&lt;-</span> <span class="fu">scale</span>(<span class="fu">as.matrix</span>(beercatasum[,<span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb161-3"><a href="check-all-that-applies-cata.html#cb161-3" aria-hidden="true" tabindex="-1"></a>CATAlik<span class="sc">$</span>lik <span class="ot">&lt;-</span> <span class="fu">scale</span>(likingsum<span class="sc">$</span>lik)</span>
<span id="cb161-4"><a href="check-all-that-applies-cata.html#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(CATAlik<span class="sc">$</span>lik) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(CATAlik<span class="sc">$</span>CATA) <span class="ot">&lt;-</span> beercatasum<span class="sc">$</span>Beer</span></code></pre></div>
<p>Calculate a PLS model where CATA features are predictors and liking is response for all Objects.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="check-all-that-applies-cata.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pls)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;pls&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:caret&#39;:
## 
##     R2</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     loadings</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="check-all-that-applies-cata.html#cb166-1" aria-hidden="true" tabindex="-1"></a>catalik.pls <span class="ot">&lt;-</span> <span class="fu">plsr</span>(lik <span class="sc">~</span> CATA, <span class="at">ncomp =</span> <span class="dv">2</span>, <span class="at">data =</span> CATAlik, <span class="at">validation =</span> <span class="st">&quot;LOO&quot;</span>)</span>
<span id="cb166-2"><a href="check-all-that-applies-cata.html#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(catalik.pls, <span class="at">labels =</span> <span class="fu">colnames</span>(beercatasum)[<span class="sc">-</span><span class="dv">1</span>])</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-80-1.png" width="672" /></p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="check-all-that-applies-cata.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">biplot</span>(catalik.pls)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-80-2.png" width="672" /></p>
<p>Plot the loadings and study which X variables are important for the liking score.
Advanced: Plot the Regression coefficients (scaled) and try to interpret the meaning of this plot (Hint: use your findings from the loadings plot).</p>
</div>
<div id="exercise-5-mixed-modelling-on-the-liking" class="section level3 hasAnchor" number="11.5.5">
<h3><span class="header-section-number">11.5.5</span> Exercise 5: Mixed modelling on the liking<a href="check-all-that-applies-cata.html#exercise-5-mixed-modelling-on-the-liking" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dataset: Beer_XYZmatrix.xlsx, sheet “Z and Y liking”
Import the datasheet in to R Studio.
Check to see if all variables have the correct description/denomination (factor, numerical etc.)
Are there any significant product differences for the liking? If so, what does the Tukey tell us? How does this fit with what you have done in the PCA/PLS exercises.
Is the liking in general affected by the age, gender, household size or beer knowledge? What is the effect? Try to think of a plot that can show the significant differences.
Do men and women score the samples significantly different in liking? Calculate the sample/gender differences in averages, try to use Pivot Tables in Excel.</p>
</div>
<div id="exercise-6-comparing-cata-binary-data-and-counts" class="section level3 hasAnchor" number="11.5.6">
<h3><span class="header-section-number">11.5.6</span> Exercise 6: Comparing CATA binary data and counts<a href="check-all-that-applies-cata.html#exercise-6-comparing-cata-binary-data-and-counts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dataset: Beer_XYZmatrix.xlsx, sheets “X CATA collated, counts” and “Z + Y + X unfolded”
If time…
Calculate two PCA models: one on the X unfolded matrix (CATA answers in binary codes, more columns and you just choose the ones you need) and one on the CATA counts.
Compare the outcome of the two models.
Evaluate explained variance
Evaluate loadings plots
Is this expected when looking at counts and “raw” data
What type of information is lost by looking at the CATA counts?</p>
</div>
<div id="exercise-7-cochrans-q-test-on-cata-binary-data" class="section level3 hasAnchor" number="11.5.7">
<h3><span class="header-section-number">11.5.7</span> Exercise 7: Cochran’s Q test on CATA binary data<a href="check-all-that-applies-cata.html#exercise-7-cochrans-q-test-on-cata-binary-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dataset: Beer_XYZmatrix.xlsx, sheet “X unfolded”</p>
<p>If time…
Import the datasheet in to R Studio using the CSV format (save the file as CSV in Excel).
Choose 4 relevant CATA attributes (based on your previous results today) to make a Cochran’s Q test for, comment on the results (i.e. the sample differences).</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="latent-factor-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="projective-mapping.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mortenarendt/dataanalyssisconsumerscience/edit/master/10_CATA.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/mortenarendt/dataanalyssisconsumerscience/blob/master/10_CATA.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
